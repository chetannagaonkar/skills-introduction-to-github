# --
# Copyright (C) 2001-2018 OTRS AG, https://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (GPL). If you
# did not receive this file, see https://www.gnu.org/licenses/gpl-3.0.txt. Productioncode
# --
## nofilter(TidyAll::Plugin::OTRS::TT::ScriptUsage)

<link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css" />
  
<script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>

<link rel="stylesheet" type="text/css" href="/otrs-web/skins/Agent/custom/css/statusTracking.css">
<link rel="stylesheet" type="text/css" href="/otrs-web/skins/Agent/default/css/bootstrap_zoom.css">

<!-- <link rel="stylesheet" type="text/css" href="/otrs-web/js/thirdparty/alertifyjs/css/alertify.css?a=1"> -->
<script src="/otrs-web/js/thirdparty/jquery.min.js"></script>
<script type="text/javascript" src="/otrs-web/skins/Agent/custom/js/table_filter.js"></script>



<link rel="stylesheet" type="text/css" href="/otrs-web/js/thirdparty/alertifyjs/css/alertify.css?a=1"/>

<link rel="stylesheet" type="text/css" href="/otrs-web/js/thirdparty/testjs/alertifyjs/css/alertify1.css?a=1">
<script type="text/javascript" src="/otrs-web/js/thirdparty/testjs/alertifyjs/alertify.js"></script>

<!--   /*SR2024121205000017*/ -->
 <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.js"
      integrity="sha512-+UiyfI4KyV1uypmEqz9cOIJNwye+u+S58/hSwKEAeUMViTTqM9/L4lqu8UxJzhmzGpms8PzFJDzEqXL9niHyjA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.css"
      integrity="sha512-bYPO5jmStZ9WI2602V2zaivdAnbAhtfzmxnEGh9RwtlI00I9s8ulGe4oBa5XxiC6tCITJH/QG70jswBhbLkxPw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script>
    var customJQuery = jQuery.noConflict(true);
    customJQuery(document).ready(function () {
        customJQuery('#EndTime').datetimepicker({
             format: "d/m/Y H:i",
          inline: false,
          minDate: "0",
      });
        customJQuery('#StartTime').datetimepicker({
             format: "d/m/Y H:i",
          inline: false,
          minDate: "0",
        });

        $("#EndTime").blur(function () {
          const startDate = customJQuery("#StartTime").datetimepicker("getValue"); // Get start date as Date object
          const endDate = customJQuery("#EndTime").datetimepicker("getValue"); // Get end date as Date object

         
          if (!startDate || !endDate) {
            alert("Please select both start and end dates.");
            return;
          }

          if (startDate > endDate) {
            //alert("Start date must be earlier than or equal to the end date.");
             alertify.alert('Wrong Date time ', 'End date and time must be greater than start date and time .', function(){ alertify.success('Ok'); });
             //customJQuery("#StartTime").val('');
             customJQuery("#EndTime").val('');
          } 
        
        });


    });
</script>
<!-- SR2024121205000017 -->
<style type="text/css">

    .disable-click{
    pointer-events:none;
}

    .cont{
    word-wrap: break-word;
    }
    #blink {
            
            color: #f29f43;
           
        }
    li.progtrckr-todo{
        color: black !important;
    }
    .linked_ticket > .fa-check-circle{
    color: green;
    /* font-weight: bold; */
}
textarea {
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    padding: 3px;
    padding-right: 121px;
}
 th {
  position: sticky;
  top: 0;
  z-index: 2;
} 
.Bulk {
  background-color: #ada7af;  
  border-radius: 5px;

  color: white;
  padding: .5em;
  text-decoration: none;


}


/*Integration Details CSS start*/
    .modal{
display: none;
position: fixed;
z-index: 9999;
padding-top: 2%;
left: 0;
top: 0;
width: 100%;
height: 100%;
overflow: auto;
background-color: rgb(0,0,0);
background-color: rgba(0,0,0,0.4);
font-family: sans-serif;
}
.modal-content{
background-color: white;
width: 100%;
padding: 15px;
overflow: hidden;
position: relative;
box-sizing: border-box;
max-width: 90%;
margin:auto;
border-radius:0px;
border: 0px solid #fcfcfc;
padding: 15px;
-webkit-border-image: url(none) 30 stretch; /* Safari 3.1-5 */
-o-border-image: url(none) 30 stretch; /* Opera 11-12.1 */
border-image: url(none) 30 stretch;
}
.modal-close{
font-size: 20px;
float: right;
font-weight: 700;
color: #000000;
font-size: 25px;
margin-top: -10px;
transition: all .2s;
cursor: pointer;
width: auto;
}
.modal-close:hover{
color: #3b3b3b;
}
.modal-img img{
width: 100%;
}
.modal-text{
text-align: left;
color:#ffffff;
}
.modal-text h2{
font-size: 24px;
font-weight: 600;
font-family: Lato;
}
.modal-text p{
font-size: 17px;
margin-top: -15px;
margin-bottom: 50px;
font-family: Lato;
}
.modal-footer{
padding: 20px 30px;
color: rgba(255, 255, 255, 0.5);
width: auto;
background-color: #3b3b3b;
margin:-15px;
}
input[type=text].modal-input{
color: rgba(0, 0, 0, 0.5);
width:80%;
background: rgb(255, 255, 255);
border: none;
border-radius: 3px;
outline: rgba(0, 0, 0, 0.5) none 0px;
padding: 15px;
}
input[type=submit].modal-submit-btn{
padding: 14px;
font-size: 14px;
background-color: #3bb4f5;
color:#ffffff;
width:auto;
border:none;
cursor: pointer;
border-radius: 3px;
margin-bottom: -13px;
}
@media screen and (max-width: 27em) {
input[type=text].modal-input{
width:90%;
margin-bottom: 0px;
}
input[type=submit].modal-submit-btn{
width:90%;
}
.modal-text p{
font-size: 15px;
}
}
/*Integration Details CSS end*/

.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; / Safari /
  animation: spin 2s linear infinite;
}

/ Safari /
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
    .popup{
      display: flex;
    justify-content: center;
    width: 100%;
    }

</style>

<style type="text/css">
.table-filter, .table-filter1, .table-filter2{
    border: 1px solid #767676 !important;
    border-radius: 13% !important;
    color: #767676 !important;
    font-size: 12px;

}
.btn-custom {
    border-radius: 20px !important;
    -webkit-box-shadow: none;
    box-shadow: none;
    border: 1px solid transparent;
    background-color: #bc3c3c;
    border-color: #fff;
    color: #fff;
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0;
    outline: currentColor;
    font-size: 14px;
    font-weight: 400;
    line-height: 1.42857143;
    text-align: center; 
    white-space: nowrap;
    vertical-align: middle;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}
/*.CustomHeadline {
    margin: 4px 0px;
    margin-right: -92px;
    display: flex;
}*/
.btn-custom:active {
    background-color: #21658c;
}
.btn-custom:hover {
    cursor: pointer;
}

.ControlRow1 li.Active, .ControlRow1 li.Active:hover, .ControlRow1 li.Active:active {

      background: #cececefc;
    /* padding-left: 2px; */
    /*border: 2px solid #2196f3;*/
    border-top-right-radius: 5px;
    border: 2px solid #cececefc;
    border-bottom: none;
}
.ControlRow1 li:not(:first-child) {
    margin-left: 2px;
}
.ControlRow1 li{
  /*  padding-left: 2px;*/
    float: left;
        cursor: pointer;
    position: relative;
    /*border: 2px solid #2196f3;*/
    border-top-right-radius: 5px;
}
.ControlRow1 {
    display: block;
    position: relative;
    overflow: hidden;
    min-height: 24px;

   
    background-color: transparent;
}

.ControlRow1 li > a {
    padding: 7px 12px 7px 11px;
    color: #111;
    font-size: 13px;
        cursor: pointer;
    display: block;
}
.tab-content {
     border: 2px solid #cececefc;
     border-top: 4px solid #cececefc;
    min-height: 400px;
    padding: 2px;
}
.ControlRow1 li.Active > a {
    color: white !important;
}

.WidgetSimple .WidgetSimple {
    margin: 4px !important;
}
a {
    color: #202;
    text-decoration: none;
}



    .HeadlineTitle {
    font-size: 14px;
    padding: 2px;
    font-weight: bold;
    color: #ff9922;
}

.Priority1{

    min-width: 48px !important;
    width: 1% !important;
}

.Responsetime{

 min-width: 83px !important;
    width: 12% !important;

}

.ticketSummaryInfo{

 min-width: 171px !important;
    width: 6% !important;
}
.CreateTimeCSS{
    min-width: 165px !important;
    width: 12% !important;
}
.SCFType{
    min-width: auto !important;
    width: auto !important;
}





.Resolutionsla
{
    min-width: 83px !important;
    width: 12% !important;  
}
.UpdateTime
{
    min-width: 83px !important;
    width: 12% !important;  
}
</style>
<style type="text/css">
    .CustomTable
    {
        display: table;
        width: 100%;
        max-width: 100%;
        margin-top: 4px;
        margin-bottom: 20px;
        border: 1px solid #ddd;
        border-collapse: collapse;
        border-spacing: 0;
    }
    .CustomTable>thead:first-child>tr:first-child>th {
        border-top: 0;
    }
    .CustomTable>thead>tr>td, .CustomTable>thead>tr>th {
        border-bottom-width: 2px;
    }
    .CustomTable>tbody>tr>td, .CustomTable>tbody>tr>th, .CustomTable>tfoot>tr>td, .CustomTable>tfoot>tr>th, .CustomTable>thead>tr>td, .CustomTable>thead>tr>th {
        border: 1px solid #ddd !important;
    }

    .CustomTable>thead>tr>th {
        font-weight: bold;
        vertical-align: bottom;
        border-bottom: 2px solid #ddd;
    }


    .CustomTable>tbody>tr>td, .CustomTable>tbody>tr>th, .CustomTable>tfoot>tr>td, .CustomTable>tfoot>tr>th, .CustomTable>thead>tr>td, .CustomTable>thead>tr>th {
        padding: 8px;
        line-height: 1.42857143;
        vertical-align: top;
        border-color: #ddd !important ;
        border-top: 1px solid #ddd;
    }

    li.ticket_info_item_list {
    padding: 5px 8px;
    line-height: 19px;
    float: left;
    font-size: 12px;
    border: 1px solid #ddd;
    max-width: 23%;
    min-width: 100px;
    float: left;
    line-height: 24px;
    width: 23%;
    min-width: 200px;
    max-width: 320px;
    height: 24px;
    vertical-align: middle;
}

span.escalated_info1 {
    border: 1px solid #2196F3;
    padding: 5px;
    color: #2196F3;
    border-radius: 11px;
    margin-left: 5px;
}
    
span.escalated_info {
    border: 1px solid #f44336;
    padding: 5px;
    background: #F44336;
     border-radius: 11px;
    color: white;
    margin-left: 5px;
}

.CustomHeadline {
    margin: 5px 0px;
    display: flex;
    width: 100%
}


.top_head {
    width: 8%;
    min-width: 184px;
    display: flex;
    position: relative;
    border: 1px solid #ccc;
    padding: 10px;
}

.MainData {
    text-align: center;
    font-size: medium;
    color: #373b45;
    font-weight: bold;
}
.MainRootData {
    width: 105%;
    padding: 0px;
    padding-top: 2%;
}
.MainIcon {
    width: 30%;
    padding: 5px;
    text-align: center;
    border-right: 1px solid #ccc;
    font-size: 175%;
}
.flag_header {
    text-align: center;
    color: #9e9b9b;
    font-weight: bold;
}
.MainIcon > .fa {
margin-top: 2px !important;
    }

span.tab_icon {
    padding: 0px 5px 0px 0px;
}
.cont {
    padding: 10px;
}

@media only screen and (max-width: 768px) {     
.top_head {
    width: 15%;
    min-width: 85px;  
}
.MainData {
  
    font-size: 7px;
}
.MainIcon {
  
    font-size: 65%;
    width: 0px
}
.flag_header {
    
    font-size: 7px;
}
.MainIcon > .fa {
      margin-top: -1px !important;
    margin-left: -4px;
}
}
}
</style>
<!-- Sets the basepath for the library if not in same directory -->
 <script type="text/javascript">
        mxBasePath = '/otrs-web/js/thirdparty/develop/mxgraph/javascript/src';
    </script>

[% RenderBlockStart("ArticleFilterDialog") %]
<div id="ArticleFilterDialog" class="Hidden">
    <form action="[% Env("CGIHandle") %]" method="post" id="ArticleFilterDialogForm" name="ArticleFilterDialogForm">
        <input type="hidden" value="AgentTicketZoom" name="Action"/>
        <input type="hidden" value="ArticleFilterSet" name="Subaction"/>
        <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
        <input type="hidden" value="[% Data.TypeID | html %]" name="TypeID1" id="TypeID1" />


        <fieldset class="TableLike">
            <label for="CommunicationChannelFilter">[% Translate("Communication channel") | html %]:</label>
            <div class="Field">
                [% Data.Channels %]
            </div>
            <div class="Clear"></div>
            <label for="CustomerVisibilityFilter">[% Translate("Customer visibility") | html %]:</label>
            <div class="Field">
                [% Data.CustomerVisibility %]
            </div>
            <div class="Clear"></div>
            <label for="ArticleSenderTypeFilter">[% Translate("Sender Type") | html %]:</label>
            <div class="Field">
                [% Data.ArticleSenderTypeFilterString %]
            </div>
            <div class="Clear"></div>
            <label for="SaveDefaults">[% Translate("Save filter settings as default") | html %]:</label>
            <div class="Field">
                <input type="checkbox" id="SaveDefaults" name="SaveDefaults" value="1" />
            </div>
        </fieldset>
    </form>
</div>
[% RenderBlockEnd("ArticleFilterDialog") %]

[% RenderBlockStart("EventTypeFilterDialog") %]
<div id="EventTypeFilterDialog" class="Hidden">
    <form action="[% Env("CGIHandle") %]" method="post" id="EventTypeFilterDialogForm" name="EventTypeFilterDialogForm">
        <input type="hidden" value="AgentTicketZoom" name="Action"/>
        <input type="hidden" value="EvenTypeFilterSet" name="Subaction"/>
        <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
        <fieldset class="TableLike">
            <label for="EventTypeFilter">[% Translate("Event Type") | html %]:</label>
            <div class="Field">
                [% Data.EventTypeFilterString %]
            </div>
            <div class="Clear"></div>
            <label for="SaveDefaults">[% Translate("Save as default") | html %]:</label>
            <div class="Field">
                <input type="checkbox" id="SaveDefaults" name="SaveDefaults" value="1" />
            </div>
        </fieldset>
    </form>
</div>
[% RenderBlockEnd("EventTypeFilterDialog") %]

[% RenderBlockStart("Header") %]
<div class="MainBox ARIARoleMain TicketZoom UseArticleColors">
    <div class="ClearLeft"></div>
 <div class="Headline" style="display:none;">
        
    </div>
 [% IF Data.TypeID == 2  || Data.TypeID == 4 ||  Data.TypeID == 6  %]
 <script src="/otrs-web/js/src/js/mxClient.js"></script>
  [% END %] 

    <div class="HeadlineTitle">
         <span>
            [% Data.Title | html %] 
        </span>
    </div>
    <div class="CustomHeadline NoMargin">
        [% IF Data.TypeID == 7 && Data.ParentType == 'Implementation Request' || Data.ParentType == 'Deactivation Request' || Data.ParentType == 'HOTO' || Data.ParentType == 'Material Request' || Data.ParentType == 'Material Issue' %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate(Data.ParentType) | html %] Task </div>
                </div>
            </div>
        [% END %]  
                [% IF Data.Priority == 'S1' %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head Priority1"  title="Severity - [% Translate(Data.Priority) | html %]" style="background-color: red">
                    <div class="MainRootData">
                        <div class="MainData PriorityID-[% Data.PriorityID | html %]">[% Translate(Data.Priority) | html %]</div>
                        <div class="flag_header" style="color: #fff">Severity</div>
                    </div>
                </div>
            [% END %]
        [% ELSE %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head Priority1"  title="Severity - [% Translate(Data.Priority) | html %]">
                    <div class="MainRootData">
                        <div class="MainData PriorityID-[% Data.PriorityID | html %]">[% Translate(Data.Priority) | html %]</div>
                        <div class="flag_header">Severity</div>
                    </div>
                </div>
            [% END %]
        [% END %]
        [% IF !Data.BillTo && !Data.SupportTo %]
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
        [% IF Data.CustomerID %]

            [% IF Data.Priority == 'S1' %]
           [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head customerid" style="background-color: red">
                    <div class="MainRootData" >
                        <div  class="MainData" title="Customer ID - [% Translate(Data.customerid) | html %]">
                           [% Data.CustomerID  %] 
                        </div>
                        <div class="flag_header" style="color: #fff">Customer ID</div>
                    </div>
                </div> 
                [% END %]
            [% ELSE %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head customerid" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Customer ID - [% Translate(Data.customerid) | html %]">
                           [% Data.CustomerID  %] 
                        </div>
                        <div class="flag_header">Customer ID</div>
                    </div>
                </div>
                [% END %]
            [% END %]
        [% END %]
        [% END %]
        [% ELSE %]
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
        [% IF Data.CustomerID %]
            [% IF Data.Priority == 'S1' %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head BilltoSupprotto" style="background-color: red">
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.BillTo  %] 
                        </div>
                        <div class="flag_header" style="color: #fff">Bill To</div>
                    </div>
                </div> 
                [% END %]
            [% ELSE %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head BilltoSupprotto"  style="background-color:[% Data. BackgroundColor%]">
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.BillTo  %]  
                        </div>
                        <div class="flag_header">Bill To</div>
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory  %]  
                        </div>
                        <div class="flag_header">Customer Category</div>
                    </div>
                </div>
                [% END %]
            [% END %]
        [% END %]
        [% END %]
        [% END %]
        
        [% IF !Data.BillTo && !Data.SupportTo %]
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
        [% IF Data.CustomerCompanyName %] 

            [% IF Data.Priority == 'S1' %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head customername" style="background-color: red">
                    <div class="MainRootData" >
                        <div  class="MainData" title="Customer Name - [% Translate(Data.customername) | html %]">
                           [% Data.CustomerCompanyName %] 
                        </div>
                        <div class="flag_header" style="color: #fff">Customer Name</div>
                        <!-- SR2022091405000023 Code Strat -->
                        <button style="margin-top:2px;"><a target="_blank" href="[% Env("Baselink") %]Action=AgentCustomerInformationCenter;CustomerID=[% Data.CustomerID  %]" title="Customer Name">View Customer Information</a></button>
                        <!-- SR2022091405000023 Code End -->
                    </div>
                </div>
                [% END %]
            [% ELSE %]
           [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head customername" style="background-color:[% Data.BackgroundColor %]" >
                    <div class="MainRootData"  >
                        <div  class="MainData" title="Customer Name - [% Translate(Data.customername) | html %]">
                           [% Data.CustomerCompanyName %] 
                        </div>
                        <div class="flag_header">Customer Name</div>
                         <div class="MainData">[% Data.customerCategory %]</div>
                         <div class="flag_header">Customer Category</div>
                        <!-- SR2022091405000023 Code Strat -->
                        <button style="margin-top:2px;"><a target="_blank" href="[% Env("Baselink") %]Action=AgentCustomerInformationCenter;CustomerID=[% Data.CustomerID  %]" title="Customer Name">View Customer Information</a></button>
                        <!-- SR2022091405000023 Code End -->
                    </div>
                </div>
                [% END %]
            [% END %]
        [% END %]

        [% END %]
        [% ELSE %]
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
        [% IF Data.CustomerCompanyName %] 
            [% IF Data.Priority == 'S1' %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head BilltoSupprotto" style="background-color: red">
                    <div class="MainRootData" >
                        <div  class="MainData" title="Support To - [% Translate(Data.SupportTo) | html %]">
                           [% Data.SupportTo %] 
                        </div>
                        <div class="flag_header" style="color: #fff">Support To</div>
                        <div class="flag_header" style="color: #fff">[% Data.customerCategory %]</div>
                    </div>
                </div>
                [% END %]
            [% ELSE %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 %]
                <div class="top_head BilltoSupprotto" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Support To - [% Translate(Data.SupportTo) | html %]">
                           [% Data.SupportTo %] 
                        </div>
                        <div class="flag_header">Support To</div>
                    </div>
                </div>
                [% END %]
            [% END %]
        [% END %]
        [% END %]
        [% END %]
        [% IF Data.Priority == 'S1' && Data.TypeID != 9 && Data.TypeID != 11 && Data.TypeID != 7 && Data.TypeID != 12 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 4 && Data.TypeID != 10 %]
            <div class="top_head ticketNoInfo" style="background-color: red">
                <div class="MainRootData" >
                    <div  class="MainData" title="Ticket Number - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                   <div class="flag_header" style="color: #fff">[% Translate(Data.Type) | html %] </div>
                </div>
            </div>
        [% ELSE %]
        [% IF Data.TypeID != 9 && Data.TypeID != 11 && Data.TypeID != 7 && Data.TypeID != 12 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 4 && Data.TypeID != 10 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                     <div  class="MainData" title="[% Translate(Data.Type) | html %] - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate(Data.Type) | html %] </div>
                </div>
            </div>
        [% END %]    
        [% END %]
        <!-- Code for service request start -->
        [% IF Data.TypeID == 4 &&  Data.Priority == 'S1' %]
            <div class="top_head ticketNoInfo" style="background-color: red">
                <div class="MainRootData" >
                    <div  class="MainData" title="[% Translate(Data.Type) | html %] - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header" style="color: #fff;">[% Translate("Request") | html %] </div>
                </div>
            </div>
        [% END %]  
        [% IF Data.TypeID == 4 &&  Data.Priority != 'S1' %]
            <div class="top_head ticketNoInfo">
                <div class="MainRootData" >
                    <div  class="MainData" title="[% Translate(Data.Type) | html %] - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate("Request") | html %] </div>
                </div>
            </div>
        [% END %]  
        <!-- Code for service request end -->
        <!-- Code for Task type start -->
        [% IF Data.TypeID == 7 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate(Data.ParentType) | html %] Task </div>
                </div>
            </div>
        [% END %]  
        <!-- Code for Task type end -->
        <!-- Code for Implementation request start -->
        [% IF Data.TypeID == 12 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Implementation Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate("Implementation Request") | html %] </div>
                </div>
            </div>
        [% END %]  
        <!-- Code for Implementation request end -->
        <!-- Code for Material request start -->
        [% IF Data.TypeID == 10 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Material Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate("Material Request") | html %] </div>
                </div>
            </div>
        [% END %]  
        <!-- Code for Material request end -->
        <!-- Code for HOTO request start -->
        [% IF Data.TypeID == 13 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="HOTO Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate("HOTO Request") | html %] </div>
                </div>
            </div>
        [% END %]  
        <!-- Code for HOTO request end -->
         <!-- Code for MRQ request start -->
     
        <!-- Code for MRQ request end -->
        <!-- Code for service DR start -->
        [% IF Data.TypeID == 15 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Deactivation Request - [% Translate(Data.TicketNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.TicketNumber %] 
                    </div>
                    <div class="flag_header">[% Translate("Deactivation Request") | html %]</div>
                </div>
            </div>
        [% END %]  
        <!-- Code for service DR end -->

        [% IF Data.TypeID == 9 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="SOF - [% Translate(Data.SOFNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.SOFNumber %] 
                    </div>
                    <div class="flag_header">SOF</div>

                </div>
            </div>
        [% END %]
        <!-- Code added for BillTo and Support To for SOF start -->
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
                    
            [% IF Data.TypeID == 9 %]
                <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor%]" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.BillTo  %] - ( [% Data.DynamicField_BillTo  %] )
                        </div>
                        <div class="flag_header">Bill To</div>
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory  %] 
                        </div>
                        <div class="flag_header">Customer Category</div>
                    </div>
                </div>
            [% END %]
        
        [% END %]

        [% IF Data.DynamicField_TicketClass != 'Internal' %]
                    
            [% IF Data.TypeID == 9 %]
                <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor_supportTo%]" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.SupportTo  %] - ( [% Data.DynamicField_SupportTo  %] )
                        </div>
                        <div class="flag_header">Support To</div>
                         <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory_Support  %]
                        </div>
                        <div class="flag_header">Customer Category</div>
                    </div>
                </div>
            [% END %]
        
        [% END %]
        <!-- Code added for BillTo and Support To for SOF end   -->
        [% IF Data.TypeID == 11 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                     <div  class="MainData" title="Line Item - [% Translate(Data.LineNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.LineNumber %] 
                    </div>

                    <div class="flag_header">Line Item</div>
                </div>
            </div>
        [% END %]
        <!-- Code added for BillTo and Support To for SOF start -->
        [% IF Data.DynamicField_TicketClass != 'Internal' %]
                   
            [% IF Data.TypeID == 11 || Data.TypeID == 12 || Data.TypeID == 13 %]
                <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor%]" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.BillTo  %] - ( [% Data.BillToID  %] )
                        </div>
                        <div class="flag_header">Bill To</div>
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory  %]  
                        </div>
                        <div class="flag_header">Customer Category</div>
                    </div>
                </div>
            [% END %]
        
        [% END %]

        [% IF Data.DynamicField_TicketClass != 'Internal' %]
                   
            [% IF Data.TypeID == 11 || Data.TypeID == 12 || Data.TypeID == 13 %]
                <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor_supportTo%]" >
                    <div class="MainRootData" >
                        <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.SupportToName  %] - ( [% Data.SupportToID  %] )
                        </div>
                        <div class="flag_header">Support To</div>
                         <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory_Support  %]  
                        </div>
                        <div class="flag_header">Customer Category</div>
                    </div>
                </div>
            [% END %]
        
        [% END %]
        <!-- Code added for BillTo and Support To for SOF end   -->
        [% IF Data.TypeID == 14 %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="SCF - [% Translate(Data.SCFNumber) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.SCFNumber %] 
                    </div>

                    <div class="flag_header">SCF</div>
                </div>
            </div>
        [% END %]
        [% IF Data.TypeID == 10 %]
        [% IF Data.DocumentTypeFlag == 'Yes' %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="SCF - [% Translate(Data.DocumentType) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.DocumentType %] 
                    </div>

                    <div class="flag_header">Sales Type Tag</div>
                </div>
            </div>
        [% ELSE %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="SCF - [% Translate(Data.DocumentType) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       [% Data.DocumentType %] 
                    </div>

                    <div class="flag_header">Document Type</div>
                </div>
            </div>
        [% END %]
        [% END %]
        [% IF Data.TypeID == 7 and Data.SOF_Number %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="SOF Number - [% Translate(Data.SOF_Number) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       <a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.SOF_ID | uri %]" target="_blank" style="color: #5454ff;">[% Data.SOF_Number %]</a>
                    </div>

                    <div class="flag_header">SOF Number</div>
                </div>
            </div>
        [% END %]
        [% IF Data.TypeID == 7 and Data.Line_Number %]
            <div class="top_head ticketNoInfo" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Line Number - [% Translate(Data.Line_Number) | html %]">
                        <!-- [% Data.Hook %][% Config('Ticket::HookDivider') %][% Data.TicketNumber %] &mdash; [% Data.Title | html %]  -->
                       <a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.Line_ID | uri %]" target="_blank" style="color: #5454ff;">[% Data.Line_Number %]</a>
                    </div>

                    <div class="flag_header">Line Number</div>
                </div>
            </div>
        [% END %]
        [% IF Data.TypeID == 14 %]
            <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor%]">
                <div class="MainRootData" >
                    <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                       [% Data.BillTo  %] - ( [% Data.BillToID  %] )
                    </div>
                    <div class="flag_header">Bill To</div>
                    <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory  %]  
                        </div>
                        <div class="flag_header">Customer Category</div>
                </div>
            </div>
            <div class="top_head BilltoSupprotto" style="background-color:[% Data. BackgroundColor_supportTo%]" >
                <div class="MainRootData" >
                    <div  class="MainData" title="Support To - [% Translate(Data.SupportTo) | html %]">
                       [% Data.SupportTo  %] - ( [% Data.SupportToID  %] )
                    </div>
                    <div class="flag_header">Support To</div>
                    <div  class="MainData" title="Bill To - [% Translate(Data.BillTo) | html %]">
                           [% Data.customerCategory_Support  %]   
                        </div>
                        <div class="flag_header">Customer Category</div>
                </div>
            </div>
        [% END %]

         <!-- [% RenderBlockStart("Schedule") %]
        <div class="top_head CreateTimeCSS" >
            <div class="MainRootData">
                <div class="MainData">
                    [% Data.Scheduled  %] 
                </div>
                <div class="flag_header">Schedule Date</div>
            </div>
        </div>
        [% RenderBlockEnd("Schedule") %] -->
        <!-- <div class="top_head ticketSummaryInfo" >
            <div class="MainRootData">
                <div class="MainData">
                    [% Data.State | html %] 
                </div>
                <div class="flag_header">Status</div>
            </div>
        </div> -->
        [% IF Data.Priority == 'S1' %]
             <div class="top_head CreateTimeCSS" style="background-color: red">
                <div class="MainRootData">
                    <div class="MainData">
                        <!-- [% Data.Created  %] -->
                        [% Translate(Data.TicketCreated1) | html %]
                    </div>
                    <div class="flag_header" style="color: #fff">Created Time</div>
                </div>
            </div>
        [% ELSE %]
            <div class="top_head CreateTimeCSS">
                <div class="MainRootData">
                    <div class="MainData">
                       <!-- [% Data.Created  %] -->
                       [% Translate(Data.TicketCreated1) | html %]
                    </div>
                    <div class="flag_header">Created Time</div>
                </div>
            </div>
       [% END %]
   <!--      [% IF Data.TypeID == 9 %]
            <div class="top_head loadingBanner" id="exampleModal" style="display:none;">
                <div class="MainRootData">
                    <div class="MainData">
                       <i class="fa fa-spinner fa-spin" style="font-size:24px"></i>
                    </div>
                    <div class="flag_header">SOF line/IR/Task Data is updating in back end...</div>
                </div>
            </div>
       [% END %] -->
       [% IF Data.DynamicField_SCFType %]
             <div class="top_head SCFType">
                <div class="MainRootData">
                    <div class="MainData">
                        [% Data.DynamicField_SCFType  %] 
                    </div>
                    <div class="flag_header">SCF Type</div>
                </div>
            </div>
            <div class="top_head SCFType">
                <div class="MainRootData">
                    <div class="MainData">
                        [% Data.DynamicField_SCFQuote  %] 
                    </div>
                    <div class="flag_header">SCF Quote</div>
                </div>
            </div>
       [% END %]
       <!-- Added Code to Display Message 08MAR24-->
       [% IF Data.IsUpdating == 'Processing' %]
            <!--  <div class="top_head DRUnderClose">
                <div class="MainRootData">
                <div class="flag_header" id="blink">Tasks are getting updated/resolved. Please wait...</div>
                </div>
            </div> -->
            <div class="top_head loadingBanner" id="exampleModal" style="display:none;">
                <div class="MainRootData">
                    <div class="MainData">
                       <i class="fa fa-spinner fa-spin" style="font-size:24px"></i>
                    </div>
                    <div class="flag_header">Tasks are getting updated/resolved. Please wait...</div>
                </div>
            </div>
             [% END %]
       <!-- Added Code to Display Message -->
       [% IF Data.DynamicField_TicketClass == 'Internal' %]
        [% IF Data.CustomerID %]
            [% IF Data.Priority == 'S1' %]
                [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 10 %]
                [% RenderBlockStart("EndUsers") %]
                    <div class="top_head customerid" style="background-color: red">
                        <div class="MainRootData" >
                            <div  class="MainData" title="Customer ID - [% Translate(Data.customerid) | html %]">
                               [% Data.EndUserData  %] 
                            </div>
                            <div class="flag_header" style="color: #fff;">End User</div>
                        </div>
                    </div> 
                [% RenderBlockEnd("EndUsers") %]
                [% END %]
            [% ELSE %]
                [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 10 %]
                [% RenderBlockStart("EndUsers") %]
                    <div class="top_head customerid" >
                        <div class="MainRootData" >
                            <div  class="MainData" title="Customer ID - [% Translate(Data.customerid) | html %]">
                               [% Data.EndUserData  %] 
                            </div>
                            <div class="flag_header">End User</div>
                        </div>
                    </div>
                [% RenderBlockEnd("EndUsers") %]
                [% END %] 
            [% END %]
        [% END %]
        [% END %]

         [% RenderBlockStart("ChangeBanner") %]
            [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 && Data.TypeID == 6 %]
                    <div class="top_head PlannedStart" >
                        <div class="MainRootData" >
                            <div  class="MainData" title="Planned Start Date ID - [% Translate(Data.DynamicField_PlannedStartDate) | html %]">
                               [% Data.DynamicField_PlannedStartDate  %] 
                            </div>
                            <div class="flag_header">Planned Start Date</div>
                        </div>
                    </div>   
                     <div class="top_head PlannedEndStart" >
                        <div class="MainRootData" >
                            <div  class="MainData" title="Planned Start Date ID - [% Translate(Data.DynamicField_PlannedEndDate) | html %]">
                               [% Data.DynamicField_PlannedEndDate  %] 
                            </div>
                            <div class="flag_header">Planned End Date</div>
                        </div>
                    </div>
                     <div class="top_head PlannedEndStart" >
                        <div class="MainRootData" >
                            <div  class="MainData" title=" - [% Translate(Data.DynamicField_ChangeType) | html %]">
                               [% Data.DynamicField_ChangeType  %] 
                            </div>
                            <div class="flag_header">Change Type</div>
                        </div>
                    </div>
                    <div class="top_head PlannedEndStart" >
                        <div class="MainRootData" >
                            <div  class="MainData" title=" - [% Translate(Data.DynamicField_risktype) | html %]">
                               [% Data.DynamicField_risktype  %] 
                            </div>
                            <div class="flag_header">Change Impact</div>
                        </div>
                    </div>
                [% END %]
                [% RenderBlockEnd("ChangeBanner") %]
        <!-- [% RenderBlockStart("ChangeType") %]
        <div class="top_head CreateTimeCSS" >
            <div class="MainRootData">
                <div class="MainData">
                    [% Data.ChangeType1  %] 
                </div>
                <div class="flag_header">Change Type</div>
            </div>
        </div>
        [% RenderBlockEnd("ChangeType") %] -->

        <!-- [% RenderBlockStart("FirstResponseTimeHeader") %]
            <div class="top_head Responsetime" >
                <div class="MainIcon">
                    [% IF(Data.Percentage < 100 )%]
                        <i class="fa fa-user" title="[% Data.Percentage %]%"></i> 
                    [% ELSE %]
                        <i class="fa fa-user-times" title="Escalated" style="color:red"></i>        
                    [% END %]
                    
                </div>
                <div class="MainRootData">
                    <div class="MainData"><nobr>
                        [% Data.FirstResponseTimeHuman | html %] 
                    </div>
                    
                    <div class="flag_header">[% Translate("Response SLA") | html %]</div></nobr>
                </div>
            </div>
        [% RenderBlockEnd("FirstResponseTimeHeader") %]  

        [% RenderBlockStart("FirstupdateTimeHeader") %]
            <div class="top_head UpdateTime" >
                <div class="MainIcon">
                    [% IF(Data.Percentage < 100 )%]
                        <i class="fa fa-user" title="[% Data.Percentage %]"></i> 
                    [% ELSE %]
                        <i class="fa fa-user-times" title="Escalated" style="color:red"></i>        
                    [% END %]
                    
                </div>
                <div class="MainRootData">
                    <div class="MainData"><nobr>
                        [% Data.UpdateTimeHuman | html %] 
                    </div>
                    
                    <div class="flag_header">[% Translate("Update SLA") | html %]</div></nobr>
                </div>
            </div>
        [% RenderBlockEnd("FirstupdateTimeHeader") %] 

        [% RenderBlockStart("SolutionTimeHeader") %]
            <div class="top_head Resolutionsla" >
                <div class="MainIcon">
                    [% IF(Data.Percentage < 100 )%]
                        <i class="fa fa-user" title="[% Data.Percentage %]%"></i> 
                    [% ELSE %]
                        <i class="fa fa-user-times" title="Escalated" style="color:red"></i>        
                    [% END %]
                    
                </div>
                <div class="MainRootData"><nobr>
                    <div class="MainData">
                        [% Data.SolutionTimeHuman | html %] 
                    </div>
                    
                    <div class="flag_header">[% Translate("Resolution SLA") | html %]</div></nobr>
                </div>
            </div>
        [% RenderBlockEnd("SolutionTimeHeader") %]
        [% RenderBlockStart("CustomerResponseSLAHeader") %]
            <div class="top_head" >
                <div class="MainIcon">
                    [% IF(Data.Percentage < 100 )%]
                        <i class="fa fa-user" title="[% Data.Percentage %]%"></i> 
                    [% ELSE %]
                        <i class="fa fa-user-times" title="Escalated" style="color:red"></i>        
                    [% END %]
                    
                </div>
                <div class="MainRootData">
                    <div class="MainData">
                        [% Data.CustomerSLAAge | html %]                        
                    </div>
                    
                    <div class="flag_header">[% Translate("Customer Response SLA") | html %]</div>
                </div>
            </div>
        [% RenderBlockEnd("CustomerResponseSLAHeader") %] -->
 [% RenderBlockStart("SLAPAUSEBUTTON") %]
        <div class="top_head" >
              <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
 <form action="[% Env("CGIHandle") %]" method="post" enctype="multipart/form-data" class="" style="float: right;">
                        <input type="hidden" name="Action" value="[% Env("Action") %]"/>
                        <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
                        <input type="hidden" name="Subaction" value="SLAPause"/>
                        &nbsp&nbsp
                      <!--   <button class="" style="color:red" type="submit" value="[% Translate("Pause") | html %]"><span>[% Translate("Pause") | html %]</span></button> -->
                      <button class="btn-custom" id="cust_btn"><span class="fa fa-pause" style="margin-right: 5px;"></span><span class="text">Pause SLA</span></button>
                        <!-- <input type="image" id="myimage" title="click here to pause" src="/otrs-web/skins/Agent/default/img/Pause.png" />
                        <div class="Clear"></div> -->

                        </form>
        </div>
[% RenderBlockEnd("SLAPAUSEBUTTON") %]
 [% RenderBlockStart("SLARESUMEBUTTON") %]
        <div class="top_head" >
              <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
 <form action="[% Env("CGIHandle") %]" method="post" enctype="multipart/form-data" class="" style="float: right;">
                        <input type="hidden" name="Action" value="[% Env("Action") %]"/>
                        <input type="hidden" value="[% Data.TicketID | html %]" name="TicketID"/>
                        <input type="hidden" name="Subaction" value="SLAResume"/>
                        &nbsp&nbsp
                      <!--   <button class="" style="color:red" type="submit" value="[% Translate("Pause") | html %]"><span>[% Translate("Pause") | html %]</span></button> -->
                      <button class="btn-custom" id="cust_btn" style="background-color: #4e981f"><span class="fa fa-play" style="margin-right: 5px; "></span><span class="text">Resume SLA</span></button>
                        <!-- <input type="image" id="myimage" title="click here to pause" src="/otrs-web/skins/Agent/default/img/Pause.png" />
                        <div class="Clear"></div> -->

                        </form>
        </div>
[% RenderBlockEnd("SLARESUMEBUTTON") %]  
[% RenderBlockStart("BulkChildCreation") %]

  <div class="top_head TicketCreationInProgress" >
                        <div class="MainRootData" >
                            <div  class="MainData123"  id="blink" title="Planned Start Date ID - [% Translate(Data.DynamicField_PlannedStartDate) | html %]">
                               The child tickets creation is in progress. They will be displayed after the tickets are created.
                              </div>
                            
                        </div>
                    </div>   
    
   
    [% RenderBlockEnd("BulkChildCreation") %]
    </div>


# Iframe used for fixing bug#8545: Attachment download not possible if pop up of another action is open
# All downloads (e.g. attachments) have this iframe as target. This prevents the browser from sending
# an http request to the TicketZoom window. It sends the download request to this iframe instead.
# Sending the download request to the main window would lead to an alert message about leaving the page
# if at the same time a popup window (e.g. for a ticket answer) is opened.
    <iframe src="about:blank" width="0" height="0" name="AttachmentWindow" id="AttachmentWindow"></iframe>

<!-- eStomi Status tracking  bar -->
[% RenderBlockStart("AllTicketStatus") %]
            <div>
            <div class ="hosa">
                <div class="ststus_data" ></div>
            </div>
            </div>

            [% WRAPPER JSOnDocumentComplete %]
            <script type="text/javascript">
                var ticketStatus = [% JSON(Data) %];
                var current_ticket_state=$(".current_ticket_state").text();
                // alert(current_ticket_state);
                var allstatus=$.parseJSON(ticketStatus);
                var AllStatus=$.parseJSON(allstatus[0]);
                var TicketStatus=$.parseJSON(allstatus[1]);
                 var CurrentTypeId = $.parseJSON(allstatus[3]);
                var status_length=Object.keys(AllStatus).length;
                status_length = status_length + 1;

                var ht='<div class="clear"></div><ol class="progtrckr" data-progtrckr-steps="'+status_length+'">';
                /*classes progtrckr-done and progtrckr-todo*/
                $.each(AllStatus, function(index, val) {
                    // if(TicketStatus[index]==current_ticket_state){
                       if(TicketStatus[index]==current_ticket_state){
                        ht+='<li class="progtrckr-done"><b>'+val+'</b></li>';
                    }
                    else if(TicketStatus[index]){
                       
                        ht+='<li class="reached_state"><b>'+val+'</b></li>';
                    }else{
                        
                        ht+='<li class="progtrckr-todo">'+val+'</li>';
                    }

                });
                ht+='</ol>';

                
                $(".ststus_data").html(ht);

                
            </script>
            [% END %]
            [% RenderBlockEnd("AllTicketStatus") %]
<!-- eStomi Status tracking bar end   -->
<!-- Tabs Rendering  Taken it out from AllTicketStatus block and rendering below directly on DOM  -->
[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">

    var CurrentTypeId = "[% Data.TypeID %]";

    console.log('TypeIDCurrent',CurrentTypeId );
   $.urlParam = function(name){
    var results = new RegExp('[\?;]' + name + '=([^;#]*)').exec(window.location.href);
    if(results){
        return results[1] || 0;
    }
}


var temp = $.urlParam('TabID'); 

if(!temp){
    if(CurrentTypeId == 9 || CurrentTypeId == 14 ){
      console.log('SOFTicket');

      temp = 'additional_info';    
  }else{
    
      console.log('NonSOFTicket');
      temp = 'ArticalTab';
  }
}
$(document).on('click','.tab', function(){
    console.log('tabclick');
    var current = $(this).attr('data-id');
    $('.tab-content').each(function(){
        $(this).hide();
    });
    $("."+current).show();
    $('.tab').each(function(){
        $(this).parent().removeClass("Active");
    });
    $(this).parent().addClass("Active");
});

$(document).ready(function(){
    $('.tab-content').each(function(){
        $(this).hide();
    });
    $("."+temp).show();

    $('.tab').each(function(){

        if($(this).attr('data-id') == temp){

            $(this).parent().addClass("Active");

        }else{

            $(this).parent().removeClass("Active");
        }
        
    });
    

});

</script>
[% END %]      
<!-- Tabs Rendering  -->
    <div class="LayoutFixedSidebar SidebarLast">
        <div class="SidebarColumn">

[% RenderBlockStart("FormDraftTable") %]
            <div class="WidgetSimple">
                <div class="Header">
                    <div class="WidgetAction Toggle">
                        <a href="#" title="[% Translate("Show or hide the content") | html %]"><i class="fa fa-caret-right"></i><i class="fa fa-caret-down"></i></a>
                    </div>
                    <h2>[% Translate( "Drafts") | html %]</h2>
                </div>

                <div class="Content">
                    <table class="DataTable" id="FormDraftTable">
                        <tbody>
                            [% FOREACH FormDraft IN Data.FormDrafts %]
                            <tr class="MasterAction">
                                <td class="DraftName">
                                    <a
                                        href="[% Env("Baselink") %][% FormDraft.Link | Interpolate %];LoadFormDraft=1;FormDraftID=[% FormDraft.FormDraftID | html %]"
                                        class="[% FormDraft.Class | html %] MasterActionLink"
                                        [% FormDraft.LinkParam %]>

                                        <span title="[% Translate(FormDraft.Description) | html %]">
                                            [% Translate(FormDraft.Name) | html %] -
                                        </span>
                                        <span title="[% Translate("Created") | html %] [% FormDraft.CreateTime | Localize("TimeShort") %] [% Translate("by") | html %] [% FormDraft.CreatedByUser | html %] [% Translate("Changed") | html %] [% FormDraft.ChangeTime | Localize("TimeShort") %] [% Translate("by") | html %] [% FormDraft.ChangedByUser | html %]">
                                            [% FormDraft.Title | html %]
                                        </span>
                                    </a>
                                </td>
                                <td>
                                    <a class="FormDraftDelete"
                                        href="[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=FormDraftDelete;FormDraftID=[% FormDraft.FormDraftID | html %];TicketID=[% Data.TicketID %]"
                                        title="[% Translate("Delete") | html %]"
                                        data-title="[% FormDraft.Title | html %]"
                                        [% FormDraft.LinkParam %]>

                                        <i class="fa fa-trash-o"></i>
                                    </a>
                                </td>
                            [% END %]
                        </tbody>
                    </table>
                </div>
            </div>
[% RenderBlockEnd("FormDraftTable") %]

            [% FOREACH Widget IN Data.SidebarWidgets; %]
                [% IF Widget.Async; %]
                    <div id="[% Widget.ElementID %]">
                        <div class="WidgetIsLoading">
                            <i class="fa fa-spinner fa-spin"></i>
                        </div>
                    </div>
                [% ELSE; %]
                    [% Widget.Output %]
                [% END; %]
            [% END; %] 
        </div>
        <div class="ContentColumn">



            <div class="WidgetSimple ">
                <div class="Content OverflowVisible">
                    <div class="ActionRow Cluster">
                        <div class="WidgetAction ArticleView">
                            <a id="ArticleViewSettings" href="#" title="[% Translate("Settings") | html %]">
                                <i class="fa fa-cog"></i>
                                <span class="InvisibleText">[% Translate("Settings") | html %]</span>
                            </a>
                        </div>
                        <ul class="Actions">
[% RenderBlockStart("TicketMenu") %]
                            <!-- <li id="nav-[% Data.Name | replace(' ', '-') | html %]"> -->
                            [% IF !Data.Name %]
                            [% ELSE %]
                            <li id="nav-[% Data.Name | replace(' ', '-') | html %]">
                                [% END %]
                            [% IF Data.Type == 'Cluster' %]
                                <span class="[% Data.Class %]" >[% Translate(Data.Name) | html %] <i class="fa fa-caret-down"></i></span>
                            [% ELSE %]
                                <a href="[% Env("Baselink") %][% Data.Link | Interpolate %]" class="[% Data.Class %]" [% Data.LinkParam %] title="[% Translate(Data.Description) | html %]" target="[% Data.Target | html %]">[% Translate(Data.Name) | html %]</a>
                            [% END %]
[% RenderBlockStart("TicketMenuSubContainer") %]
                                <ul id="nav-[% Data.Name | replace(' ', '-') | html %]-container">
[% RenderBlockStart("TicketMenuSubContainerItem") %]
                                    <li id="nav-[% Data.Name | replace(' ', '-') | html %]">
                                        <a href="[% IF !Data.ExternalLink %][% Env("Baselink") %][% END %][% Data.Link | Interpolate %]" class="[% Data.Class | html %]" [% Data.LinkParam %] title="[% Translate(Data.Description) | html %]" target="[% Data.Target | html %]">[% Translate(Data.Name) | html %]</a>
                                    </li>
[% RenderBlockEnd("TicketMenuSubContainerItem") %]
                                </ul>
[% RenderBlockEnd("TicketMenuSubContainer") %]
                            </li>
[% RenderBlockEnd("TicketMenu") %]


[% RenderBlockStart("TicketMenuPhoneAsDropdown") %]
                            <li>
                                <form title="[% Translate(Data.Name) | html %]" action="[% Env("CGIHandle") %]" method="get" id="[% Data.FormID | html %]">
                                    <input type="hidden" name="Action" value="[% Data.Action | html %]"/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    <label for="[% Data.PhoneElementID | html %]" class="InvisibleText">[% Translate(Data.Name) | html %]:</label>
                                    [% Data.StandardReplyStrg %]
                                </form>
                            </li>
[% RenderBlockEnd("TicketMenuPhoneAsDropdown") %]
[% RenderBlockStart("MoveLink") %]
                            <li class="[% Data.Class | html %]">
                                <form title="[% Translate("Move ticket to a different queue") | html %]" action="[% Env("CGIHandle") | html %]" method="post">
                                    <input type="hidden" name="Action" value="AgentTicketMove"/>
                                    <input type="hidden" name="QueueID" value="[% Data.QueueID | html %]"/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    <label for="DestQueueID" class="InvisibleText">[% Translate("Queue") | html %]:</label>
                                    [% Data.MoveQueuesStrg %]
                                </form>
                            </li>
[% RenderBlockEnd("MoveLink") %]
[% RenderBlockStart("MoveForm") %]
                           <!--  <li>
                                <a href="[% Env("Baselink") %]Action=AgentTicketMove;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" title="[% Translate("Change Queue") | html %]">[% Translate("Reassign Team") | html %]</a>
                            </li> -->
[% RenderBlockEnd("MoveForm") %]

<!-- Custom code for awaiting customer and escalated start -->
[% IF Data.TypeID != 9 && Data.TypeID != 11 && Data.TypeID != 12 && Data.TypeID != 13 && Data.TypeID != 14 && Data.TypeID != 15 && Data.TypeID != 10 && Data.TypeID != 16 %]
[% RenderBlockStart("MoveLink1") %]
                            <li class="[% Data.Class | html %]">
                                [% Data.AwaitingCustomer %]
                                <!-- <form id="CalledCustomer" title="[% Translate("Awaiting Customer") | html %]" action="[% Env("CGIHandle") | html %]" method="post">
                                    <input type="hidden" name="Action" value=""/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    
                                    [% Data.AwaitingCustomer %]
                                    <h1>
                                </form> -->
                                
                                <form id="CalledCustomer1" style="display: none;" action="[% Env("CGIHandle") %]" method="post">
                                    <input type="hidden" name="Action" value="AgentCallingCustomer"/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    
                                   <fieldset class="TableLike" style="padding-bottom: 1%;padding-top:2%;background-color:#fff;">
                                    
                                    <label style="color: #000;width:26%;">Subject:</label>
                                    <div class="Field" style="margin-left: 26%;">
                                        <input type="text" name="Subject3" id="Subject3" value="" maxlength="200" style="padding: 3px;padding-right: 136px;font-size: 12px;color: #000;max-width: 31%;" />
                                    </div>
                                    <div class="Clear"></div>

                                    <label style="color: #000;width:26%;">[% Translate("Description") | html %]:</label>
                                    <div class="Field" style="margin-left: 26%;">
                                        <!-- <input type="text" name="Description" id="Description" value="[% Data.Asset_cat | html %]" maxlength="200"/> -->
                                        <textarea name="desc1" id="desc1"></textarea>
                                    </div>
                                                
                                    <div class="Clear"></div>
                                            <div class="Field" style="margin-top: 0%;margin-left: 62.5%;">
                                                <input type="submit" value="Submit" style="padding: 5%;" />
                                                <!-- <input type="reset" value="Cancel"/> -->
                                            </div>
                                </fieldset>
                                </form>

                                <form id="articleDemo" style="display: none;" action="[% Env("CGIHandle") %]" method="post">
                                    <input type="hidden" name="Action" value="AgentCalledCustomer"/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    
                                   <fieldset class="TableLike" style="padding-bottom: 1%;padding-top:2%;background-color:#fff;">
                                    
                                    <label style="color: #000;width:26%;">Subject:</label>
                                    <div class="Field" style="margin-left: 26%;">
                                        <input type="text" name="Subject2" id="Subject2" value="" maxlength="200" style="padding: 3px;padding-right: 112px;font-size: 12px;color: #000;" />
                                    </div>
                                    <div class="Clear"></div>

                                    <label style="color: #000;width:26%;">[% Translate("Description") | html %]:</label>
                                    <div class="Field" style="margin-left: 26%;">
                                        <!-- <input type="text" name="Description" id="Description" value="[% Data.Asset_cat | html %]" maxlength="200"/> -->
                                        <textarea name="desc" id="desc"></textarea>
                                    </div>
                                                
                                    <div class="Clear"></div>
                                            <div class="Field" style="margin-top: 0%;margin-left: 62.5%;">
                                                <input type="submit" value="Submit" style="padding: 5%;" />
                                                <!-- <input type="reset" value="Cancel"/> -->
                                            </div>
                                </fieldset>
                                </form>
                            </li>
[% RenderBlockEnd("MoveLink1") %]
[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">
//document.getElementById("Async_0200-CustomerInformation").style.display = "none";
$('#AwaitingCustomer').bind('change',function(Event) {
    // alert('hi');

    // var id = $(this).data('AwaitingCustomer');
    var call = document.getElementById('AwaitingCustomer').value;
    
    if (call == '2') {
        $("#articleDemo").show();
        // var subject  = $('#Subject2').val();
        // alert(subject);
        alertify.genericDialog || alertify.dialog('genericDialog',function(){
        return {
            main:function(content){
                this.setContent(content);
            },
            setup:function(){
                return {
                    focus:{
                        element:function(){
                            return this.elements.body.querySelector(this.get('selector'));
                        },
                        select:true
                    },
                    options:{
                        basic:true,
                        maximizable:false,
                        resizable:false,
                        padding:false
                    }
                };
            },
            settings:{
                selector:undefined
            }
        };
    });
//force focusing password box
alertify.genericDialog ($('#articleDemo')[0]).set('selector');
        // alertify.prompt('Subject:').set('type', 'text'); 
    }
    if (call == '1') {
        // alert('hi');
        // $(this).closest('#CalledCustomer1').submit();
        $("#CalledCustomer1").show();
        // var subject  = $('#Subject2').val();
        // alert(subject);
        alertify.genericDialog || alertify.dialog('genericDialog',function(){
        return {
            main:function(content){
                this.setContent(content);
            },
            setup:function(){
                return {
                    focus:{
                        element:function(){
                            return this.elements.body.querySelector(this.get('selector'));
                        },
                        select:true
                    },
                    options:{
                        basic:true,
                        maximizable:false,
                        resizable:false,
                        padding:false
                    }
                };
            },
            settings:{
                selector:undefined
            }
        };
    });
//force focusing password box
alertify.genericDialog ($('#CalledCustomer1')[0]).set('selector');
    }
});

</script>
[% END %]
[% RenderBlockStart("MoveForm1") %]
                            <li>
                                <a href="[% Env("Baselink") %]Action=AgentTicketMove;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" title="[% Translate("Change Queue") | html %]">[% Translate("Queue") | html %]</a>
                            </li>
[% RenderBlockEnd("MoveForm1") %]

[% RenderBlockStart("MoveLink2") %]
                        [% IF Data.TypeID != 5  %]
                              <li class="[% Data.Class | html %]">
                                <form id="testescalateform" title="[% Translate("Escalated") | html %]" action="[% Env("CGIHandle") | html %]" method="post">
                                    <input type="hidden" name="Action" value="AgentTicketEscalated"/>
                                    <input type="hidden" name="QueueID" value="[% Data.QueueID | html %]"/>
                                    <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]"/>
                                    <label for="Escalate" class="InvisibleText">[% Translate("Escalate") | html %]:</label>
                                    [% Data.Escalate %]
                                </form>
                            </li>
                        [% END %]
[% RenderBlockEnd("MoveLink2") %]
[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">
    
     $('#Escalate').bind('change', function () {

        var Val = $('#Escalate').val();
 
            if(Val != 0 && Val != "No"){

                if (Val == "Yes") {

                         alertify.confirm('Are You Sure To Escalate?', function(e){
                          
                 if (e) {
                    $('#testescalateform').submit();
                   
                }
                else{

                    return false;                 
                }
            }

        , function(){ alertify.error('No')
         
         $('.ReturnToPreviousPage').click();
        window.location.reload();

        });
                 
                 
                }

            }
        });

</script>
[% END %]

[% END %]

[% RenderBlockStart("MoveForm2") %]
                            <li>
                                <a href="[% Env("Baselink") %]Action=AgentTicketMove;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" title="[% Translate("Change Queue") | html %]">[% Translate("Queue") | html %]</a>
                            </li>
[% RenderBlockEnd("MoveForm2") %]

<!-- Custom code for awaiting customer and escalated end   -->

[% RenderBlockStart("TicketMenuExternalLink") %]
                            <li>
                                <a href="[% Data.Link | Interpolate %]" `class="[% Data.Class | html %]" [% Data.LinkParam %] title="[% Translate(Data.Description) | html %]" target="[% Data.Target %]">[% Translate(Data.Name) | html %]</a>
                            </li>
[% RenderBlockEnd("TicketMenuExternalLink") %]
                        </ul>
                        <div class="Clear"></div>
                    </div>
                </div>
            </div>


            <div class="ControlRow1">
                <ul class="Tabs">
                    [% RenderBlockStart("DynamicTabCreate") %]
                      [% IF Data.tabid == 'ArticalTab'  %]
                    <li title="[% Data.tabname %]" >
                        <a class="tab" data-id="[% Data.tabid %]" id='[% Data.id %]' href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=ArticalTab"><span class="tab_icon [% Data.tab_icon %]"></span> <span class='tab_text '>[% Data.tabname %] </span></a>
                    </li>
                     [% ELSE %]

                    <li title="[% Data.tabname %]" >
                        <a class="tab" data-id="[% Data.tabid %]" id='[% Data.id %]'><span class="tab_icon [% Data.tab_icon %]"></span> <span class='tab_text'>[% Data.tabname %]</span></a>
                    </li>
                       [% END %]
                    [% RenderBlockEnd("DynamicTabCreate") %]

                    [% IF Data.MainWidgets %]
                    <!-- [% IF Data.TypeID != 9 %]
                        <li title="Related Items">
                            <a class="tab" data-id="relatedTicket"><span class="tab_icon fa fa-external-link"></span> <span class='tab_text'>Related Items</span></a>

                        </li>
                    [% END %] -->
                    [% IF Data.TypeID == 6  or Data.TypeID == 2 or Data.TypeID == 5  or Data.TypeID == 4 or Data.TypeID == 7 %]
                        <li title="Related Items">
                            <a class="tab" data-id="relatedTicket"><span class="tab_icon fa fa-external-link"></span> <span class='tab_text'>Related Items</span></a>
                        </li>

                        [% IF Data.DynamicField_IRTask == 'Yes' %]
                        <li title="Tasks">
                            <a class="tab" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IRTasksTask" data-id="IRTasksTask"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IR Tasks</span></a>
                        </li>
                        [% END %]
                    [% END %]
                    [% END; %]

                    <!-- HOTO Task multiple issue INC2022111605000024 Start -->
                    [% IF Data.TypeID == 13 %]
                        [% RenderBlockStart("IsHOTOTask") %]
                            <li title="Line Item">
                                <a class="tab" data-id="LineItem"><span class="tab_icon fa fa-external-link"></span> <span class='tab_text'>Line Item</span></a>
                            </li>
                        [% RenderBlockEnd("IsHOTOTask") %]
                    [% END %]

                    [% IF Data.TypeID == 7 %]
                        [% RenderBlockStart("IsHOTOTaskLINE") %]
                            <li title="Line Item">
                                <a class="tab" data-id="LineItem"><span class="tab_icon fa fa-external-link"></span> <span class='tab_text'>Line Item</span></a>
                            </li>
                        [% RenderBlockEnd("IsHOTOTaskLINE") %]
                    [% END %]
                    <!-- HOTO Task multiple issue INC2022111605000024 end -->
                    
                    [% IF Data.TypeID == 14 %]
                     <li title="SOF Details">
                        <a class="tab" data-id="SOFDetails"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Impacted SOF</span></a>
                    </li>

                    <li title="LineItem Details">
                        <a class="tab" data-id="LineItemDetails" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=LineItemDetails"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Impacted Line Item</span></a>
                    </li>
                    <li title="New LineItem Details">
                        <a class="tab" data-id="lineitem" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=lineitem"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>New Line Item</span></a>
                    </li>
                    <li title="IR Request">
                        <a class="tab" data-id="IRDetail" id='IR_SOF_Details' href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IRDetail"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>New IRs</span></a>
                    </li>
                    <li title="Tasks">
                        <a class="tab" data-id="IRTasks" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IRTasks"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>New IR Tasks</span></a>
                    </li>
                    <!-- SCF custom code for DR start -->
                    <li title="DR">
                        <a class="tab" data-id="SCFDRDetails" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=SCFDRDetails"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>DR</span></a>
                    </li>
                    <li title="DR Task">
                        <a class="tab" data-id="SCFDRTaskDetails" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=SCFDRTaskDetails"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>DR Tasks</span></a>
                    </li>

                    [% END %]
                    [% IF Data.TypeID == 10 %]
                     [% IF Data.DynamicField_MRQSOFNumber1 %]
                     <li title="Line Item">
                        <a class="tab" data-id="MRlineitem"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Line Item</span></a>
                    </li>
                    <li title="MattCode">
                        <a class="tab" data-id="MattCode" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=MattCode"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Matt Code</span></a>
                    </li>
                    [% END %]
                    [% RenderBlockStart("IntigrationDetailsTabMRQ") %]
                        <li title="Integration Details">
                            <a class="tab" data-id="IntegrationDetailsMRQ" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IntegrationDetailsMRQ"><span class="tab_icon fa fa-envelope"></span> <span class='tab_text'>Integration Details</span></a>
                        </li>
                    [% RenderBlockEnd("IntigrationDetailsTabMRQ") %]
                    [% END %]
                    [% IF Data.TypeID == 10 %]
                    [% IF !Data.DynamicField_MRQSOFNumber1 %]
                    <li title="Project">
                        <a class="tab" data-id="Project" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=Project"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>MRQ Lines</span></a>
                    </li>
                     [% END %]
                    [% END %]
                    [% IF Data.TypeID == 16 %]

                    <li title="Asset/SOF">
                        <a class="tab" data-id="SOFMIT"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Related Asset/SOF</span></a>
                    </li>
                    <li title="Asset/Project">
                        <a class="tab" data-id="ProjectMIT"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Related Asset/Project</span></a>
                    </li>
                    [% END %]
                    
                    [% IF Data.TypeID == 9 %]

                     <li title="Line Item">
                        <a class="tab" data-id="lineitem" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=lineitem"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Line Item</span></a>
                    </li>
                    <li title="IR Request">
                        <a class="tab" data-id="IRDetail" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IRDetail"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IRs</span></a>
                    </li>
                    <li title="Tasks">
                        <a class="tab" data-id="IRTasks" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IRTasks"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IR Tasks</span></a>
                    </li>
                     <li title="DRs">
                        <a class="tab" data-id="DRs" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=DRs"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>DRs</span></a>
                    </li>
                    <li title="HOTO">
                        <a class="tab" data-id="HOTO" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=HOTO"><span class="tab_icon fa fa-tasks"></span> <span class='tab_text'>Handover to Ops</span></a>
                    </li>
                     <li title="SCF">
                       <a class="tab" data-id="SCF" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=SCF" ><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>SCF</span></a>

                    </li>
                    <li title="Related Item">
                        <a class="tab" data-id="SOFLinkSOF"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Related Item</span></a>
                    </li>
                    <li title="MRQ">
                        <a class="tab" data-id="MRQ" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=MRQ"><span class="tab_icon fa fa-tasks"></span> <span class='tab_text'>MRQs</span></a>
                    </li>
                    <li title="MIT">
                    <a class="tab" data-id="MIT"  href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=MIT"><span class="tab_icon fa fa-tasks"></span> <span class='tab_text'>MITs</span></a>

                    </li>

                    <!-- Code Start for 19/08/2022 by NMJ-->

                    <li title="Assets">
                        <a class="tab" data-id="Assets" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=Assets" ><span class="tab_icon fa fa-mobile"></span> <span class='tab_text'>Asset</span></a>
                    </li>

                    <!-- Code End for 19/08/2022 by NMJ-->

                    [% RenderBlockStart("IntigrationDetailsTab") %]
                        <li title="Integration Details">
                            <a class="tab" data-id="IntegrationDetails" href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];TabID=IntegrationDetails"><span class="tab_icon fa fa-envelope"></span> <span class='tab_text'>Integration Details</span></a>
                        </li>
                    [% RenderBlockEnd("IntigrationDetailsTab") %]

                    [% ELSIF Data.TypeID == 12 %]

                     <!-- <li title="Line Item">
                        <a class="tab" data-id="IRlineitem"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Line Item</span></a>
                    </li>
                     --><!-- <li title="IR Request">
                        <a class="tab" data-id="IRDetail"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IR's</span></a>
                    </li> -->
                    <li title="Tasks">
                        <a class="tab" data-id="Task" id='IRTask1'><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IR Tasks</span></a>
                    </li>
                    
                    [% ELSIF Data.TypeID == 13 %]

                    <li title="Tasks">
                        <a class="tab" data-id="HOTOTask"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Tasks</span></a>
                    </li>
                    
                    [% ELSIF Data.TypeID == 15%]
                    
                    <li title="LineItem ">
                        <a class="tab" data-id="DRLineItem" id="DRLine"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>DR Related LineItem</span></a>
                    </li>
                    <li title="Tasks">
                        <a class="tab" data-id="DRTasks" id="DRTasksData"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Tasks</span></a>
                    </li>

                     [% ELSIF Data.TypeID == 11 %]

                    <li title="IR Request">
                        <a class="tab" data-id="IRDetail"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IRs</span></a>
                    </li>
                    <li title="Tasks">
                        <a class="tab" data-id="IRTasks"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>IR Tasks</span></a>
                    </li>
                    <li title="Tasks">
                        <a class="tab" data-id="LineParts"><span class="tab_icon fa fa-ticket"></span> <span class='tab_text'>Products</span></a>
                    </li>
                    <li title="Questions">
                        <a class="tab" data-id="Questions"><span class="tab_icon fa fa fa-quora"></span> <span class='tab_text'>Questions</span></a>
                    </li>
                    <li title="HOTO Tasks">
                        <a class="tab" data-id="HOTOTasksLI"><span class="tab_icon fa fa fa-ticket"></span> <span class='tab_text'>Handover to Ops Tasks</span></a>
                    </li>
                    <li title="DR">
                        <a class="tab" data-id="DR"><span class="ttab_icon fa fa-ticket"></span> <span class='tab_text'>DR</span></a>
                    </li>
                    <li title="Asset">
                        <a class="tab" data-id="Asset"><span class="ttab_icon fa fa-mobile"></span> <span class='tab_text'>Asset</span></a>
                    </li>
                    [% END %]

                   
                     <!-- <li title="Asset Information">
                        <a class="tab" data-id="TicketInfo2"><span class="tab_icon fa fa-desktop"></span> <span class='tab_text'>Asset Information</span></a>
                    </li> -->

                    [% IF Data.TypeID == 4 %]
                    <li title="MAT Code">
                        <a class="tab" data-id="MATCode"><span class="tab_icon fa fa-check"></span> <span class='tab_text'>MAT Code</span></a>
                    </li>
                    [% END %]
                    [% IF Data.TypeID == 6  or Data.TypeID == 2 or Data.TypeID == 5  or Data.TypeID == 4 or Data.TypeID == 7 %]
                    <li title="Effort Logs">
                        <a class="tab" data-id="effort_logging"><span class="tab_icon fa fa-clock-o"></span> <span class='tab_text'>Efforts Log</span></a>
                    </li>
                      [% IF Data.DynamicField_Domain == 'Product' ||  Data.DynamicField_WorkflowTasks  == 'Product' || Data.DynamicField_Domain == 'Account Payable' ||  Data.DynamicField_WorkflowTasks  == 'Account Payable'  %]
                     <li title="DocumentTab">
                        <a class="tab" data-id="documenttab"><span class="tab_icon fa fa-paperclip"></span> <span class='tab_text'>Document Tab</span></a>
                    </li>
                     [% END %]
                    [% END %]
                     [% IF Data.DynamicField_SubCategory == 'DC Tour' ||  Data.DynamicField_SubCategory == 'General Visitor Pass' ||  Data.DynamicField_SubCategory == 'Operation Contractor Pass' || Data.DynamicField_SubCategory == 'Project Contractor Pass' %]
                    <li title="VisitorDetails">
                        <a class="tab" data-id="VisitorDetails"><span class="tab_icon fa fa-clock-o"></span> <span class='tab_text'>Visitor Details</span></a>
                    </li>
                      [% END %]
                       [% IF Data.DynamicField_SubCategory == 'DC Tour' ||  Data.DynamicField_SubCategory == 'General Visitor Pass' ||  Data.DynamicField_SubCategory == 'Operation Contractor Pass' || Data.DynamicField_SubCategory == 'Project Contractor Pass' %]
                      <!-- SR2024030605000028 SHA details start -->
                      <li title="SHADetails">
                        <a class="tab" data-id="SHADetails"><span class="tab_icon fa fa-clock-o"></span> <span class='tab_text'>Server Hall Access</span></a>
                    </li>


                      <!-- SR2024030605000028 SHA details End -->
                        [% END %]
                        [% IF Data.TypeID == 6  %]
                    <li title="CAB Approval">
                        <a class="tab" data-id="CABApproval"><span class="tab_icon fa fa-check"></span> <span class='tab_text'>CAB Approval</span></a>
                    </li>
                    [% END %]
                     [% IF Data.DynamicField_CMDBUpdateTask  &&  Data.TypeID == 7 %]
                    <li title="CMDB Update">
                        <a class="tab" data-id="CMDBUpdate"><span class="tab_icon fa fa-cog"></span> <span class='tab_text'>CMDB Update</span></a>
                    </li>
                    [% END %]
                    [% IF  Data.TypeID == 18 && Data.DynamicField_SurveyType == 'Transactional' %]
                    <li title="Survey Ticket">
                        <a class="tab" data-id="SurveyTicket"><span class="tab_icon fa fa-cog"></span> <span class='tab_text'>Related Ticket</span></a>
                    </li>
                    [% END %]

                    <!-- SR2024121205000017 -->

                       [% IF  Data.QueueID == 17   %]
                        <!-- Todo need to ad the permission based   -->
                    <li title="Activity">
                        <a class="tab" id="rhes" data-id="rhesActivity"><span class="tab_icon fa fa-cog"></span> <span class='tab_text'>RHES Activity</span></a>
                    </li>
                    [% END %] 

<!--        SR2024121205000017 -->


                </ul>
            </div>

[% RenderBlockStart("ProcessWidget") %]
            <div class="WidgetSimple Expanded [% Data.tabid %] tab-content" id="DynamicFieldsWidget">
                <div class="Header">
                    <div class="WidgetAction Toggle"><a href="#" title="[% Translate("Show or hide the content") | html %]"><i class="fa fa-caret-right"></i><i class="fa fa-caret-down"></i></a></div>
                    <h2>[% Translate(Data.WidgetTitle) | html %]</h2>
                </div>
[% RenderBlockStart("NextActivityDialogs") %]
                <div class="LightRow Bottom">
                    <ul class="Actions">
                        <li><strong>[% Translate(Data.ActivityName) | html %]:</strong></li>
[% RenderBlockStart("ActivityDialog") %]
                        <li>
                            <a title="[% Translate(Data.Name) | html %]" class="AsPopup PopupType_TicketAction" href="[% Env("Baselink") %]Action=AgentTicketProcess;Subaction=DisplayActivityDialog;TicketID=[% Data.TicketID | uri %];ProcessEntityID=[% Data.ProcessEntityID | uri %];ActivityDialogEntityID=[% Data.ActivityDialogEntityID | uri %]">[% Translate(Data.Name) | html %]</a>
                        </li>
[% RenderBlockEnd("ActivityDialog") %]
                    </ul>
[% RenderBlockStart("NoActivityDialogs") %]
                    <span class="ActionMessage">[% Translate("There are no dialogs available at this point in the process.") | html %]</span>
[% RenderBlockEnd("NoActivityDialogs") %]
                    <div class="Clear"></div>
                </div>
[% RenderBlockEnd("NextActivityDialogs") %]
                <div class="Content ProcessInfo">
                    <div class="ProcessInformation">
                        <fieldset>
[% RenderBlockStart("ProcessWidgetDynamicFieldGroups") %]
[% RenderBlockStart("ProcessWidgetDynamicFieldGroupSeparator") %]
                            <h2 class="FieldSetSeparator">[% Translate(Data.Name) | html %]</h2>
[% RenderBlockEnd("ProcessWidgetDynamicFieldGroupSeparator") %]
[% RenderBlockStart("ProcessWidgetDynamicField") %]
                            <div class="FieldContainer DynamicFieldAutoResize">
                                <label title="[% Data.Label | html %]">
                                    [% Data.Label | html %]
[% RenderBlockStart("ProcessWidgetDynamicFieldValueOverlayTrigger") %]
                                    <a href="#" class="ShowFieldInfoOverlay">+</a>
[% RenderBlockEnd("ProcessWidgetDynamicFieldValueOverlayTrigger") %]
                                </label>
                                <p class="Value CutValue DynamicField_[% Data.Name %]">
<!-- OutputFilterHook_WidgetDynamicFieldBegin -->
[% RenderBlockStart("ProcessWidgetDynamicFieldLink") %]
                                   <!--  <span title="[% Data.Title %]"><a href="[% Data.Link | Interpolate %]"[% IF Data.LinkPreview %] data-trigger="floater" data-floater-url="[% Data.LinkPreview | Interpolate %]"[% END %] target="_blank" class="DynamicFieldLink">[% Data.Value %]</a></span> -->
[% RenderBlockEnd("ProcessWidgetDynamicFieldLink") %]
[% RenderBlockStart("ProcessWidgetDynamicFieldPlain") %]
                                    [% Data.Value %]
[% RenderBlockEnd("ProcessWidgetDynamicFieldPlain") %]
<!-- OutputFilterHook_WidgetDynamicFieldEnd -->
                                </p>
                                <p class="ValueLong">
[% RenderBlockStart("ProcessWidgetDynamicFieldValueLong") %]
                                    [% Data.Value %]
[% RenderBlockEnd("ProcessWidgetDynamicFieldValueLong") %]
                                </p>
                                <div class="Clear"></div>
                            </div>
[% RenderBlockEnd("ProcessWidgetDynamicField") %]
[% RenderBlockEnd("ProcessWidgetDynamicFieldGroups") %]
                        </fieldset>
                    </div>
                </div>
            </div> 
[% RenderBlockEnd("ProcessWidget") %]
    <div class="[% Data.tabid %] tab-content">
            <div id="ArticleTree ">
[% Data.ArticleTree %]
            </div>

[% RenderBlockStart("HintNoArticles") %]
            <div class="WidgetSimple">
                <div class="Content">
                    [% Translate("This tab either has no data or is yet to get loaded.") | html %]
                </div>
            </div>
[% RenderBlockEnd("HintNoArticles") %]

            <div id="ArticleItems">
[% Data.ArticleItems %]
            </div>
</div>

<!-- eStomi code for Additional information -->
[% RenderBlockStart("DynamicWidget") %]
    <div class="WidgetSimple [% Data.tabid %] tab-content" id="ServiceFlowWidget">
        <div class="Header">
            <h2>[% Translate("Additional Details") | html %]</h2>
        </div>
        <div class="Content">
            [% RenderBlockStart("ColumnRow") %]
            <div class='row row_list DataTable'>

                [% RenderBlockStart("ColumnContent") %]
                    <div class="[% Data.divClass %] " style="width: 49.333333%">

                        <div class='row '>

                            <div class="col-md-6 col-xs-6 ">
                                <div class="cont">
                                   <b>[% Translate(Data.Label) | html %]</b>
                                   <span style="float:right;">:</span>
                               </div>
                            </div> 
                            <div class="col-md-6 col-xs-6"  title="[% Data.Title %]">
                                <div class="cont" title="[% Data.Value %]">
                                 
                                   [% Data.Value | Localize("TimeShort") %]

                                </div> 
                            </div> 

                        </div>

                    </div>
                [% RenderBlockEnd("ColumnContent") %]  

                [% RenderBlockStart("NoColumnContent") %]
                    <div class="col-md-12 coln">
                        None of information available
                    </div>
                [% RenderBlockEnd("NoColumnContent") %]
            </div>
            [% RenderBlockEnd("ColumnRow") %]

       
        
        </div>
        <div class="Clear"></div>
        
    </div>
[% RenderBlockEnd("DynamicWidget") %]
<!-- eStomi code for Additional information -->
<!-- Ticket information tab start -->

 <div class="WidgetSimple TicketInfo tab-content" >
    
            
    [% RenderBlockStart("TicketInfoUL") %]
    
    <div class="Header">
        <h2>[% Translate("Ticket Information") | html %]
            [% RenderBlockStart("ArchiveFlag") %]
                <span calss="archivedClass" style="float:right;">
                    <i class="fa fa-archive">: [% Translate("This ticket is archived.") | html %]</i>
                </span>
            [% RenderBlockEnd("ArchiveFlag") %]
        </h2>
    </div>
     <div class="Content">

         [% RenderBlockStart("ColumnRow_TI") %]
            <div class='row row_list'>

                [% RenderBlockStart("ColumnContent_TI") %]
                    <div class="[% Data.divClass %] ">

                        <div class='row'>
                          [% RenderBlockStart("RowContent_TI") %]  
                            <div class="col-md-6 col-xs-6 ">
                                <div class="cont">
                                    <b>
                        [% IF Data.Label == "Queue"  %]
        
                                   [% Translate(Data.Label) | html %]

                        [% ELSIF Data.Label == "Pending till" %]

                            [% Translate("Pending till") | html %]

                        [% ELSIF Data.Label == "First Response SLA" %]           

                            [% Translate("Response SLA") | html %] 

                        [% ELSIF Data.Label == "Update SLA" %] 

                            [% Translate("Update SLA") | html %]

                        [% ELSIF Data.Label == "Solution SLA" %]

                            [% Translate("Solution SLA") | html %]

                        [% ELSIF Data.Label == "Customer Response SLA" %] 

                            [% Translate("Cust.Res SLA") | html %]

                        [% ELSIF Data.Label == "OLA" %] 

                            [% Translate("Operator Level Agreement") | html %]

                        [% ELSE %]

                            [% Translate(Data.Label) | html %]

                        [% END %]
                            </b>
                            <span style="float:right;">:</span>

                               </div>

                            </div> 
                            <div class="col-md-6 col-xs-6"  title="[% Data.Title %]">
                                <div class="cont">
                        [% IF Data.Label == "Queue"  %]
                                    
                                    [% Data.Value | html | replace('::', '<wbr>::<wbr>') %]
                        
                        [% ELSIF Data.Label == "Pending till" %]
                                    <p class="Value [% Data.flag | html %]"> [% Data.Value %] <br/> [% Data.Value1 | Localize("TimeShort") %] </p>
                        
                        [% ELSIF Data.Label == "First Response SLA" %]
                            <span title="[% Translate("Response SLA") | html %]: [% Data.FirstResponseTimeWorkingTime | html %]" class="[% Data.FirstResponseTimeClass | html %]">
                            [% Data.FirstResponseTimeHuman | html %]
                            </span>
                            [% IF(Data.Percentage < 100 )%]
                                        <span class="escalated_info1">[% Data.Percentage %]</span>
                            [% ELSE %]
                                        <span class="escalated_info">Escalated</span>
                            [% END %]

                        [% ELSIF Data.Label == "Update SLA" %] 

                            <span title="[% Translate("Update SLA") | html %]: [% Data.UpdateTimeWorkingTime | html %]" class="[% Data.UpdateTimeClass | html %]">
                                [% Data.UpdateTimeHuman | html %]
                            </span>
                            [% IF(Data.Percentage < 100 )%]
                                        <span class="escalated_info1">[% Data.Percentage %]</span>
                            [% ELSE %]
                                        <span class="escalated_info">Escalated</span>
                            [% END %]
            
                        [% ELSIF Data.Label == "Solution SLA" %]       

                            <span title="[% Translate("Solution SLA") | html %]: [% Data.SolutionTimeWorkingTime | html %]" class="[% Data.SolutionTimeClass | html %]">
                                [% Data.SolutionTimeHuman | html %]
                            </span>
                            [% IF(Data.Percentage < 100 )%]
                                        <span class="escalated_info1">[% Data.Percentage %]%</span>
                            [% ELSE %]
                                        <span class="escalated_info">Escalated</span>
                            [% END %]

                        [% ELSIF Data.Label == "Customer Response SLA" %] 
                            <span title="[% Translate("Customer Response SLA") | html %]: [% Data.CustomerSLAAge | html %]" class="[% Data.CustomerSLAAge | html %]">
                                [% Data.CustomerSLAAge | html %] &nbsp;&nbsp; [% Data.CustomerResponseSLATimeStamp | Localize("TimeShort") %]
                            </span>
                            [% IF(Data.Percentage < 100 )%]
                                        <span class="escalated_info1">[% Data.Percentage %]%</span>
                            [% ELSE %]
                                        <span class="escalated_info">Escalated</span>
                            [% END %]

                        [% ELSIF Data.Label == "OLA" %] 
                            <span title="[% Translate("Operator Level Agreement") | html %]: [% Data.CustomerSLAAssignAge | html %]" class="[% Data.CustomClass | html %]">
                                [% Data.OLARemainingTime | html %] <br> [% Data.OLATimeStamp | Localize("TimeShort") %]
                            </span>
                            [% IF(Data.Percentage < 100 )%]
                                        <span class="escalated_info1">[% Data.Percentage %]%</span>
                            [% ELSE %]
                                        <span class="escalated_info">Escalated</span>
                            [% END %]

                        [% ELSE %]
                             [% IF Data.flag == "Localize"  %] [% Data.Value | Localize("TimeShort") %] [% ELSE %][% Translate(Data.Value) | html %][% END %]

                         [% END %]
                        </div> 
                    </div>    
                    [% RenderBlockEnd("RowContent_TI") %]
                        </div>
                         [% RenderBlockStart("TicketInfoTypeValid_TI") %]
                        <div class='row'>
                            <div class="col-md-12 col-xs-12 ">

                                [% IF Data.TypeValid != 1 %] <em class="Error">[% Translate("Note: Type is invalid!") | html %]</em> [% END %]

                            </div>
                        </div>
                        [% RenderBlockEnd("TicketInfoTypeValid_TI") %]

                    </div>

                [% RenderBlockEnd("ColumnContent_TI") %]  

                [% RenderBlockStart("NoColumnContent_TI") %]
                    <div class="col-md-12 coln">
                        None of information available
                    </div>
                [% RenderBlockEnd("NoColumnContent_TI") %]
            </div>
            [% RenderBlockEnd("ColumnRow_TI") %]

    [% RenderBlockEnd("TicketInfoUL") %]
</div>

</div>


<div class="WidgetSimple TicketInfo1 tab-content" >
    <div class="Header">
        <h2>[% Translate("Customer Information") | html %] </h2>
    </div>
    <div class="Content">
        
        [% RenderBlockStart("ColumnRow_CI") %]
            <div class='row row_list'>

            [% RenderBlockStart("ColumnContent_CI") %]
                <div class="[% Data.divClass %] ">

                    <div class='row'>
                    [% RenderBlockStart("RowContent_CI") %]  
                        <div class="col-md-6 col-xs-6">
                            <div class="cont">
                                <b>[% Translate(Data.Label) | html %] <span style="float:right;">:</span></b>
                            </div>
                        </div>
                        <div class="col-md-6 col-xs-6"> 
                            <div class="cont">
                                [% Translate(Data.Value) | html %]
                            </div>
                        </div>
                    [% RenderBlockEnd("RowContent_CI") %] 
                    </div>
              
                </div>
            [% RenderBlockEnd("ColumnContent_CI") %]

            </div>
            
        [% RenderBlockEnd("ColumnRow_CI") %]
            
    </div> 
</div>
<div class="WidgetSimple TicketInfo2 tab-content" >
    [% RenderBlockStart("AssetTable") %]

        <div class="Content">   

           [% RenderBlockStart("OCSHardware") %]

 <div class="WidgetSimple">
        <div class="Header">
            <h2>[% Translate("Associated Asset (Allocated)") | html %]</h2>
        </div>
        <div class="Content">
            <table class="DataTable">
                <thead>
                <tr>
                    <th>[% Translate("Name") | html %]</th>
                    <th>[% Translate("Model") | html %]</th>
                    <th>[% Translate("Assigned To") | html %]</th>
                    <th>[% Translate("Last Invented") | html %]</th>
                    <th>[% Translate("More Info.") | html %]</th>
                    <th>[% Translate("Relate") | html %]</th>
                </tr>
                </thead>
                <tbody>
                [% RenderBlockStart("OCSHardware_tr") %]
                <tr>
                    <td>[% Data.Name %]</td>
                    <td>[% Data.Model %]</td>
                    <td>[% Data.assignto %]</td>
                    <td>[% Data.change_time %]</td>
                    <td><a href="[% Env("Baselink") %]Action=AgentCustomerAssest;Subaction=DeviceView;DeviceName=[% Data.Name %];DeviceID=[% Data.ID %];CustomerUserID=[% Data.UserCustomerID | uri %];TicketID=[% Data.TicketID | html %]" class="AsPopup PopupType_TicketAction" title="[% Translate("Customer Asset") | html %]"> <span class="fa fa-info-circle"></span></a></td>
                    <td class="linked_ticket" data-id='[% Data.Name %]' data-id1='[% Data.asset_id %]' data-ticket-id='[% Data.TicketID | html %]'><span [% IF Data.linked_Ticket == 'Yes' %] class="fa fa-check-circle" title="Related" [% ELSE %] class="fa fa-circle-o" title="Not Related" [% END %] ></span></td>
                    
                    
                </tr>

                [% RenderBlockEnd("OCSHardware_tr") %]
                [% RenderBlockStart("OCSHardware_nodata") %]
                <tr>
                    <td colspan="6"> No information found.</td>
                    
                </tr>

                [% RenderBlockEnd("OCSHardware_nodata") %]
                </tbody>
            </table>  
        </div>
    </div>

             [% RenderBlockEnd("OCSHardware") %]

             [% RenderBlockStart("SpareResult") %]
                    <div class="WidgetSimple">
                        <div class="Header">
                            <h2>[% Translate("Spares Associated") | html %]</h2>
                        </div>
                        <div class="Content">
                            <table class="DataTable">
                                <thead>
                                    <tr>
                                        <th>[% Translate("Spare") | html %]</th>
                                        <th>[% Translate("Allocated To") | html %]</th>
                                        
                                        <!-- <th>[% Translate("Vendor") | html %]</th> -->
                                        <!-- <th>[% Translate("Manufacturer") | html %]</th> -->
                                        <!-- <th>[% Translate("Serial") | html %]</th> -->
                                        <!-- <th>[% Translate("Warranty_End") | html %]</th> -->
                                        <!-- <th>[% Translate("Quantity") | html %]</th> -->
                                        <th>[% Translate("Available") | html %]</th>
                                        <th>[% Translate("Allocated#") | html %]</th>
                                       
                                    </tr>
                                </thead>
                                <tbody>
                [% RenderBlockStart("NoDataFoundMsg") %]
                                        <tr>
                                            <td colspan="6">
                                                [% Translate("No data found.") | html %]
                                            </td>
                                        </tr>
                [% RenderBlockEnd("NoDataFoundMsg") %]
                [% RenderBlockStart("SpareResultRow") %]
                                        <tr>
                                            <td>
                                                [% Data.Spare | html %]
                                            </td>
                                            <td>[% Data.DeviceName | html %]</td>
                                          
                                            
                                         
                                            <!-- <td>[% Data.Vendor | html %]</td> -->
                                            <!-- <td>[% Data.Manufacturer | html %]</td> -->
                                            <!-- <td>[% Data.Serial | html %]</td> -->
                                            <!-- <td>[% Data.Warranty_End | html %]</td> -->
                                            <!-- <td>[% Data.Quantity | html %]</td> -->
                                            <td>[% Data.Available | html %]</td>
                                            <td>[% Data.Consumed_individual | html %]</td>
                                          
                                        </tr>
                [% RenderBlockEnd("SpareResultRow") %]
                                    </tbody>
                                </table>
                            </div>
                        </div>
                [% RenderBlockEnd("SpareResult") %]
        </div>
    [% RenderBlockEnd("AssetTable") %]
    [% RenderBlockStart("AssetTableNotAvailable") %]
        <h1 style="margin: 10px 10px 0px 10px;">[% Translate("Asset Information") | html %]</h1>
        <div class="Content" style="padding: 8px 10px 10px">                 
            <a>None of asset(s) linked.</a>
        </div>
    [% RenderBlockEnd("AssetTableNotAvailable") %]

</div>


<!-- Ticket information tab end -->
    <div class="Clear"></div>
    <!-- Sid added code for Related Items start -->
    [% IF Data.MainWidgets; %]
                            
            <div class="WidgetSimple relatedTicket tab-content" >        
                [% FOREACH Widget IN Data.MainWidgets; %]
                    [% IF Widget.Async; %]
                        <div id="[% Widget.ElementID %]"></div>
                    [% ELSE; %]
                        [% Widget.Output %]
                    [% END; %]
                [% END; %]
            </div>
        [% END; %]
        <div class="Clear"></div>
    <!-- Sid added code for Related Items end   -->

<!-- Code for MAT Code -->
    <div class="WidgetSimple MATCode tab-content" >
        [% RenderBlockStart("MATCode") %]
        <div class="WidgetSimple">
            <div class="Header">
                <h2>[% Translate("MAT Code") | html %]</h2>
            </div>
            <div class="Content">
                <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                    <thead>
                        <tr>
                            <th>[% Translate("Material/Service Description") | html %]</th>
                            <th>[% Translate("Material Type") | html %]</th>
                            <th>[% Translate("UOM") | html %]</th>
                            <th>[% Translate("HSN/SAC Code") | html %]</th>
                        </tr>
                    </thead>
                    <tbody>
        [% RenderBlockStart("MATCodeData") %]
                        <tr class="">
                            <td>[% Translate(Data.mattcodedescription) | html %]</td>
                            <td>[% Translate(Data.matttype) | html %]</td>
                            <td>[% Translate(Data.mattuom) | html %]</td>
                            <td>[% Translate(Data.hsnsaccode) | html %]</td>
                        </tr>
        [% RenderBlockEnd("MATCodeData") %]
                    </tbody>
                </table>
            </div>
        </div>
        [% RenderBlockEnd("MATCode") %]
    </div>
<!-- Code for MAT Code -->

<div class="WidgetSimple effort_logging tab-content" >
  [% RenderBlockStart("EffortLogging") %]
  <div class="WidgetSimple">
                        <div class="Header">
                            <h2>[% Translate("Efforts Log") | html %]</h2>
                        </div>
                        <div class="Content" style="float:left; width:65%" >
  <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                        <thead>
                            <tr>
                                <th class="No Sortable">[% Translate("Owner.") | html %]</th>
                                <th class="UnreadArticles">[% Translate("Current State") | html %]</th>
                                <th class="Direction Sortable">[% Translate("State Transition") | html %]</th>
                    <!--             <th class="Direction Sortable">[% Translate("Changed By") | html %]</th> -->
                                <th class="Sender Sortable">[% Translate("Duration") | html %]</th>
                                
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockStart("EffortLoggingData") %]
                            <tr class="">
                                <td style="width:16%">[% Translate(Data.owner) | html %]</td>
                                <td style="width:16%">[% Translate(Data.currentstate) | html %]</td>
                                <td style="width:52%">[% Translate(Data.trsnsition) | html %]</td>
                                <!-- <td style="width:16%">  [% Translate(Data.change_by) | html %]</td> -->
                                <td >  [% Translate(Data.workingtime) | html %]</td>
                                
                            </tr>
 [% RenderBlockEnd("EffortLoggingData") %]
 

                        </tbody>
                    </table>
                </div>

                  <div class="Content" style="float:left; width:30%">
                <table class="DataTable" >
                     <thead>
                        
                        <tr>
                            <th>[% Translate("Owner.") | html %]</th>
                            <th>[% Translate("Toatl Efforts") | html %]</th>
                        </tr>
                    </thead>
                    <tbody>
                            <tr>
                             [% RenderBlockStart('TotalTable') %]</tr> 
                            <td>[% Data.Owner %]</td>

                           
                           <td> [% Data.workingtime  %]</td>
                   
                            [% RenderBlockEnd('TotalTable') %]
                     </tbody>
                </table>
            </div>
</div>
  [% RenderBlockEnd("EffortLogging") %]

 

        <!-- [% IF Data.MainWidgets; %]
                            
            <div class="WidgetSimple relatedTicket tab-content" >        
                [% FOREACH Widget IN Data.MainWidgets; %]
                    [% IF Widget.Async; %]
                        <div id="[% Widget.ElementID %]"></div>
                    [% ELSE; %]
                        [% Widget.Output %]
                    [% END; %]
                [% END; %]
            </div>
        [% END; %] -->
        </div>

  <!-- Document TAB -->
        <div class="WidgetSimple documenttab tab-content" >
  [% RenderBlockStart("DocumentTab") %]
  <div class="WidgetSimple">
                        <div class="Header">
                            <h2>[% Translate("Document List") | html %]</h2>
                        </div>
                        <div class="Content"  >
  <table class="DataTable [% Data.TableClasses | html %]">
                        <thead>
                            <tr>
                                <th >[% Translate("Ticket#") | html %]</th>
                                <th >[% Translate("Title#") | html %]</th>
                                <th >[% Translate("Summary") | html %]</th>
                                <th >[% Translate("Description") | html %]</th>
                                <th >[% Translate("State") | html %]</th>
                                <th >[% Translate("Queue") | html %]</th>
                                <th >[% Translate("Document") | html %]</th>
                                <th >[% Translate("Attachment") | html %]</th>
                                
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockStart("DocumentTabData") %]





<!-- ContentType
Filename -->


                            <tr class="">
                                <td>[% Translate(Data.TicketNumber) | html %]</td>
                                <td>[% Translate(Data.Title) | html %]</td>
                                <td>[% Translate(Data.Subject) | html %]</td>
                                <td>[% Translate(Data.Description) | html %]</td>
                               <td >  [% Translate(Data.State) | html %]</td>
                               <td >  [% Translate(Data.Queue) | html %]</td>
                               <td >  [% Translate(Data.Filename) | html %]</td>

                                 <td class="Attachments Center Attachment Fixed NonTextContent">
                                    
[% RenderBlockStart("TreeItemAttachmentDocument") %]


[% PROCESS ArticleAttachments.tt %]
[% RenderBlockEnd("TreeItemAttachmentDocument") %]

                                </td>
                                
                            </tr>
 [% RenderBlockEnd("DocumentTabData") %]
 

                        </tbody>
                    </table>
                </div>

                
</div>
  [% RenderBlockEnd("DocumentTab") %]

 

     
        </div>
        <!-- Document TAB -->

        <!-- Code for CAB Approval -->
        <div class="WidgetSimple CABApproval tab-content" >
  [% RenderBlockStart("CABApproval") %]
  <div class="WidgetSimple">
                        <div class="Header">
                            <h2>[% Translate("CAB Approval") | html %]</h2>
                        </div>
                        <div class="Content">
  <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                        <thead>
                            <tr>
                                <th class="No Sortable">[% Translate("Ticket#.") | html %]</th>
                                <th class="UnreadArticles">[% Translate("Title") | html %]</th>
                                <th class="Direction Sortable">[% Translate("State") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Owner") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Queue") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Approval Status") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Created") | html %]</th>
                                
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockStart("CABApprovalData") %]
                            <tr class="">
                                <td >[% Translate(Data.TicketNumber) | html %]</td>
                                <td >[% Translate(Data.Title) | html %]</td>
                                <td >[% Translate(Data.State) | html %]</td>                              
                                <td >  [% Translate(Data.Owner) | html %]</td>
                                <td >  [% Translate(Data.Queue) | html %]</td>
                                <td >  [% Translate(Data.DynamicField_CABApproval) | html %]</td>
                                <td >  [% Translate(Data.Created) | Localize('TimeShort') %]</td>
                                
                            </tr>
 [% RenderBlockEnd("CABApprovalData") %]
 

                        </tbody>
                    </table>
                </div>

</div>

  [% RenderBlockEnd("CABApproval") %]

        </div>
        <!-- Code for CAB Approval -->
        <!-- Visitor Details  -->
         <div class="WidgetSimple VisitorDetails tab-content" >

  <div class="WidgetSimple">
  <div class="Content ">
                            <table class="DataTable" id="dynamic_field">
                                <thead>
                                    <tr>


                                        <th>[% Translate("Visitor Name") | html %]</th>
                                        <th>[% Translate("Contact No") | html %]</th>
                                        <th>[% Translate("Email") | html %]</th>                                       
                                        <th>[% Translate("ID Type") | html %]</th>                                       
                                        <th>[% Translate("ID Proof") | html %]</th>
                                        <th>[% Translate("Designation") | html %]</th>
                                       
                                        
                                    </tr>
                                </thead>
                                <tbody>
         [% RenderBlockStart("VisitorDetails") %]
                            <tr class="">
                                

                                <td>[% Translate(Data.VisitorName) | html %]</td>
                                <td>[% Translate(Data.ContactNumber) | html %]</td>
                                <td>[% Translate(Data.Email) | html %]</td>
                                <td>[% Translate(Data.IDType) | html %]</td>                              
                                <td>  [% Translate(Data.IDProof) | html %]</td>                           
                                <td>  [% Translate(Data.Designation) | html %]</td>                           
                               
                                
                               
                                
                            </tr>
 [% RenderBlockEnd("VisitorDetails") %]
 
                                </tbody>
                            </table>
                        </div>
</div>

        </div>
        <!-- Visitor Details  -->
        <!-- SR2024030605000028 SHA details start -->
     <div class="WidgetSimple SHADetails tab-content" >

  <div class="WidgetSimple">
      <div class="Content ">
        <table class="DataTable" id="dynamic_field">
            <thead>
                <tr>
                    <th>[% Translate("SR Number") | html %]</th>
                    <th>[% Translate("Title") | html %]</th>
                    <!-- <th>[% Translate("Approver") | html %]</th> -->
                    <th>[% Translate("Approved By") | html %]</th>
                    <th>[% Translate("Approval Status") | html %]</th>
                </tr>
            </thead>
            <tbody>
               [% RenderBlockStart("SHADetails") %]
               <tr class="">
                <td>[% Translate(Data.TicketNumber) | html %]</td>
                <td>[% Translate(Data.Title) | html %]</td>
               <!--  <td>[% Translate(Data.Approver) | html %]</td> -->
                <td>[% Translate(Data.Approvedby) | html %]</td>
                <td>[% Translate(Data.ApprovalStatus) | html %]</td>
                
                
            </tr>
            [% RenderBlockEnd("SHADetails") %]
            
        </tbody>
    </table>
</div>
</div>

</div>
<!-- SR2024030605000028 SHA details End -->

                <!-- Code for CMDBUpdate -->
                                 <!-- 23 suraj added code start -->
        <div class="WidgetSimple SurveyTicket tab-content" >
        [% RenderBlockStart("SurveyTicket") %]
        <div class="WidgetSimple">
                    <div class="Header">
                        <h2>[% Translate("Survey Ticket") | html %]</h2>
                    </div>
                    <div class="Content">
        <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                    <thead>
                        <tr>
                            <th class="No Sortable">[% Translate("Ticket#.") | html %]</th>
                            <th class="UnreadArticles">[% Translate("Title") | html %]</th>
                            <th class="Direction Sortable">[% Translate("State") | html %]</th>
                            <th class="Sender Sortable">[% Translate("Type") | html %]</th>
                            <th class="Sender Sortable">[% Translate("Queue") | html %]</th>
                            <!-- <th class="Sender Sortable">[% Translate("Approval Status") | html %]</th> -->
                            <th class="Sender Sortable">[% Translate("Created") | html %]</th>
                            
                        </tr>
                    </thead>
                    <tbody>
        [% RenderBlockStart("SurveyTicketData") %]
                        <tr class="">
                            <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];"  title="[% Translate("Change Queue") | html %]">[% Data.TicketNumber %]</a></td>
                            <td >[% Translate(Data.Title) | html %]</td>
                            <td >[% Translate(Data.State) | html %]</td>                              
                            <td >  [% Translate(Data.Type) | html %]</td>
                            <td >  [% Translate(Data.Queue) | html %]</td>
                            <!-- <td >  [% Translate(Data.DynamicField_CABApproval) | html %]</td> -->
                            <td >  [% Translate(Data.Created) | Localize('TimeShort') %]</td>
                            
                        </tr>
        [% RenderBlockEnd("SurveyTicketData") %]


                    </tbody>
                </table>
            </div>

        </div>
        [% RenderBlockEnd("SurveyTicket") %]

        </div>
        <!-- 23 suraj added code end -->

        <!-- SR2024121205000017 -->
<!-- RHES Customization -->
<div class="WidgetSimple rhesActivity tab-content" >
   [% RenderBlockStart("RHESBlock") %]
   <div class="WidgetSimple">
      <div class="Header">
         <h2>[% Translate("Activity") | html %]</h2>
      </div>
      <div class="Content">
         <div id="tableSection">
            <table id="ActivityTable" class="display" cellspacing="0" width="100%">
               <thead>
                  <tr>
                     <th>Activity Description</th>
                     <th>Start Time</th>
                     <th>End Time</th>
                     <th>Remarks</th>
                     <th>Attachment</th>
                  </tr>
               </thead>
               <tbody id="tableBody">
               </tbody>
            </table>
            <button class="btn btn-primary" id="addBtn">Add</button>
         </div>
      
      <div  class="" id="formSection" style="display: none">
         <div class="Content" style="padding-left: 201px;">
           <div id="addForm">
    <fieldset class="TableLike col-md-12">
        <div class="col-md-10 mt-7" id="DescriptionData">
            <label for="Description">Activity Description:</label>
            <div class="Field">
                <textarea class="Description" id="Description" name="Description" title="Activity Description" rows="7" cols="70" data-maxlength="10105000"></textarea>
            </div>
        </div>
        <div class="col-md-5 mt-7" id="StartTimela">
            <label for="StartTime">Start Time:</label>
            <div class="Field">
                <input type="text" name="StartTime" id="StartTime">
            </div>
        </div>
        <div class="col-md-5 mt-7" id="EndTimela">
            <label for="EndTime">End Time:</label>
            <div class="Field">
                <input type="text" name="EndTime" id="EndTime">
            </div>
        </div>
        <div class="col-md-5 mt-7" id="Remarkss">
            <label for="Remarks">Remarks:</label>
            <div class="Field">
                <input type="text" name="Remarks" id="Remarks">
            </div>
        </div>
        <div class="col-md-5 mt-7" id="Attachments">
            <label for="Attachment">Attachment:</label>
            <div class="Field">
                <input type="file" name="Activityattachment" id="Attachment" accept=".jpg,.png,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.xlsm,.csv">
                    <p id="error" style="color: red;"></p>
            </div>
        </div>
        <div class="col-md-8">
            <div class="Field" style="margin-top: 28px;">
                <button id="submit" type="submit" class="btn btn-success">Submit</button>
                <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
            </div>
        </div>
    </fieldset>
</div>
         </div>
      </div>
   </div>

   [% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">
   let isFormSubmitted = false;
   
   /*SR2024121205000017*/

   document.getElementById('Attachment').addEventListener('change', function(event) {
        const file = event.target.files[0];
        const maxSize = 5 * 1024 * 1024; // 5 MB in bytes
        const allowedTypes = [
            'image/jpeg',
            'image/png',
            'application/pdf',
            'application/msword', // .doc
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document', // .docx
            'application/vnd.ms-powerpoint', // .ppt
            'application/vnd.openxmlformats-officedocument.presentationml.presentation', // .pptx
            'application/vnd.ms-excel', // .xls
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', // .xlsx
            'application/vnd.ms-excel.sheet.macroenabled.12', // .xlsm
            'text/csv' // .csv
        ];

        if (file) {
            // Check file type
            if (!allowedTypes.includes(file.type)) {
                document.getElementById('error').textContent = 'Invalid file type. Only JPG, PNG, and PDF files are allowed.';
                event.target.value = ''; // Clear the file input
                return;
            }

            // Check file size
            if (file.size > maxSize) {
                document.getElementById('error').textContent = 'File size exceeds the 2MB limit.';
                event.target.value = ''; // Clear the file input
                return;
            }

            // Clear error if validation passes
            document.getElementById('error').textContent = '';
        }
    });

   $(document).ready( function () {

     $("#rhes").click(function(){
        console.log('clicked');
        loadTableData();
    });

     
     $("#addBtn").click(function () {
         $("#tableSection").hide();
         $("#formSection").show();
     });

   // Cancel adding, show table and hide form
     $("#cancelBtn").click(function () {
         $("#formSection").hide();
         $("#tableSection").show();
     });

     //new DataTable('#ActivityTable');
     var table = new DataTable('#ActivityTable');

     let TicketID = "[% Data.TicketID %]";

     $("#submit").click(function (e) {

     // Get the form fields
        let description = document.getElementById('Description');
        let startTime = document.getElementById('StartTime');
        let endTime = document.getElementById('EndTime');
        let remarks = document.getElementById('Remarks');


    // Initialize validation flag
        let isValid = true;

    // Reset any previous error styles or messages
        let fields = [description, startTime, endTime, remarks];
        fields.forEach(field => {
        field.style.border = ''; // Reset border
    });

    // Validate Description
        if (!description.value.trim()) {
            description.style.border = '2px solid red';
            isValid = false;
        }

    // Validate Start Time
        if (!startTime.value.trim()) {
            startTime.style.border = '2px solid red';
            isValid = false;
        }

    // Validate End Time
        if (!endTime.value.trim()) {
            endTime.style.border = '2px solid red';
            isValid = false;
        }

    // Validate Remarks
        if (!remarks.value.trim()) {
            remarks.style.border = '2px solid red';
            isValid = false;
        }

    // Validate Attachment


    // If valid, submit the form
        if (isValid) {

        } else {
         alertify.alert('Mandatory', 'Fill all mandatory fields', function(){ alertify.success('Ok'); });
         return
     }
     console.log('addForm');
     e.preventDefault();


     isFormSubmitted = true;

     var formData = new FormData();
     formData.append("activityDescription", $("#Description").val());
     formData.append("activityStatTime", $("#StartTime").val());
     formData.append("activityEndTime", $("#EndTime").val());
     formData.append("activityRemarks", $("#Remarks").val());
     formData.append("activityAttachment", $("#Attachment")[0].files[0]);

   // Send the form data including file using AJAX
     $.ajax({
       url: "[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=RHESActivity;TicketID=[% Data.TicketID %]", 
       method: "POST",
       data: formData,
       contentType: false,
     processData: false, // This is necessary to send files via FormData
     success: function (response) {

         $("#formSection").hide();
         $("#tableSection").show();

         loadTableData();
         resetFormFields();
     },
     error: function (xhr, status, error) {
         alert("An error occurred: " + error);
     },
 });
 });

     function loadTableData() {
         $.ajax({
           url: "[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=RHESActivityData;TicketID=[% Data.TicketID %]", 
           method: "POST",
           data: "",
           contentType: false,
     processData: false, // This is necessary to send files via FormData
     success: function (response) {
         table.clear();  // Clear existing data
         table.rows.add(response);  // Add new data
         table.draw();
     }
 });
         console.log('testLoadData')
     }

     function resetFormFields() {
      $("#Description").val("");
      $("#StartTime").val("");
      $("#EndTime").val("");
      $("#Remarks").val("");
      $("#Attachment").val("");
  }

} );
   
    
   /*SR2024121205000017*/   
</script>
[% END %]
</div>
  [% RenderBlockEnd("RHESBlock") %] 
</div>

<!-- RHES Customization -->

<!-- SR2024121205000017 -->
        <div class="WidgetSimple CMDBUpdate tab-content" >
  [% RenderBlockStart("CMDBUpdate") %]
  <div class="WidgetSimple">
                        <div class="Header">
                            <h2>[% Translate("CMDBUpdate") | html %]</h2>
                        </div>
                        <div class="Content">
  <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                        <thead>
                            <tr>
                                <th class="No Sortable">[% Translate("Name.") | html %]</th>
                                <th class="UnreadArticles">[% Translate("Asset Category") | html %]</th>
                                <th class="Direction Sortable">[% Translate("Asset Type") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Asset Sub Type") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Serial") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Asset TAG ") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Status ") | html %]</th>
                                <th class="Sender Sortable">[% Translate("Quantity") | html %]</th>
                                <th class="Sender Sortable">[% Translate("owned") | html %]</th>
                                <th class="Sender Sortable">[% Translate("supported") | html %]</th>
                                <th class="Sender Sortable">[% Translate("used") | html %]</th>
                                
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockStart("CMDBUpdateData") %]
                            <tr class="">
                                

                                <td><a class="AsBlock " href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">Yotta DEV Application Server</a></td>
                                <td >[% Translate(Data.dname) | html %]</td>
                                <td >[% Translate(Data.assetcategory) | html %]</td>
                                <td >[% Translate(Data.asset_type) | html %]</td>                              
                                <td >  [% Translate(Data.asset_sub_type) | html %]</td>
                                <td >  [% Translate(Data.Serial) | html %]</td>
                                <td >  [% Translate(Data.asset_tag) | html %]</td>
                                <td >  [% Translate(Data.assetstatus) | html %]</td>
                                <td >  [% Translate(Data.quantity) | html %]</td>
                                <td >  [% Translate(Data.ownedby) | html %]</td>
                                <td >  [% Translate(Data.supportedby) | html %]</td>
                                <td >  [% Translate(Data.usedby) | html %]</td>
                                
                               
                                
                            </tr>
 [% RenderBlockEnd("CMDBUpdateData") %]
 

                        </tbody>
                    </table>
                </div>

</div>

  [% RenderBlockEnd("CMDBUpdate") %]

        </div>
        <div class="Clear"></div>
        <!-- Code for CMDBUpdate -->

         <div class="WidgetSimple lineitem tab-content" >

            <div class="WidgetSimple">
                        
                        <div class="Header">
                            <h2>[% Translate("Line Item") | html %]</h2>
                        </div> 
                         <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                <table class="DataTable FilterUnique_th2" id="SOFLine">
                     <thead>
                        
                        <tr>
                            <th col-index = 2><input type="checkbox" id="SOFLineall"/></th>
                            <th col-index = 3>[% Translate("Line Item.") | html %]</th>
                            <th col-index = 4 >[% Translate("SOF NO") | html %]</th>
                            <th col-index = 5>[% Translate("Line SR.NO.") | html %]</th>

                            <th col-index = 6>[% Translate("SCF Type") | html %]</th>
                            
                            <th col-index = 7>[% Translate("Original Line Item No.") | html %]</th>
                            <th col-index = 8>[% Translate("Product Family") | html %]</th>
                       
                             <th col-index = 9 >[% Translate("Product Model") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>
                           
                            <th col-index = 10 >[% Translate("Product Description") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>


                              <th col-index = 11 >[% Translate("Delivery Location") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>

                            <th th col-index = 12>[% Translate("Delivery Location Address") | html %]</th>
                         
                                <th col-index = 13 >[% Translate("Sale Type Tag") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>
                            <th col-index = 14 >[% Translate("Bill To") | html %]</th>
                            <th col-index = 15 >[% Translate("Support To") | html %]</th>
                            <th col-index = 16 >[% Translate("Bill Start Date") | html %]</th>
                            <th col-index = 17 >[% Translate("Bill End Date") | html %]</th>
                              <th col-index = 18 > [% Translate("BillEndDate Updated") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>
                            <th col-index = 19 >[% Translate("Technical Start Date") | html %]</th>
                            <th col-index = 20 >[% Translate("Technical End Date") | html %]</th>
                            <th col-index = 21 >[% Translate("Cancellation Date") | html %]</th>
                            <th col-index = 22 >[% Translate("Is Online") | html %]</th>
                         
                         <th col-index = 23 >[% Translate("Status") | html %] <select class="table-filter2" onchange="fileterLine_rows()"><option value="all">Select All</option></select></th>
                        


                        </tr>
                    </thead>
                    <tbody>
                            <tr>
                             [% RenderBlockStart('LineItem') %] 
                             [% IF Data.DynamicField_SCFType %]
                            <!-- <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];"  title="[% Translate("Change Queue") | html %]">[% Data.TicketNumber %]</a></td> -->

                            <td style="display: none;">[% Data.TicketID | html %]</td>
                            <td>
                                [% IF Data.State == "Amendment in progress" %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified1[]" class="SOFLintItemTask1" id ="[% Data.DynamicField_LineNumber %]1" value="[% Data.TicketID | html %]" disabled="disabled" />
                                [% ELSE %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="SOFLintItemTask" id ="[% Data.DynamicField_LineNumber %]" value="[% Data.TicketID | html %]"  />
                                [% END %]
                            
                            </td>

                            <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>
                           
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFNumber %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFLineSrNo %]</td>

                           <td style="background-color: #cececefc;">[% Data.DynamicField_SCFType %]</td>
                           <!-- <td style="background-color: #cececefc;"> [% Data.DynamicField_LineNumber %]</td> -->
                           <td style="background-color: #cececefc;">[% Data.DynamicField_OldLineNumber %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFProductFamily %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFProductModel %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_ProductDescription %]</td>

                           <!-- <td style="background-color: #cececefc;"> [% Data.DynamicField_SOFProductFamily %]</td>
                           <td style="background-color: #cececefc;"> [% Data.DynamicField_SOFProductModel %]</td> 
                           <td style="background-color: #cececefc;"> [% Data.DynamicField_ProductDescription %]</td> -->
                           <!-- <td style="background-color: #cececefc;"> [% Data.DynamicField_Location %]</td> -->
                           <td style="background-color: #cececefc;">[% Data.DynamicField_DeliveryLocation %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SOFSaleTypeTag %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_BillTo  %]</td>
                           <td style="background-color: #cececefc;">[% Data.DynamicField_SupportTo %]</td>
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                             <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_FirstBillEndDateResponded) || 'No'%]</td>
                           
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                           <td style="background-color: #cececefc;">[% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                           <td style="background-color: #cececefc;">[% Data.State %]</td>
                           <td style="display: none;">[% Data.LineItemSOFID | html %]</td>
                          
                           <!-- <td style="background-color: #cececefc;"> [% Data.DynamicField_Status %]</td> -->
                            

                            [% ELSE %]
                            <td style="display: none;">[% Data.TicketID | html %]</td>
                            <td>
                             
                                [% IF Data.State == "Amendment in progress" %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified1[]" class="SOFLintItemTask1" id ="[% Data.DynamicField_LineNumber %]1" value="[% Data.TicketID | html %]" disabled="disabled" />
                                [% ELSE %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="SOFLintItemTask" id ="[% Data.DynamicField_LineNumber %]" value="[% Data.TicketID | html %]"  />
                                [% END %]
                            
                            </td>
                            <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>

                           
                           <td>[% Data.DynamicField_SOFNumber  %]</td>
                           <td>[% Data.DynamicField_SOFLineSrNo %]</td>

                           <td>[% Data.DynamicField_SCFType %]</td>
                           <!-- <td> [% Data.DynamicField_LineNumber %]</td> -->
                           <td>[% Data.DynamicField_OldLineNumber %]</td>
                           <td>[% Data.DynamicField_SOFProductFamily %]</td>
                           <td>[% Data.DynamicField_SOFProductModel %]</td>
                           <td>[% Data.DynamicField_ProductDescription %]</td>

                           <!--<td> [% Data.DynamicField_SOFProductFamily %]</td>
                           <td> [% Data.DynamicField_SOFProductModel %]</td>
                           <td> [% Data.DynamicField_ProductDescription %]</td> -->
                           <!-- <td> [% Data.DynamicField_Location %]</td> -->
                           <td>[% Data.DynamicField_DeliveryLocation %]</td>
                           <td>[% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                           <td>[% Data.DynamicField_SOFSaleTypeTag %]</td>
                            <td>[% Data.DynamicField_BillTo  %]</td>
                            <td>[% Data.DynamicField_SupportTo %]</td>
                            <td>[% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                            <td>[% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                            <td>[% Translate(Data.DynamicField_FirstBillEndDateResponded) || 'NO' %]</td>
                            <td>[% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                            <td>[% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                            <td>[% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                            <td>[% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                            <td>[% Data.State %]</td>
                            <td style="display: none;">[% Data.LineItemSOFID | html %]</td>
                            <td>[% Data.DynamicField_BillEndDateEntered %]</td>
                            <!-- <td>[% Data.DynamicField_Status %]</td> -->
                            [% END %]
                        </tr>
                            

                            [% RenderBlockEnd('LineItem') %]
                     </tbody>
                </table>
          <script type="text/javascript">
     $(function(){
    var LineFinalIDs = "[%Data.LineItemSOFID%]";
    var Lineticketidss=[];
    //added code for fixing performance issue 20/04/2023
    var ALLLineIDs = "[% Data.AllLineID %]";
    //added code for fixing performance issue 20/04/2023

    // add multiple select / deselect functionality
    $("#SOFLineall").click(function () {
        Lineticketidss=[];

        // start Copied code from IRTask and updated variables for lineitems 
      // var AllChecks = document.getElementsByClassName('LintItemTask');
                    var AllChecks = document.getElementsByClassName('SOFLintItemTask');
                    $("#SOFLine > tbody > tr").each(function () {
                        if($(this).css('display') != 'none' ){
                           //if($(this).find('.SOFLintItemTask')[0].disabled == false){
                           if($(this).find('.SOFLintItemTask')[0]?.hasOwnProperty('disabled') == false){
                            // Added code for fixing performance on 27-04-2023
                            $(this).find('.SOFLintItemTask')[0].checked = $("#SOFLineall").is(':checked');
                            // Added code for fixing performance on 27-04-2023
                            }
                            // Added code for fixing performance on 27-04-2023
                        }
                    });

                    LineFinalIDs = "[% Data.TicketID %]";
                    $("#SOFLine input[type=checkbox]:checked").each(function () {
                        var row = $(this).closest("tr")[0];
                            const regex = /[a-z]/g;                 
                            var res = row.cells[0].innerHTML.match(regex);
                            
                            if(!res){ 
                                Lineticketidss.push(row.cells[0].innerHTML);
                            }
                                                   
                        });

                        var uniqueItems = Array.from(new Set(Lineticketidss));
                       /* if(uniqueItems){
                       
                        $('#SOFBulkData').removeClass("disable-click");
                    }  */
                     if(uniqueItems.length > 0){
                                     $('#SOFBulkData').removeClass("disable-click");
                                    }else{
                                         $('#SOFBulkData').addClass("disable-click");
                                    } 
                        document.getElementById("SOFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;TicketID=" + uniqueItems+";ID="+LineFinalIDs;
                        if(this.checked == false){

                          /*  alertify.confirm('Kindly select atleast one Line Item', function(e){

                                if (e) {
                                   $('.ReturnToPreviousPage').click();
                                   window.location.reload();

                               }
                           }

                           , function(){ alertify.error('No')

                           $('.ReturnToPreviousPage').click();
                           window.location.reload();

                       });*/
                            //document.getElementById("SOFBulkData").href= window.location.href;
                           // $('#SOFBulkData').addClass("disable-click");
                            //document.getElementById("SOFBulkData").addClass("disable-click");

                        }

             // End Copied code from IRTask and updated variables for lineitems 

                   /*        $(".SOFLintItemTask").click(function(){
                    if($(".SOFLintItemTask").length == $(".SOFLintItemTask:checked").length) {
                        document.getElementById("SOFLineall").checked = true;
                        $("#SOFLineall").attr("checked", "checked");
                    } else {
                        $("#LintItemTask").removeAttr("checked");
                        document.getElementById("SOFLineall").checked = false;
                    }
                });*/

        //commented on 06 OCT 2023 to make lineitems selection work like IR tasks
          /* $('.SOFLintItemTask').attr('checked', this.checked);
           if("Data.DynamicField_LineNumber"){
                if(document.getElementById("[% Translate(Data.DynamicField_LineNumber) | html %]")){
                    document.getElementById("[% Translate(Data.DynamicField_LineNumber) | html %]").checked = this.checked;
                }
           }
           //added code for fixing performance issue 20/04/2023
            Lineticketidss.push(ALLLineIDs);
            if(this.checked == true){
                var uniqueItems = Array.from(new Set(Lineticketidss))
                document.getElementById("SOFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;TicketID=" + uniqueItems+";ID="+LineFinalIDs;
            }
            if(this.checked == false){
                document.getElementById("SOFBulkData").href= window.location.href;
            }
         */

    });

    // // if all checkbox are selected, check the selectall checkbox
    // // and viceversa
    // Commented code for fixing performance issue on 21/04/2023
    // $(".SOFLintItemTask").click(function(){
    //     if($(".SOFLintItemTask").length == $(".SOFLintItemTask:checked").length) {
    //         document.getElementById("SOFLineall").checked = true;
    //         $("#SOFLineall").attr("checked", "checked");
    //     } else {
    //         $("#SOFLineall").removeAttr("checked");
    //         document.getElementById("SOFLineall").checked = false;
    //     }
    // });
    // Commented code for fixing performance issue on 21/04/2023
   });  
</script>
                <div class="Field" style="padding-top: 1%;">
                        <a href="#" class="AsPopup PopupType_TicketAction disable-click" id="SOFBulkData" style="padding: .80em 2em">Bulk Update</a>
                    </div>
            </div>
        </div> 
        <script type="text/javascript">
            getUniqueValuesFromColumnLineItems();
                var table, i, x, y,no,SOFLintItemTaskFinalID;
                var ticketids=[]; 
                table = document.getElementById("SOFLine"); 
                var switching = true; 
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    if(sub){
                        $('#hide[% Data.tabid %]').show();
                           
                    }else{
                         $('#hide[% Data.tabid %]').hide();
                    }
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
                         x = rows[i].getElementsByTagName("TD")[4]; 
                         y = rows[i + 1].getElementsByTagName("TD")[4];
                         var h = rows[i].getElementsByTagName("TD")[22];
                         if(h){
                             SOFLintItemTaskFinalID = h.innerHTML;
                         }
                         if(x){
                            if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                               { 
                                Switch = true; 
                                break; 
                            } 
                         }
                    } 
                    if (Switch) { 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }
 
            var x,y;
              function reply_click(clicked_id)
                {
                    y = document.getElementById(clicked_id).className;
                    y = ".".concat(y);
                    x = "input";
                    x = x.concat(y);
                }


          
            $("td").on("click", x, function(){
                            var ticketids=[];

                            SOFLintItemTaskFinalID = [% Data.TicketID %];
                             // added code for fixing performance issue on 21/04/2023
                            if($(".SOFLintItemTask").length == $(".SOFLintItemTask:checked").length) {
                                document.getElementById("SOFLineall").checked = true;
                                $("#SOFLineall").attr("checked", "checked");
                            } else {
                                $("#SOFLineall").removeAttr("checked");
                                document.getElementById("SOFLineall").checked = false;
                            }
                             // added code for fixing performance issue on 21/04/2023
                               $("#SOFLine input[type=checkbox]:checked").each(function () {
                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML;  
                                    // var FinalID = row.cells[22].innerHTML;
                                    this.value = this.checked ? id : 0;
                                    const regex = /[a-z]/g;                 
                                    var res = id.match(regex);
                                    if(!res){
                                            // this.value = this.checked ? id : 0;
                                        ticketids.push(id);
                                    }
                                    var uniqueItems = Array.from(new Set(ticketids))
                                    if(uniqueItems){
                                     $('#SOFBulkData').removeClass("disable-click");
                                    }
                                    document.getElementById("SOFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;TicketID=" + uniqueItems+";ID="+SOFLintItemTaskFinalID;
                                         
                                });
                                $("#SOFLine input[type=checkbox]:not(:checked)").each(function () {
                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML; 
                                    this.value = 0;
                                    var ids = ticketids.indexOf(id);
                                    if(ids !== -1){
                                         const regex = /[a-z]/g;                 
                                            var res = id.match(regex);
                                            if(!res){
       
                                               delete ticketids[ids];
                                            }
                                    }
                                    var uniqueItems = Array.from(new Set(ticketids))
                                    /*console.log('items' ,uniqueItems.length);*/
                                    if(uniqueItems.length > 0){
                                     $('#SOFBulkData').removeClass("disable-click");
                                    }else{
                                         $('#SOFBulkData').addClass("disable-click");
                                    }
                                    document.getElementById("SOFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;TicketID=" + uniqueItems+";ID="+ SOFLintItemTaskFinalID;
                                    
                                });
                                    
                            }).change();



</script>     
</div>
        <div class="WidgetSimple IRlineitem tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Line Item") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" >
                        <thead>
                            <tr>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Line Item") | html %]</th>                                
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('LineItem1') %]</tr>
                             <td>[% Data.DynamicField_SOFNumber  %]</td> 
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.PrevLineItemNumber %]</td>
                   
                            [% RenderBlockEnd('LineItem1') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        <div class="WidgetSimple IRDetail tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("IR Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="LineIRDetail">
                        <thead>
                            <tr>
                                <th>[% Translate("IR") | html %]</th>
                                <th>[% Translate("Line Item") | html %]</th>
                                <th>[% Translate("Line SR.No") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                               <!--  <th>[% Translate("Total Tasks") | html %]</th> -->
                                <th>[% Translate("IR Status") | html %]</th>
                                
                                
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('IRDetails') %]</tr>
                             [% IF Data.DynamicField_SCFType %]
                             [% IF Data.IRNumber %]
                             <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketID | uri %];">[% Data.IRNumber %]</a></td>
                            <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];" >[% Data.DynamicField_LineNumber %]</a></td>
                            <td style="background-color: #cececefc;">[% Data.DynamicField_SOFLineSrNo %]</td>
                            <td style="background-color: #cececefc;">[% Data.DynamicField_SOFNumber %]</td>
                            <td style="background-color: #cececefc;">[% Data.TasksCount %]</td>
                            <td style="background-color: #cececefc;">[% Data.IRState %]</td>
                            [% END %]                            

                             [% ELSE %]
                             [% IF Data.IRNumber %]
                             <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketID | uri %];">[% Data.IRNumber %]</a></td>
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];" >[% Data.DynamicField_LineNumber %]</a></td>
                            
                            <td>[% Data.DynamicField_SOFLineSrNo %]</td>
                            <td>[% Data.DynamicField_SOFNumber %]</td>
                           <!--  <td>[% Data.TasksCount %]</td> -->
                            <td>[% Data.IRState %]</td>
                            [% END %]
                            [% END %]
                            
                           
                           <!-- <td> [% Data.DynamicField_SOFNumber  %]</td> -->
                   
                            [% RenderBlockEnd('IRDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

    <script type="text/javascript">
                var  x, y;
                var ticketids=[]; 
                table = document.getElementById("LineIRDetail"); 
                var switching = true; 
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    if(sub){
                        $('#hide[% Data.tabid %]').show();
                           
                    }else{
                         $('#hide[% Data.tabid %]').hide();
                    }
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
                        x = rows[i].getElementsByTagName("TD")[2]; 
                        y = rows[i + 1].getElementsByTagName("TD")[2];
                        if(x){
                            if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                            { 
                                Switch = true; 
                                break; 
                            } 
                        }
                        
                    } 
                    if (Switch) { 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }
        </script>
         <!-- Code for MRQ start -->
        <div class="WidgetSimple MRlineitem tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Line Item") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" >
                        <thead>
                            <tr>
                                <th>[% Translate("Line Item.") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Line SR.NO.") | html %]</th>
                                <th>[% Translate("SCF Type") | html %]</th>
                                <th>[% Translate("Line Item No.") | html %]</th>
                                <th>[% Translate("Original Line Item No.") | html %]</th>
                                <th>[% Translate("Product Family") | html %]</th>
                                <th>[% Translate("Product Model") | html %]</th>
                                <th>[% Translate("Product Description") | html %]</th>
                                <th>[% Translate("Location") | html %]</th>
                                <th>[% Translate("Delivery Location Address") | html %]</th>
                                <th>[% Translate("Sale Type Tag") | html %]</th>
                                <th>[% Translate("Bill To") | html %]</th>
                                <th>[% Translate("Support To") | html %]</th>
                                <th>[% Translate("Bill Start Date") | html %]</th>
                                <th>[% Translate("Bill End Date") | html %]</th>
                                <th>[% Translate("Technical Start Date") | html %]</th>
                                <th>[% Translate("Technical End Date") | html %]</th>
                                <th>[% Translate("Status") | html %]</th>
                                
                                
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                            [% RenderBlockStart('MRLineDetails') %]</tr>
                                <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];"> [% Data.TicketNumber  %]</td>
                                <td> [% Data.DynamicField_SOFNumber  %]</td>
                                <td> [% Data.DynamicField_SOFLineSrNo %]</td>
                                <td> [% Data.DynamicField_SCFType %]</td>
                                <td> [% Data.DynamicField_LineNumber %]</td>
                                <td> [% Data.DynamicField_OldLineNumber %]</td>
                                <td> [% Data.DynamicField_SOFProductFamily %]</td>
                                <td> [% Data.DynamicField_SOFProductModel %]</td>
                                <td> [% Data.DynamicField_ProductDescription %]</td>
                                <td> [% Data.DynamicField_Location %]</td>
                                <td> [% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                                <td> [% Data.DynamicField_SOFSaleTypeTag %]</td>
                                <td> [% Data.DynamicField_BillTo  %]</td>
                                <td>[% Data.DynamicField_SupportTo %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                                 <td>[% Data.State %]</td>
                   
                            [% RenderBlockEnd('MRLineDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        <!-- Code for MRQ end   -->

  <!-- <div class="WidgetSimple Task tab-content" > -->
<!-- [% RenderBlockStart("DynamicTabCreatePartDisply") %]
            <div class="WidgetSimple" id='dis' style="display: none;">
                <div class="ControlRow1">
                    <ul class="Tabs">
                        [% RenderBlockStart("DynamicTabCreatePart") %]
                        [% IF Data.tabid * 1 != Data.tabid %]
                        <li title="[% Data.tabname %]" >
                            <a class="tab" data-id="[% Data.tabid %]" style="color: red"><span class="tab_icon"></span> <span class='tab_text'>[% Data.tabname %]</span></a>
                        </li>
                        [% ELSE %]
                        <li title="[% Data.tabname %]" >
                            <a class="tab" data-id="[% Data.tabid %]"><span class="tab_icon"></span> <span class='tab_text'>[% Data.tabname %]</span></a>
                        </li>
                        [% END %]
                        [% RenderBlockEnd("DynamicTabCreatePart") %]
                    </ul>
                </div>
            </div>
[% RenderBlockEnd("DynamicTabCreatePartDisply") %] -->

<!-- <script type="text/javascript">

    $('#IRTask1').on('click', function(){
        var div = document.getElementById('dis');
        var Task = document.getElementById('IRTask1');
        // alert(Task.getAttribute("attr"));

        if(div.getAttribute("style") == "display: none;"){
            div.style = "display: show;";
        }
    });

    $('#common1').on('click', function(){
        var div = document.getElementById('dis');
        div.style = "display: none;";
    });

    $('#common2').on('click', function(){
        var div = document.getElementById('dis');
        div.style = "display: none;";
    });

</script> -->
        <!-- [% RenderBlockStart('GetID') %] -->
            
                        
                      <!--   <div class="Header">
                            <h2>[% Translate("Tasks") | html %]</h2>
                        </div> 
                         <div class="Content" style="float:left; width:99%;padding-top: 1%;"> -->

                    

           
           [% RenderBlockStart("DynamicTabCreatePart1") %]
            [% IF Data.Lminval == "first" %]
                <div class="WidgetSimple [% Data.tabid %] Task tab-content">
            [% ELSE %]
                <div class="WidgetSimple [% Data.tabid %] tab-content">
            [% END %]
            <div class="WidgetSimple">
             <form  action="[% Env("CGIHandle") %]" method="post" class="Validate PreventMultipleSubmits">
                    <input type="hidden" name="Action" id="Action" value="AgentTicketTaskBulk"/>
                    <!-- <input type="hidden" name="Subaction" id="Subaction" value="AJAXUpdate" /> -->

                    <!-- <input type="hidden" name="Action" id="Action" value="AgentTicketTaskBulk"/>
                     <input type="hidden" name="Subaction" id="Subaction" value="TaskBulk" />  -->
                    <input type="hidden" id = "data" value="[% Data.TicketID | html %]" name="TicketID"/>
                    <div class="Header">
                            <h2>[% Translate("Tasks Details") | html %]</h2>
                        </div> 
                         <div class="Content" style="float:left; width:99%;padding-top: 1%; overflow:scroll; height:350px;"> 
                <table class="DataTable" id="table[% Data.tabid %]">
                     <thead>
                        
                        <tr>
                             <th><input type="checkbox" id="IRTaksselectall"/></th>
                            <th>[% Translate("Tasks") | html %]</th>
                            <th>[% Translate("Task Sequence") | html %]</th>
                            <th>[% Translate("Task Description") | html %]</th>
                            <th>[% Translate("Product Model") | html %]</th>
                            <th>[% Translate("IR") | html %]</th>
                            <th>[% Translate("Line Item") | html %]</th>
                            <th>[% Translate("SOF NO") | html %]</th>
                            <th>[% Translate("Asigned Team") | html %]</th>
                            <th>[% Translate("Asigned To") | html %]</th>
                            <th>[% Translate("Task Status") | html %]</th>

                        </tr>
                    </thead>
                    <tbody>
                             [% RenderBlockStart('TaskGet') %] 

                            <tr>
                             <td style="display: none;">[% Data.TaskKey | html %]</td>
                             <td style="display: none;">[% Data.Num | html %]</td>
                             <td>
                                [% IF Data.LineStatus == "Amendment in progress" %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="IRTask23" class="IRTask23" id ="[% Data.tabid1 %][% Data.TaskKey | html %]" value="[% Data.certified | html %]" disabled="disabled" />
                                [% ELSE %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="IRTask2" class="IRTask2" id ="[% Data.tabid %][% Data.TaskKey | html %]" value="[% Data.certified | html %]"  />
                                [% END %]
                                
                            
                            </td>
                            
                            <!-- <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];"  title="[% Translate("Change Queue") | html %]">[% Data.TicketNumber %]</a></td> -->
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %];">[% Data.TaskNumber %]</a></td>
                              <td>[% Data.Sequence %]</td>

                              <td>[% Data.Description %]</td>     
                              <td>[% Data.part_name %]</td>

                              
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketId | uri %];">[% Data.IRNumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %];">[% Data.LineItemNumber1 %]</a></td>
                            <td>[% Data.DynamicField_SOFNumber %]</td>
                            <td>[% Data.AsignedTeam %]</td>
                            <td>[% Data.AsignedTo %]</td>
                            <td>[% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.IRTicketId %]</td>
                            <td style="display: none;">[% Data.tabid %][% Data.TaskKey %]</td>
                        </tr>
                            
<script type="text/javascript">
     $(function(){
var IRLastFinalIDs;
var IRLastticketidss=[];
    // add multiple select / deselect functionality
        $("#IRTaksselectall").click(function () {
           $('.IRTask2').attr('checked', this.checked);
           if("[% Data.tabid %][% Data.TaskKey%]"){
                 document.getElementById("[% Data.tabid %][% Data.TaskKey | html %]").checked = this.checked;
           }
           IRLastFinalIDs = "[%Data.IRTicketId%]";
          
        $("#table[% Data.tabid %] input[type=checkbox]:checked").each(function () {
               var row = $(this).closest("tr")[0];
               var id = row.cells[0].innerHTML; 
               this.value = this.checked ? id : 0;
               var h1 = document.getElementById("All[% Data.TaskKey %]").disabled;
               const regex = /[a-z]/g; 
               var res = id.match(regex);
                if(!res){
                    this.value = this.checked ? id : 0;
                          IRLastticketidss.push(id);
                 }
                if(h1){
                    document.getElementById("All[% Data.TaskKey %]").checked = false;
                 
                }
               var uniqueItems = Array.from(new Set(IRLastticketidss))
                                     
               document.getElementById("[% Data.tabid %]").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRLastFinalIDs;
               document.getElementById("[% Data.tabid %]BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRLastFinalIDs;
          });
          $("#table[% Data.tabid %] input[type=checkbox]:not(:checked)").each(function () {
              var row = $(this).closest("tr")[0];
              var id = row.cells[0].innerHTML;

              this.value = 0;
              var ids = IRLastticketidss.indexOf(id);
              if(ids !== -1){
                  const regex = /[a-z]/g;                 
                  var res = id.match(regex);
                  if(!res){
                      this.value = 0;
                     delete IRLastticketidss[ids];
                    }
                }   
                                      
              var uniqueItems = Array.from(new Set(IRLastticketidss))
              document.getElementById("[% Data.tabid %]BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRLastFinalIDs;
              document.getElementById("[% Data.tabid %]").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRLastFinalIDs;   
          });   
    });

    // // if all checkbox are selected, check the selectall checkbox
    // // and viceversa
    $(".IRTask2").click(function(){
        var v1 = $(".IRTask2").length;
        var v2 = $(".IRTask2:checked").length;
        if($(".IRTask2").length == $(".IRTask2:checked").length) {
            document.getElementById("IRTaksselectall").checked = true;
            $("#IRTaksselectall").attr("checked", "checked");
        } else {
            $("#IRTaksselectall").removeAttr("checked");
            document.getElementById("IRTaksselectall").checked = false;
        }
    });
   });      

 </script>
 [% RenderBlockEnd('TaskGet') %]
                            
                     </tbody>

                </table>

                <div class="Field" style="padding-top: 1%;">
    <!-- <input type="button" onclick = "Warn();" value="Submit Form"> -->
     <!-- <input type="Submit" name="Resolve" value="Resolve" class="DynamicFieldDelete" id = "hide[% Data.tabid %]" onclick="window.location.href='[% Env("Baselink") %]Action=AgentTicketTaskBulk;TicketID=[% Data.TicketID | html %]';" >  -->
<a href="#" class="AsPopup PopupType_TicketAction " id="[% Data.tabid %]" style="color: #F92;">Bulk Update</a>
<a href="#" class="AsPopup PopupType_TicketAction " id="[% Data.tabid %]BulkResolve" style="color: #F92;">Bulk Resolve</a>
<!-- <a href="/tussom/SupportDesk?Action=Projects;Subaction=Add;TicketID=11034">Create Project</a> -->
       <!-- <input type="Submit" name="Resolve" value="Resolve"  id = "hide[% Data.tabid %]" target = "popup" >  -->
                <!-- <button class="CallForAction Primary" id="SubmitAndContinue" type="button" value="[% Translate("Save") | html %]"><span>[% Translate("Submit") | html %]</span></button> -->
                
            </div>
                </div>



                
            </form>
    </div>
</div>

<script type="text/javascript">


                var table, i, x, y,no,TAfinalID;
                var ticketids=[]; 
                table = document.getElementById("table[% Data.tabid %]"); 
                var switching = true; 
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    if(sub){
                        $('#hide[% Data.tabid %]').show();
                           
                    }else{
                         $('#hide[% Data.tabid %]').hide();
                    }
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
                        x = rows[i].getElementsByTagName("TD")[4]; 
                        y = rows[i + 1].getElementsByTagName("TD")[4];
                        var s = rows[i + 1].getElementsByTagName("TD")[13];
                        TAfinalID = s.innerHTML;
                        if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                            { 
                            Switch = true; 
                            break; 
                        } 
                    } 
                    if (Switch) { 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }
                var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    for (i = 1; i < (rows.length - 1); i++) { 
                        x = rows[i].getElementsByTagName("TD")[4]; 
                        y = rows[i + 1].getElementsByTagName("TD")[4];
                        state = rows[i].getElementsByTagName("TD")[12];
                        var desc = rows[i+1].getElementsByTagName("TD")[5];
                        
                        if (desc.innerHTML == "Update CI" || desc.innerHTML == "Audit Task") {
                            if(state.innerHTML != "Resolved"){
                                if(state.innerHTML != "Cancelled"){
                                    if(state.innerHTML != "Closed"){
                                        var hidefir = rows[i + 1].getElementsByTagName("TD")[14];
                                        document.getElementById(hidefir.innerHTML).disabled = true;
                                    }
                                }
                            }
                        }
                        if(state.innerHTML == "Resolved" || state.innerHTML == "Cancelled" || state.innerHTML == "Closed"){
                            var tablength = rows.length - 1;
                            var tablengthpre = rows.length - 2;
                            var lsat =rows[tablengthpre].getElementsByTagName("TD")[12];
                            if( lsat.innerHTML == "Resolved" || lsat.innerHTML == "Cancelled" || lsat.innerHTML == "Closed"){
                                var hidefir = rows[tablength].getElementsByTagName("TD")[14];
                                document.getElementById(hidefir.innerHTML).disabled = false;
                                break;
                            }else{
                                var hidefir = rows[tablength].getElementsByTagName("TD")[14];
                                document.getElementById(hidefir.innerHTML).disabled = true;
                            }
                            
                        }

                        
                    }  

                            


                           
                            function reply_click(clicked_id)
                              {
                
                                    y = document.getElementById(clicked_id).className;
                                  
                                     y = ".".concat(y);
                                     x = "input";
                                     x = x.concat(y);
                                     
                                   
                              }

                            
                             $("td").on("click", x, function(){

                                
                               $("#table[% Data.tabid %] input[type=checkbox]:checked").each(function () {
                                     var row = $(this).closest("tr")[0];
                                     var id = row.cells[0].innerHTML; 

                                     this.value = this.checked ? id : 0;
                                     const regex = /[a-z]/g;
                                     var res = id.match(regex);
                                     if(!res){
                                        this.value = this.checked ? id : 0;
                                        ticketids.push(id);
                                     }
                                     var uniqueItems = Array.from(new Set(ticketids))
                                     
                                     document.getElementById("[% Data.tabid %]").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+TAfinalID;
                                     document.getElementById("[% Data.tabid %]BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+TAfinalID;

                                });
                                $("#table[% Data.tabid %] input[type=checkbox]:not(:checked)").each(function () {
                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML;

                                    this.value = 0;


                                    var ids = ticketids.indexOf(id);

                                    if(ids !== -1){
                                        const regex = /[a-z]/g;                 
                                        var res = id.match(regex);
                                        if(!res){
                                            this.value = 0;
                                           delete ticketids[ids];
                                       }
                                    }
                                      
                                    var uniqueItems = Array.from(new Set(ticketids))
                                    document.getElementById("[% Data.tabid %]BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+TAfinalID;
                                    document.getElementById("[% Data.tabid %]").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+TAfinalID;
                                });     
                            }).change();
</script>


[% RenderBlockEnd("DynamicTabCreatePart1") %]


        <!-- </div>  -->
        <!-- [% RenderBlockEnd('GetID') %]               -->
   <!--  </form>
</div>


 </div> -->
<div class="WidgetSimple SOFLinkSOF tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("SOF Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("SOF") | html %]</th>
                                <th>[% Translate("SOF Number ") | html %]</th>
                                <th>[% Translate("Location") | html %]</th>
                                <th>[% Translate("SOF Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('SOFLinkSOF') %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                              <td>[% Data.DynamicField_SOFNumber %]</td>
                              <td>[% Data.DynamicField_Location %]</td>
                              <td>[% Data.State %]</td>
                            </tr> 
                            [% RenderBlockEnd('SOFLinkSOF') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

        <div class="WidgetSimple IRTasks tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Task Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable FilterUnique_th" id="IRTasktable" >
                        <thead>
                            <tr>
                                <th col-index = 2 ><input type="checkbox" id="IRTasktableselectall"/></th>
                                <th col-index = 3 >[% Translate("Tasks") | html %]</th>
                                <th col-index = 4 >[% Translate("Task Sequence") | html %]</th>
                                <th col-index = 5 >[% Translate("Product Model") | html %] <select class="table-filter" onchange="filter_rows()"><option value="all">Select All</option></select></th>
                                <th col-index = 6 >[% Translate("Task Description") | html %] <select class="table-filter" onchange="filter_rows()"><option value="all">Select All</option></select></th>
                                <th col-index = 7 >[% Translate("IR") | html %]</th>
                                <th col-index = 8 >[% Translate("Line Item") | html %]</th>
                                <th col-index = 9 >[% Translate("SOF NO") | html %]</th>
                                <th col-index = 10 >[% Translate("Assign Team") | html %] <select class="table-filter" onchange="filter_rows()"><option value="all">Select All</option></select></th>
                                <th col-index = 11 >[% Translate("Assign To") | html %] <select class="table-filter" onchange="filter_rows()"><option value="all">Select All</option></select></th>
                                <th col-index = 12 >[% Translate("Task Status") | html %] <select class="table-filter" onchange="filter_rows()"><option value="all">Select All</option></select></th>    
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('TaskDetails') %]
                            [% IF Data.DynamicField_SCFType == "Price Change" %]
                            [% IF Data.TaskNumber %]
                             <td style="display: none;">[% Data.TaskKey | html %]</td>

                              <td>
                             
                                [% IF Data.LineStatus == "Amendment in progress" %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="LintItemTask" id ="[% Data.LineItemID %][% Data.TaskKey | html %]" value="[% Data.certified | html %]" disabled="disabled" />
                                [% ELSE %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="LintItemTask" id ="[% Data.LineItemID %][% Data.TaskKey | html %]" value="[% Data.certified | html %]"  />
                                [% END %]
                            
                            </td>


                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %];">[% Data.TaskNumber %]</a></td>
                              <td style="background-color: #cececefc;" class="Taskseq">[% Data.Sequence %] || 'NA'</td>
                              <td style="background-color: #cececefc;" class="Taskseq">[% Data.part_name %]</td>
                              <td style="background-color: #cececefc;">[% Data.Description %]</td>
                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketId | uri %];">[% Data.IRNumber %]</a></td>
                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %];">[% Data.LineItemNumber1 %]</a></td>
                            <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.FinalID | uri %]">[% Data.DynamicField_SOFNumber %]</a></td>
                              <td style="background-color: #cececefc;">[% Data.AsignedTeam %]</td>
                              <td style="background-color: #cececefc;">[% Data.AsignedTo %]</td>
                            <td style="background-color: #cececefc;"> [% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.FinalID | html %]</td>
                            <td style="display: none;">[% Data.LineItemID %][% Data.TaskKey | html %]</td>
                            <td style="display: none;"  class="linesort">[% Data.LineItemNumber1 %]</a></td>
                            [% END %]
                            [% ELSE %]
                             [% IF Data.TaskNumber %]
                              <td style="display: none;">[% Data.TaskKey | html %]</td>
                              <td>
                             
                                [% IF Data.LineStatus == "Amendment in progress" %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="LintItemTask" id ="[% Data.LineItemID %][% Data.TaskKey | html %]" value="[% Data.certified | html %]" disabled="disabled" />
                                [% ELSE %]
                                    <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="LintItemTask" id ="[% Data.LineItemID %][% Data.TaskKey | html %]" value="[% Data.certified | html %]"  />
                                [% END %]
                            
                            </td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %];">[% Data.TaskNumber %]</a></td>
                              <td class="Taskseq">[% Data.Sequence %]</td>
                              <td>[% Data.part_name %]</td>
                              <td>[% Data.Description %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketId | uri %];">[% Data.IRNumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %];">[% Data.LineItemNumber1 %]</a></td>
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.FinalID | uri %]">[% Data.DynamicField_SOFNumber %]</a></td>
                            <td>[% Data.AsignedTeam %]</td>
                            <td>[% Data.AsignedTo %]</td>
                            <td> [% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.FinalID | html %]</td>
                            <td style="display: none;">[% Data.LineItemID %][% Data.TaskKey | html %]</td>
                            <td style="display: none;"  class="linesort">[% Data.LineItemNumber1 %]</a></td>
                            [% END %]
                            [% END %]
                            </tr>                           
                           <!-- <td> [% Data.DynamicField_SOFNumber  %]</td> -->
<script type="text/javascript">
//     $(function(){
//     var IRTasksFinalIDs;
//     var IRTasksticketidss=[];

//     // add multiple select / deselect functionality
//     $("#IRTasktableselectall").click(function () {
//            $('.LintItemTask').attr('checked', this.checked);
//              if("[% Data.LineItemID %][% Data.TaskKey%]"){
//                  document.getElementById("[% Translate(Data.LineItemID) | html %][% Translate(Data.TaskKey) | html %]").checked = this.checked;
//             }

//             IRTasksFinalIDs = "[%Data.FinalID%]";
//            $("#IRTasktable input[type=checkbox]:checked").each(function () {
//                var row = $(this).closest("tr")[0];
//                 const regex = /[a-z]/g;                 
//                 var res = row.cells[0].innerHTML.match(regex);
//                 if(!res){ 
//                     IRTasksticketidss.push(row.cells[0].innerHTML);
//                 }
//                 if(document.getElementById("[% Data.LineItemID %][% Data.TaskKey | html %]").disabled){
//                     document.getElementById("[% Data.LineItemID %][% Data.TaskKey | html %]").checked = false; 
//                 }                            
//             });
//            var uniqueItems = Array.from(new Set(IRTasksticketidss))
//             document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
//             document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
//             $("#IRTasktable input[type=checkbox]:not(:checked)").each(function () {
//                 var row = $(this).closest("tr")[0];
//                 var id = row.cells[0].innerHTML; 
//                 // var FinalID = row.cells[22].innerHTML; 
//                 this.value = 0;
//                 var ids = IRTasksticketidss.indexOf(id);
//                 if(ids !== -1){
//                     const regex = /[a-z]/g;                 
//                     var res = id.match(regex);
//                     if(!res){
//                             // this.value = 0;
//                        delete IRTasksticketidss[ids];
//                     }
//                 }
//                 var uniqueItems = Array.from(new Set(IRTasksticketidss))
//                document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
//                document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
                                    
//             });

//     });

//     // // if all checkbox are selected, check the selectall checkbox
//     // // and viceversa
//     $(".LintItemTask").click(function(){
//         if($(".LintItemTask").length == $(".LintItemTask:checked").length) {
//             document.getElementById("SOFLineall").checked = true;
//             $("#IRTasktableselectall").attr("checked", "checked");
//         } else {
//             $("#LintItemTask").removeAttr("checked");
//             document.getElementById("IRTasktableselectall").checked = false;
//         }
//     });
//    });  

    
</script>                   
                   
                            [% RenderBlockEnd('TaskDetails') %]
                        </tbody>
                    </table>

                    <script type="text/javascript">
                        getUniqueValuesFromColumn() ;
                        getUniqueValuesFromColumnLineItems() ;      
                    </script>
                    <div class="Field" style="padding-top: 1%;">
    
                        <a href="#" class="AsPopup PopupType_TicketAction" id="BulkData" style="padding: .80em 2em">Bulk Update</a>

                        <a href="#" class="AsPopup PopupType_TicketAction" id="BulkResolve" style="padding: .80em 2em">Bulk Resolve</a>
                
                    </div>
                </div>
            </div>       
        </div>

        <script> 
            $(function(){
                var IRTasksFinalIDs;
                var IRTasksticketidss=[];

                // add multiple select / deselect functionality
                $("#IRTasktableselectall").click(function () {
                    IRTasksticketidss=[];
                    // var AllChecks = document.getElementsByClassName('LintItemTask');
                    var AllChecks = document.getElementsByClassName('LintItemTask');
                    $("#IRTasktable > tbody > tr").each(function () {
                        if($(this).css('display') != 'none' ){
                            // Added code for fixing performance on 27-04-2023
                            if($(this).find('.LintItemTask')[0].disabled == false){
                            // Added code for fixing performance on 27-04-2023
                                $(this).find('.LintItemTask')[0].checked = $("#IRTasktableselectall").is(':checked');
                            // Added code for fixing performance on 27-04-2023
                            }
                            // Added code for fixing performance on 27-04-2023
                        }
                    });
                    // $('.LintItemTask').attr('checked', this.checked);
                    // for (var i=0; i < AllChecks.length; i++) {
                    //     AllChecks[i].checked = this.checked;
                    // }
                        // if("[% Data.LineItemID %][% Data.TaskKey%]"){
                        //     document.getElementById("[% Translate(Data.LineItemID) | html %][% Translate(Data.TaskKey) | html %]").checked = this.checked;
                        // }

                    IRTasksFinalIDs = "[% Data.TicketID %]";
                    $("#IRTasktable input[type=checkbox]:checked").each(function () {
                        var row = $(this).closest("tr")[0];
                            const regex = /[a-z]/g;                 
                            var res = row.cells[0].innerHTML.match(regex);
                            if(!res){ 
                                IRTasksticketidss.push(row.cells[0].innerHTML);
                            }
                            // if(document.getElementById("[% Data.LineItemID %][% Data.TaskKey | html %]").disabled){
                            //     document.getElementById("[% Data.LineItemID %][% Data.TaskKey | html %]").checked = false; 
                            // } 

                            // Commented code for fixing performance on 27-04-2023
                            // for (var i=0; i < AllChecks.length; i++) {
                            //     if(AllChecks[i].disabled){
                            //         AllChecks[i].checked = false;
                            //     }
                            // }  
                            // Commented code for fixing performance on 27-04-2023                        
                        });
                        var uniqueItems = Array.from(new Set(IRTasksticketidss))
                        document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
                        document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;

                        if(this.checked == false && uniqueItems.length < 1){
                            // var uniqueItems = Array.from(new Set(IRTasksticketidss))
                            document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=;ID="+IRTasksFinalIDs;
                            document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=;ID="+IRTasksFinalIDs;
                        }
                        // Commented code for fixing performance on 27-04-2023
                        // $("#IRTasktable input[type=checkbox]:not(:checked)").each(function () {
                        //     var row = $(this).closest("tr")[0];
                        //     var id = row.cells[0].innerHTML; 
                        //     this.value = 0;
                        //     var ids = IRTasksticketidss.indexOf(id);
                        //     if(ids !== -1){
                        //         const regex = /[a-z]/g;                 
                        //         var res = id.match(regex);
                        //         if(!res){
                        //         delete IRTasksticketidss[ids];
                        //         }
                        //     }
                        //     var uniqueItems = Array.from(new Set(IRTasksticketidss))
                        // document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
                        // document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+IRTasksFinalIDs;
                                                
                        // });
                        // Commented code for fixing performance on 27-04-2023

                });

                // // if all checkbox are selected, check the selectall checkbox
                // // and viceversa
                $(".LintItemTask").click(function(){
                    if($(".LintItemTask").length == $(".LintItemTask:checked").length) {
                        document.getElementById("SOFLineall").checked = true;
                        $("#IRTasktableselectall").attr("checked", "checked");
                    } else {
                        $("#LintItemTask").removeAttr("checked");
                        document.getElementById("IRTasktableselectall").checked = false;
                    }
                });
            });  
        </script>

        <script type="text/javascript">
                var table, i, x, y, state, hidelast,LintItemTaskFinalID;

                var AllLinticketids=[];

                 var rows = $('#IRTasktable > tbody').children('tr').get(); // creates a JS array of DOM elements
                    rows.sort(function(a, b) {  // use a custom sort function
                        var anum = parseInt($(a).find(".Taskseq").text(), 10);
                        var bnum = parseInt($(b).find(".Taskseq").text(), 10);
                        return anum-bnum;
                    });
                    for (var i = 0; i < rows.length; i++) {  // .append() will move them for you
                        $('#IRTasktable > tbody').append(rows[i]);
                    } 

                 var rows = $('#IRTasktable > tbody').children('tr').get(); // creates a JS array of DOM elements
                    rows.sort(function(a, b) {  // use a custom sort function
                        var anum = parseInt($(a).find(".linesort").text(), 10);
                        var bnum = parseInt($(b).find(".linesort").text(), 10);
                         AllLinticketids.push(anum);
                        return anum-bnum;
                    });
                    for (var i = 0; i < rows.length; i++) {  // .append() will move them for you
                        $('#IRTasktable > tbody').append(rows[i]);
                    }

                    const uniLineitem = Array.from(new Set(AllLinticketids)) 
                 
                // table = document.getElementById("IRTasktable"); 
                // var switching = true; 
                // while (switching) { 
                //     switching = false; 
                //     var rows = table.rows; 
                //     var sub = rows[1].getElementsByTagName("TD")[0];
                //     if(sub){
                //         $('#hide[% Data.tabid %]').show();
                           
                //     }else{
                //          $('#hide[% Data.tabid %]').hide();
                //     }
                //     for (i = 1; i < (rows.length - 1); i++) { 
                //         var Switch = false; 
                //         x = rows[i].getElementsByTagName("TD")[3]; 
                //         y = rows[i + 1].getElementsByTagName("TD")[3];

                //         state = rows[i].getElementsByTagName("TD")[10];

                //         var tate = rows[i].getElementsByTagName("TD")[11];
                //          LintItemTaskFinalID = tate.innerHTML;

                //         if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                //             { 
                //             Switch = true; 
                //             break; 
                //         } 
                //     } 
                //     if (Switch) { 
                //         rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                //         switching = true; 
                //     } 
                // }

                //                 var table, i, x, y; 
                 
                // table = document.getElementById("IRTasktable"); 
                // var switching = true; 
                // while (switching) { 
                //     switching = false; 
                //     var rows = table.rows; 
                //     var sub = rows[1].getElementsByTagName("TD")[0];
                //     if(sub){
                //         $('#hide[% Data.tabid %]').show();
                           
                //     }else{
                //          $('#hide[% Data.tabid %]').hide();
                //     }
                //     for (i = 1; i < (rows.length - 1); i++) { 
                //         var Switch = false; 
                //         x = rows[i].getElementsByTagName("TD")[6]; 
                //         y = rows[i + 1].getElementsByTagName("TD")[6];
                //         if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                //             { 
                //             Switch = true; 
                //             break; 
                //         } 
                //     } 
                //     if (Switch) { 
                        
                //         rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                //         switching = true; 
                //     } 
                // }
                // function reply_click(clicked_id){}
               // SR2022112305000011
               LintItemTaskFinalID = "[% Data.TicketID %]";
               // SR2022112305000011

               table = document.getElementById("IRTasktable"); 
                var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    for (s = 0; s < uniLineitem.length; s++) {
                                // SR2022112305000011
                            for (i = 1; i <= (rows.length - 1); i++) { 
                                // SR2022112305000011

                                var Linedatalist = rows[i].getElementsByTagName("TD")[14];
                                // SR2022112305000011
                                var LinedataPrv;
                                if(typeof(rows[i+1]) != 'undefined'){
                                    LinedataPrv = rows[i+1].getElementsByTagName("TD")[14];
                                }
                                var tate = rows[i].getElementsByTagName("TD")[12];
                                state = rows[i].getElementsByTagName("TD")[11];
                               // LintItemTaskFinalID = tate.innerHTML;
                               // SR2022112305000011
                                if (uniLineitem[s] == Linedatalist.innerHTML) {
                                        x = rows[i].getElementsByTagName("TD")[3]; 
                                        if(typeof(rows[i+1]) != 'undefined'){
                                            y = rows[i + 1].getElementsByTagName("TD")[3];
                                        }
                                        state = rows[i].getElementsByTagName("TD")[11];
                                        var desc;
                                        if(typeof(rows[i+1]) != 'undefined'){
                                            desc = rows[i+1].getElementsByTagName("TD")[5];
                                            if (desc.innerHTML == "Update CI" || desc.innerHTML == "Audit Task") {
                                                if(state.innerHTML != " Resolved" ){
                                                if(state.innerHTML != " Cancelled" ){
                                                    if(state.innerHTML != " Closed" ){
                                                         if (Linedatalist.innerHTML == LinedataPrv.innerHTML) {
                                                            var hidefir = rows[i+1].getElementsByTagName("TD")[13];
                                                            document.getElementById(hidefir.innerHTML).disabled = true;
                                                         } 
                                                    }
                                                }
                                            }
                                        }
                                // SR2022112305000011
                                       
                                        // if(state.innerHTML == " Resolved" || state.innerHTML == " Cancelled" || state.innerHTML == " Closed"){
                                        //     var tablength = rows.length - 1;
                                        //     var tablengthpre = rows.length - 2;
                                        //      var laststate  = rows[tablengthpre].getElementsByTagName("TD")[10]
                                        //     if( laststate.innerHTML == " Resolved" || laststate.innerHTML == " Cancelled" || laststate.innerHTML == " Closed"){
                                        //         var hidefir = rows[tablength].getElementsByTagName("TD")[12];
                                        //         document.getElementById(hidefir.innerHTML).disabled = false;
                                        //         break;
                                        //     }
                                        //     else{
                                        //         var hidefir = rows[tablength].getElementsByTagName("TD")[12];
                                        //         document.getElementById(hidefir.innerHTML).disabled = true;
                                        //     }
                                            
                                        // }
                                        } 
                                    } 

                                // SR2022112305000011
                                if(state.innerHTML == " Resolved"){
                                    // console.log('shree'+state.innerHTML+i);

                                    var hidefirf = rows[i].getElementsByTagName("TD")[13];
                                    document.getElementById(hidefirf.innerHTML).disabled = true;
                                }
                                // SR2022112305000011
                            }
                    } 



                
            
            
                        $("td").on("click", x, function(){
                            var ticketids=[];
                                
                               $("#IRTasktable input[type=checkbox]:checked").each(function () {
                                    var row = $(this).closest("tr")[0];
                                     var id = row.cells[0].innerHTML;  
                                     // var FinalID = row.cells[11].innerHTML;
                                     
                                     this.value = this.checked ? id : 0;
                                      const regex = /[a-z]/g;                 
                                        var res = id.match(regex);
                                        if(!res){
                    
                                         ticketids.push(id);
                                        }
                                     var uniqueItems = Array.from(new Set(ticketids))
                                     
                                     document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+LintItemTaskFinalID;
                                      document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+LintItemTaskFinalID;
                                      
                                });
                                $("#IRTasktable input[type=checkbox]:not(:checked)").each(function () {
                                    var row = $(this).closest("tr")[0];
                                     var id = row.cells[0].innerHTML; 
                                      // var FinalID = row.cells[11].innerHTML; 
                                       this.value = 0;
                                     
                                      var ids = ticketids.indexOf(id);
                                      // delete ticketids[ids];
                                     if(ids !== -1){
                                        

                                        delete ticketids[ids];
                                      }            

                                    var uniqueItems = Array.from(new Set(ticketids))

                                   
                                     document.getElementById("BulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+LintItemTaskFinalID;
                                      document.getElementById("BulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+LintItemTaskFinalID;
                                    
                                });

                            }).change();

          </script>

          <div class="WidgetSimple IRTasksTask tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Tasks Details") | html %]</h2>
                </div> 

                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="IRTasktable1" >
                        <thead>
                            <tr>
                                <th col-index = 2>[% Translate("Tasks") | html %]</th>
                                <th col-index = 3>[% Translate("Task Sequence") | html %]</th>
                                <th col-index = 4>[% Translate("Product Model") | html %] <select class="table-filter" onchange="filter_rowsIRTasktable1()"><option value="all">Select All</option></select></th>
                                <th col-index = 5>[% Translate("Task Description") | html %] <select class="table-filter" onchange="filter_rowsIRTasktable1()"><option value="all">Select All</option></select></th>
                                <th col-index = 6>[% Translate("IR") | html %]</th>
                                <th col-index = 7>[% Translate("Line Item") | html %]</th>
                                <th col-index = 8>[% Translate("SOF NO") | html %]</th>
                                <th col-index = 9>[% Translate("Assign Team") | html %] <select class="table-filter" onchange="filter_rowsIRTasktable1()"><option value="all">Select All</option></select></th>
                                <th col-index = 10>[% Translate("Assign To") | html %] <select class="table-filter" onchange="filter_rowsIRTasktable1()"><option value="all">Select All</option></select></th>
                                <th col-index = 11>[% Translate("Task Status") | html %] <select class="table-filter" onchange="filter_rowsIRTasktable1()"><option value="all">Select All</option></select></th>                           
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('TaskDetailsTask') %]
                            [% IF Data.DynamicField_SCFType  %]
                            [% IF Data.TaskNumber %]
                             <td style="display: none;">[% Data.TaskKey | html %]</td>
                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %]">[% Data.TaskNumber %]</a></td>
                              <td style="background-color: #cececefc; "  class="Taskseq">[% Data.Sequence %]</td>
                              <td style="background-color: #cececefc; "  class="Taskseq">[% Data.part_name %]</td>
                              <td style="background-color: #cececefc;">[% Data.Description %]</td>
                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketId | uri %]">[% Data.IRNumber %]</a></td>
                              <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %]">[% Data.LineItemNumber1 %]</a></td>
                            <td style="background-color: #cececefc;"><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.FinalID | uri %]">[% Data.DynamicField_SOFNumber %]</a></td>
                              <td style="background-color: #cececefc;">[% Data.AsignedTeam %]</td>
                              <td style="background-color: #cececefc;">[% Data.AsignedTo %]</td>
                            <td style="background-color: #cececefc;"> [% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.FinalID | html %]</td>
                            <td style="display: none;">[% Data.LineItemID %][% Data.TaskKey | html %]</td>
                            <td style="display: none;"  class="linesort">[% Data.LineItemNumber1 %]</td>
                            [% END %]
                            [% ELSE %]
                             [% IF Data.TaskNumber %]
                              <td style="display: none;">[% Data.TaskKey | html %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %]">[% Data.TaskNumber %]</a></td>
                              <td class="Taskseq">[% Data.Sequence %]</td>
                              <td>[% Data.part_name %]</td>
                              <td>[% Data.Description %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketId | uri %]">[% Data.IRNumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %]">[% Data.LineItemNumber1 %]</a></td>
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.FinalID | uri %]">[% Data.DynamicField_SOFNumber %]</a></td>
                            <td>[% Data.AsignedTeam %]</td>
                            <td>[% Data.AsignedTo %]</td>
                            <td> [% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.FinalID | html %]</td>
                            <td style="display: none;">[% Data.LineItemID %][% Data.TaskKey | html %]</td>
                            <td style="display: none;" class="linesort">[% Data.LineItemNumber1 %]</a></td>
                            [% END %]
                            [% END %]
                            </tr>
                           <!-- <td> [% Data.DynamicField_SOFNumber  %]</td> -->                  
                            [% RenderBlockEnd('TaskDetailsTask') %]
                    </tbody>
                </table>            
            </div>
        </div>
    </div>       

        <script type="text/javascript">
                 var table, i, x, y, state, hidelast,LintItemTaskFinalID;
                 var AllLinticketids=[];

                 var rows = $('#IRTasktable1 > tbody').children('tr').get(); // creates a JS array of DOM elements
                    rows.sort(function(a, b) {  // use a custom sort function
                        var anum = parseInt($(a).find(".Taskseq").text(), 10);
                        var bnum = parseInt($(b).find(".Taskseq").text(), 10);
                        return anum-bnum;
                    });
                    for (var i = 0; i < rows.length; i++) {  // .append() will move them for you
                        $('#IRTasktable1 > tbody').append(rows[i]);
                    } 

                 var rows = $('#IRTasktable1 > tbody').children('tr').get(); // creates a JS array of DOM elements
                    rows.sort(function(a, b) {  // use a custom sort function
                        var anum = parseInt($(a).find(".linesort").text(), 10);
                        var bnum = parseInt($(b).find(".linesort").text(), 10);
                         AllLinticketids.push(anum);
                        return anum-bnum;
                    });
                    for (var i = 0; i < rows.length; i++) {  // .append() will move them for you
                        $('#IRTasktable1 > tbody').append(rows[i]);
                    }



                 getUniqueValuesFromColumnIRTasktable1()
                 table = document.getElementById("IRTasktable1"); 
        </script>

        <div class="WidgetSimple MRQ tab-content" >
            <div class="WidgetSimple">            
                <div class="Header">
                    <h2>[% Translate("MRQ Request") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:auto; height:350px;">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("MRQ Request") | html %]</th>
                                <th>[% Translate("MRQ Subject") | html %]</th>
                                <th>[% Translate("Team") | html %]</th>
                                <th>[% Translate("State") | html %]</th>
                                <th>[% Translate("Created on") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Drafted") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('MRQRequest') %]
                             <tr>
                             
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.TN %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.MRQTitle %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.MRQQueue %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.MRQState %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.MRQCreated %]</a></td>
                            <td>[% Data.SOFNumber %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MRQID | uri %];">[% Data.DraftedStatus %]</a></td>
                            
                            <!-- <td>[% Data.PONO %]</td>
                              <td>[% Data.POStatus %]</td>
                               <td></td>
                                <td></td> -->
                            </tr> 
                            [% RenderBlockEnd('MRQRequest') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

        <div class="WidgetSimple MIT tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("MIT Request") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("MIT Req No") | html %]</th>
                                <th>[% Translate("Status") | html %]</th>
                                <th>[% Translate("Issued By") | html %]</th>
                                <th>[% Translate("Issued Date") | html %]</th>
                                <th>[% Translate("SOF Number") | html %]</th>
                                <th>[% Translate("MIN Number") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('MITRequest') %]
                             <tr>
                             
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.MITID | uri %];">[% Data.MITNumber %]</a></td>
                                <td>[% Data.MITStatus %]</td>
                                <td>[% Data.IssuedBy %]</td>
                                <td>[% Data.IssuedDate %]</td>
                                <td>[% Data.DynamicField_SOFNumber %]</td>
                                <td>[% Data.MIT_Number %]</td>
                            </tr> 
                            [% RenderBlockEnd('MITRequest') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

                <div class="WidgetSimple IntegrationDetailsMRQ tab-content">
            <div class="WidgetSimple">
                <div class="Header">
                    <h2>[% Translate("Integration Details") | html %]</h2>
                </div>
                <div class="col-md-6">
                    <div style="margin-top: 2%; margin-bottom: 2%; margin-left: 2%;"><h6>Incoming Payload</h6></div>
                    <div class="Content" style="height: 320px; overflow: scroll;">
                        <table class="DataTable" id="Tasktable">
                            <thead>
                                <tr>
                                    <th>[% Translate("Integration ID") | html %]</th>
                                    <th>[% Translate("Status") | html %]</th>
                                    <th>[% Translate("System") | html %]</th>
                                    <th>[% Translate("Timestamp") | html %]</th>
                                </tr>
                            </thead>
                            <tbody>
                        [% RenderBlockStart('IntigrationDetailsMRQ') %]
                            <tr>
                                <td id="open-popup-modal[% Data.id %]" style="cursor: pointer;">[% Data.idid %]</td>
                                <td>Success</td>
                                <td>SAP</td>
                                <td>[% Data.CREATE_TIME %]</td>
                            </tr> 

                            <!-- Modal -->
                            <!-- <div class="modal fade" id="myModal[% Data.id %]" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog" style="max-width: 1100px !important;">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        </div>
                                        <button class="btn btn-primary" id="btn[% Data.id %]" style="width: 8%; margin-left: 2%; margin-top: 1%" onclick="copyToClipboard[% Data.id %]('SOF_Json[% Data.id %]')">Copy JSON</button> <div id="Copied[% Data.id %]" style="display: none; margin-left: 11%; float: left; margin-top: -2%;"><p>JSON Copied</p></div>

                                        <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white;" id="SOF_Json[% Data.id %]">[% Data.sof_json %]</pre></div>
                                        <div class="modal-footer"> -->
                                            <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                                            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                                        <!-- </div>
                                    </div>
                                </div>
                            </div> -->

                            <div id="popup-modal[% Data.id %]" class="modal">
                            <div class="modal-content animated bounce">
                            <a class="modal-close" id="PopClosed[% Data.id %]"></a>
                            <!-- <div class="modal-img">
                            </div> -->
                            <div class="modal-text">
                                <h2><button class="btn btn-primary" style="cursor: pointer;" id="btn[% Data.id %]" onclick="copyToClipboard[% Data.id %]('SOF_Json[% Data.id %]')">Copy JSON</button></h2><div id="Copied[% Data.id %]" style="display: none;"><p style=" color: black; margin-bottom: 0% !important; font-size: 14px !important; margin-top: -29px !important; margin-left: 8% !important; ">JSON Copied</p></div><br>
                            <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white; font-family: monospace,ui-monospace !important; font-size: 1.1em;"> <xmp id="SOF_Json[% Data.id %]">[% Data.MRQ_JSON %]</xmp></pre></div>
                            </div>
                            <!-- <div class="modal-footer"> -->
                            </div>
                            </div>

                            <script type="text/javascript">
                                // $(document).ready(function () {      
                                //     $("#myBtn[% Data.id %]").click(function(){
                                //          $("#myModal[% Data.id %]").modal('show');
                                //     });
                                // });

                                // var modal = document.getElementById("popup-modal[% Data.id %]");
                                // var btn = document.getElementById("open-popup-modal[% Data.id %]");
                                // var span = document.getElementById("PopClosed[% Data.id %]");
                                document.getElementById("open-popup-modal[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modal[% Data.id %]").style.display = "block";
                                }
                                document.getElementById("PopClosed[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modal[% Data.id %]").style.display = "none";
                                }
                                // window.onload = function() {
                                //     setTimeout(function() {
                                //         modal.style.display = 'block';
                                //     }, 3000);
                                // }
                                // window.onclick = function(event) {
                                //     if (event.target == modal) {
                                //         modal.style.display = "none";
                                //     }
                                // }

                                function copyToClipboard[% Data.id %](elementId) {

                                  // Prevent copying of grapper tag
                                  let Grapper = document.getElementsByClassName('open_grepper_editor');

                                  if(Grapper){
                                    for(var i = 0; i < Grapper.length; i++)
                                      {
                                        Grapper[i].remove();
                                      }
                                  }

                                  // Create a "hidden" input
                                  var aux = document.createElement("input");

                                  // Assign it the value of the specified element
                                  aux.setAttribute("value", document.getElementById(elementId).innerHTML);

                                  // Append it to the body
                                  document.getElementById(elementId).appendChild(aux);

                                  // Highlight its content
                                  aux.select();

                                  // Copy the highlighted text
                                  document.execCommand("copy");

                                  // Remove it from the body
                                  document.getElementById(elementId).removeChild(aux);
                                }

                                $("#btn[% Data.id %]").on({
                                  "click": function() {
                                    $("#Copied[% Data.id %]").show();
                                    // alert('hi');
                                    setTimeout(function() {
                                        $("#Copied[% Data.id %]").hide(); 
                                    }, 300);
                                  },
                                  "mouseout": function() {      
                                     // $("#Copied[% Data.id %]").hide();  
                                    // alert('hi out');

                                    setTimeout(function() {
                                        $("#Copied[% Data.id %]").hide(); 
                                    }, 300);
                                  }
                                });
                            </script>
                        [% RenderBlockEnd('IntigrationDetailsMRQ') %]
                        [% RenderBlockStart('IntigrationDetailsNoDataMRQ') %]
                            <tr>
                                <td colspan="4">No data found</td>
                            </tr> 
                        [% RenderBlockEnd('IntigrationDetailsNoDataMRQ') %]
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    <div style="margin-top: 2%; margin-bottom: 2%; margin-left: 2%;"><h6>Outgoing Payload</h6></div>
                    <div class="table-responsive" style="height: 320px; overflow: scroll;">
                        <table class="DataTable" id="Tasktable">
                            <thead>
                                <tr>
                                    <th>[% Translate("Integration ID") | html %]</th>
                                    <th>[% Translate("Integration Doc ID") | html %]</th>
                                    <th>[% Translate("Status") | html %]</th>
                                    <th>[% Translate("System") | html %]</th>
                                    <th>[% Translate("Timestamp") | html %]</th>
                                    <th>[% Translate("Repush the JSON") | html %]</th>
                                </tr>
                            </thead>
                            <tbody>
                        [% RenderBlockStart('IntigrationDetailstussomMRQ') %]
                            <tr>
                                <td id="open-popup-modalT[% Data.id %]" style="cursor: pointer;">[% Data.id %]</td>
                                <td id="open-popup-modalTdoc[% Data.doc_id %]" style="cursor: pointer;">[% Data.doc_id %]</td>
                                <td>Success</td>
                                <td>tussom</td>
                                <td>[% Data.create_time %]</td>
                                <td><a href="[% Env("Baselink") %]Action=AgentMRQPayloadRepush;IntigrationID=[% Data.id %];TicketID=[% Data.TicketID %]">Re-push</a></td>
                            </tr> 

                            <!-- Modal -->
                            <!-- <div class="modal fade" id="myModalt[% Data.id %]" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog" style="max-width: 1100px !important;">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        </div>

                                        <button class="btn btn-primary" id="btnT[% Data.id %]" style="width: 8%; margin-left: 2%; margin-top: 1%" onclick="copyToClipboardT[% Data.id %]('SOF_JsonT[% Data.id %]')">Copy JSON</button> <div id="CopiedT[% Data.id %]" style="display: none; margin-left: 11%; float: left; margin-top: -2%;"><p>JSON Copied</p></div>

                                        <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white;" id="SOF_JsonT[% Data.id %]">[% Data.json %]</pre></div>
                                        <div class="modal-footer"> -->
                                            <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                                            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                                       <!--  </div>
                                    </div>
                                </div>
                            </div> -->

                            <div id="popup-modalT[% Data.id %]" class="modal">
                            <div class="modal-content animated bounce">
                            <a class="modal-close" id="PopCloseT[% Data.id %]"></a>
                            <!-- <div class="modal-img">
                            </div> -->
                            <div class="modal-text">
                                <h2><button class="btn btn-primary" style="cursor: pointer;" id="btnT[% Data.id %]" onclick="copyToClipboardT[% Data.id %]('SOF_JsonT[% Data.id %]')">Copy JSON</button></h2><div id="CopiedT[% Data.id %]" style="display: none;"><p style=" color: black; margin-bottom: 0% !important; font-size: 14px !important; margin-top: -29px !important; margin-left: 8% !important; ">JSON Copied</p></div><br>
                            <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white; font-family: monospace,ui-monospace !important; font-size: 1.1em;" id="SOF_JsonT[% Data.id %]">[% Data.json %]</pre></div>
                            </div>
                            <!-- <div class="modal-footer"> -->
                            </div>
                            </div>

                            <script type="text/javascript">
                                // $(document).ready(function () {      
                                //     $("#myBtnT[% Data.id %]").click(function(){
                                //          $("#myModalT[% Data.id %]").modal('show');
                                //     });
                                // });

                                // var modalT[% Data.id %] = document.getElementById("popup-modalT[% Data.id %]");
                                // var btnT[% Data.id %] = document.getElementById("open-popup-modalT[% Data.id %]");
                                // var spanT[% Data.id %] = document.getElementById("PopCloseT[% Data.id %]");
                                document.getElementById("open-popup-modalT[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modalT[% Data.id %]").style.display = "block";
                                }
                                document.getElementById("PopCloseT[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modalT[% Data.id %]").style.display = "none";
                                }
                                // window.onload = function() {
                                //     setTimeout(function() {
                                //         modalT.style.display = 'block';
                                //     }, 3000);
                                // }
                                // window.onclick = function(event) {
                                //     if (event.target == document.getElementById("popup-modalT[% Data.id %]")) {
                                //         document.getElementById("popup-modalT[% Data.id %]").style.display = "none";
                                //     }
                                //     alert(event.target.id+' = '+document.getElementById("popup-modalT[% Data.id %]").id);
                                //     if (event.target == modal) {
                                //         modal.style.display = "none";
                                //     }
                                // }

                                function copyToClipboardT[% Data.id %](elementId) {

                                  // Prevent copying of grapper tag
                                  let GrapperT = document.getElementsByClassName('open_grepper_editor');
                                  
                                  if(GrapperT){
                                    for(var i = 0; i < GrapperT.length; i++)
                                      {
                                        GrapperT[i].remove();
                                      }
                                  }

                                  // Create a "hidden" input
                                  var aux = document.createElement("input");

                                  // Assign it the value of the specified element
                                  aux.setAttribute("value", document.getElementById(elementId).innerHTML);

                                  // Append it to the body
                                  document.getElementById(elementId).appendChild(aux);

                                  // Highlight its content
                                  aux.select();

                                  // Copy the highlighted text
                                  document.execCommand("copy");

                                  // Remove it from the body
                                  document.getElementById(elementId).removeChild(aux);
                                }

                                $("#btnT[% Data.id %]").on({
                                  "click": function() {
                                    $("#CopiedT[% Data.id %]").show();
                                    // alert('hi');
                                    setTimeout(function() {
                                        $("#CopiedT[% Data.id %]").hide(); 
                                    }, 300);
                                  },
                                  "mouseout": function() {      
                                     // $("#Copied[% Data.id %]").hide();  
                                    // alert('hi out');

                                    setTimeout(function() {
                                        $("#CopiedT[% Data.id %]").hide(); 
                                    }, 300);
                                  }
                                });
                            </script>

                            <div id="popup-modalTdoc[% Data.doc_id %]" class="modal">
                            <div class="modal-content animated bounce">
                            <a class="modal-close" id="PopCloseTdoc[% Data.doc_id %]"></a>
                            <!-- <div class="modal-img">
                            </div> -->
                            <div class="modal-text">
                                <h2><button class="btn btn-primary" style="cursor: pointer;" id="btnTdoc[% Data.doc_id %]" onclick="copyToClipboardTdoc[% Data.doc_id %]('SOF_JsonTdoc[% Data.doc_id %]')">Copy JSON</button></h2><div id="CopiedTdoc[% Data.doc_id %]" style="display: none;"><p style=" color: black; margin-bottom: 0% !important; font-size: 14px !important; margin-top: -29px !important; margin-left: 8% !important; ">JSON Copied</p></div><br>
                            <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white; font-family: monospace,ui-monospace !important; font-size: 1.1em;" id="SOF_JsonTdoc[% Data.doc_id %]">[% Data.doc_json %]</pre></div>
                            </div>
                            <!-- <div class="modal-footer"> -->
                            </div>
                            </div>

                            <script type="text/javascript">
                                // $(document).ready(function () {      
                                //     $("#myBtnT[% Data.id %]").click(function(){
                                //          $("#myModalT[% Data.id %]").modal('show');
                                //     });
                                // });

                                // var modalT[% Data.id %] = document.getElementById("popup-modalT[% Data.id %]");
                                // var btnT[% Data.id %] = document.getElementById("open-popup-modalT[% Data.id %]");
                                // var spanT[% Data.id %] = document.getElementById("PopCloseT[% Data.id %]");
                                document.getElementById("open-popup-modalTdoc[% Data.doc_id %]").onclick = function() {
                                    document.getElementById("popup-modalTdoc[% Data.doc_id %]").style.display = "block";
                                }
                                document.getElementById("PopCloseTdoc[% Data.doc_id %]").onclick = function() {
                                    document.getElementById("popup-modalTdoc[% Data.doc_id %]").style.display = "none";
                                }
                                // window.onload = function() {
                                //     setTimeout(function() {
                                //         modalT.style.display = 'block';
                                //     }, 3000);
                                // }
                                // window.onclick = function(event) {
                                //     if (event.target == document.getElementById("popup-modalT[% Data.id %]")) {
                                //         document.getElementById("popup-modalT[% Data.id %]").style.display = "none";
                                //     }
                                //     alert(event.target.id+' = '+document.getElementById("popup-modalT[% Data.id %]").id);
                                //     if (event.target == modal) {
                                //         modal.style.display = "none";
                                //     }
                                // }

                                function copyToClipboardTdoc[% Data.doc_id %](elementId) {

                                  // Prevent copying of grapper tag
                                  let GrapperT = document.getElementsByClassName('open_grepper_editor');
                                  
                                  if(GrapperT){
                                    for(var i = 0; i < GrapperT.length; i++)
                                      {
                                        GrapperT[i].remove();
                                      }
                                  }

                                  // Create a "hidden" input
                                  var aux = document.createElement("input");

                                  // Assign it the value of the specified element
                                  aux.setAttribute("value", document.getElementById(elementId).innerHTML);

                                  // Append it to the body
                                  document.getElementById(elementId).appendChild(aux);

                                  // Highlight its content
                                  aux.select();

                                  // Copy the highlighted text
                                  document.execCommand("copy");

                                  // Remove it from the body
                                  document.getElementById(elementId).removeChild(aux);
                                }

                                $("#btnTdoc[% Data.doc_id %]").on({
                                  "click": function() {
                                    $("#CopiedTdoc[% Data.doc_id %]").show();
                                    // alert('hi');
                                    setTimeout(function() {
                                        $("#CopiedTdoc[% Data.doc_id %]").hide(); 
                                    }, 300);
                                  },
                                  "mouseout": function() {      
                                     // $("#Copied[% Data.id %]").hide();  
                                    // alert('hi out');

                                    setTimeout(function() {
                                        $("#CopiedTdoc[% Data.doc_id %]").hide(); 
                                    }, 300);
                                  }
                                });
                            </script>
                        [% RenderBlockEnd('IntigrationDetailstussomMRQ') %]
                        [% RenderBlockStart('IntigrationDetailstussomNoDataMRQ') %]
                            <tr>
                                <td colspan="5">No data found</td>
                            </tr> 
                        [% RenderBlockEnd('IntigrationDetailstussomNoDataMRQ') %]
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="WidgetSimple IntegrationDetails tab-content">
            <div class="WidgetSimple">
                <div class="Header">
                    <h2>[% Translate("Integration Details") | html %]</h2>
                </div>
                <div class="col-md-6">
                    <div style="margin-top: 2%; margin-bottom: 2%; margin-left: 2%;"><h6>Incoming Payload</h6></div>
                    <div class="Content" style="height: 320px; overflow: scroll;">
                        <table class="DataTable" id="Tasktable">
                            <thead>
                                <tr>
                                    <th>[% Translate("Integration ID") | html %]</th>
                                    <th>[% Translate("Status") | html %]</th>
                                    <th>[% Translate("System") | html %]</th>
                                    <th>[% Translate("Timestamp") | html %]</th>
                                </tr>
                            </thead>
                            <tbody>
                        [% RenderBlockStart('IntigrationDetails') %]
                            <tr>
                                <td id="open-popup-modal[% Data.id %]" style="cursor: pointer;">[% Data.id %]</td>
                                <td>[% IF Data.processed == 'Yes' %] Success [% ELSE %] Pending [% END %]</td>
                                <td>Salesforce</td>
                                <td>[% Data.create_time %]</td>
                            </tr> 

                            <!-- Modal -->
                            <!-- <div class="modal fade" id="myModal[% Data.id %]" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog" style="max-width: 1100px !important;">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        </div>
                                        <button class="btn btn-primary" id="btn[% Data.id %]" style="width: 8%; margin-left: 2%; margin-top: 1%" onclick="copyToClipboard[% Data.id %]('SOF_Json[% Data.id %]')">Copy JSON</button> <div id="Copied[% Data.id %]" style="display: none; margin-left: 11%; float: left; margin-top: -2%;"><p>JSON Copied</p></div>

                                        <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white;" id="SOF_Json[% Data.id %]">[% Data.sof_json %]</pre></div>
                                        <div class="modal-footer"> -->
                                            <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                                            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                                        <!-- </div>
                                    </div>
                                </div>
                            </div> -->

                            <div id="popup-modal[% Data.id %]" class="modal">
                            <div class="modal-content animated bounce">
                            <a class="modal-close" id="PopClosed[% Data.id %]"></a>
                            <!-- <div class="modal-img">
                            </div> -->
                            <div class="modal-text">
                                <h2><button class="btn btn-primary" style="cursor: pointer;" id="btn[% Data.id %]" onclick="copyToClipboard[% Data.id %]('SOF_Json[% Data.id %]')">Copy JSON</button></h2><div id="Copied[% Data.id %]" style="display: none;"><p style=" color: black; margin-bottom: 0% !important; font-size: 14px !important; margin-top: -29px !important; margin-left: 8% !important; ">JSON Copied</p></div><br>
                            <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white; font-family: monospace,ui-monospace !important; font-size: 1.1em;"><xmp id="SOF_Json[% Data.id %]">[% Data.sof_json %]</xmp></pre></div>
                            </div>
                            <!-- <div class="modal-footer"> -->
                            </div>
                            </div>

                            <script type="text/javascript">
                                // $(document).ready(function () {      
                                //     $("#myBtn[% Data.id %]").click(function(){
                                //          $("#myModal[% Data.id %]").modal('show');
                                //     });
                                // });

                               

                                // var modal = document.getElementById("popup-modal[% Data.id %]");
                                // var btn = document.getElementById("open-popup-modal[% Data.id %]");
                                // var span = document.getElementById("PopClosed[% Data.id %]");
                                document.getElementById("open-popup-modal[% Data.id %]").onclick = function() {
                                      $.ajax({
                url: "[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=IntegrationLogAjax;TicketID=[% Data.TicketID %];JSON_ID=[% Data.id %]",
                method: "POST",
                dataType: 'html',
                success: function(response) {
                   /* for(var x in response){
                        console.log("AjaxCalled",response{x});
                    }*/
                 console.log("AjaxCalled",response);
                 $('#SOF_Json'+[% Data.id %]).text(response);
                }
            });
                                    document.getElementById("popup-modal[% Data.id %]").style.display = "block";
                                }
                                document.getElementById("PopClosed[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modal[% Data.id %]").style.display = "none";
                                }
                                // window.onload = function() {
                                //     setTimeout(function() {
                                //         modal.style.display = 'block';
                                //     }, 3000);
                                // }
                                // window.onclick = function(event) {
                                //     if (event.target == modal) {
                                //         modal.style.display = "none";
                                //     }
                                // }

                                function copyToClipboard[% Data.id %](elementId) {

                                  // Prevent copying of grapper tag
                                  let Grapper = document.getElementsByClassName('open_grepper_editor');

                                  if(Grapper){
                                    for(var i = 0; i < Grapper.length; i++)
                                      {
                                        Grapper[i].remove();
                                      }
                                  }

                                  // Create a "hidden" input
                                  var aux = document.createElement("input");

                                  // Assign it the value of the specified element
                                  aux.setAttribute("value", document.getElementById(elementId).innerHTML);

                                  // Append it to the body
                                  document.getElementById(elementId).appendChild(aux);

                                  // Highlight its content
                                  aux.select();

                                  // Copy the highlighted text
                                  document.execCommand("copy");

                                  // Remove it from the body
                                  document.getElementById(elementId).removeChild(aux);
                                }

                                $("#btn[% Data.id %]").on({
                                  "click": function() {
                                    $("#Copied[% Data.id %]").show();
                                    // alert('hi');
                                    setTimeout(function() {
                                        $("#Copied[% Data.id %]").hide(); 
                                    }, 300);
                                  },
                                  "mouseout": function() {      
                                     // $("#Copied[% Data.id %]").hide();  
                                    // alert('hi out');

                                    setTimeout(function() {
                                        $("#Copied[% Data.id %]").hide(); 
                                    }, 300);
                                  }
                                });
                            </script>
                        [% RenderBlockEnd('IntigrationDetails') %]
                        [% RenderBlockStart('IntigrationDetailsNoData') %]
                            <tr>
                                <td colspan="4">No data found</td>
                            </tr> 
                        [% RenderBlockEnd('IntigrationDetailsNoData') %]
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-6">
                    <div style="margin-top: 2%; margin-bottom: 2%; margin-left: 2%;"><h6>Outgoing Payload</h6></div>
                    <div class="table-responsive" style="height: 320px; overflow: scroll;">
                        <table class="DataTable" id="Tasktable">
                            <thead>
                                <tr>
                                    <th>[% Translate("Integration ID") | html %]</th>
                                    <th>[% Translate("Status") | html %]</th>
                                    <th>[% Translate("System") | html %]</th>
                                    <th>[% Translate("Timestamp") | html %]</th>
                                    <th>[% Translate("Repush the JSON") | html %]</th>
                                </tr>
                            </thead>
                            <tbody>
                        [% RenderBlockStart('IntigrationDetailstussom') %]
                            <tr>
                                <td id="open-popup-modalT[% Data.id %]" style="cursor: pointer;">[% Data.id %]</td>
                                <td>Success</td>
                                <td>tussom</td>
                                <td>[% Data.create_time %]</td>
                                <td><a href="[% Env("Baselink") %]Action=AgentSOFPayloadRepush;IntigrationID=[% Data.id %]">Re-push</a></td>
                            </tr> 

                            <!-- Modal -->
                            <!-- <div class="modal fade" id="myModalt[% Data.id %]" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog" style="max-width: 1100px !important;">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        </div>

                                        <button class="btn btn-primary" id="btnT[% Data.id %]" style="width: 8%; margin-left: 2%; margin-top: 1%" onclick="copyToClipboardT[% Data.id %]('SOF_JsonT[% Data.id %]')">Copy JSON</button> <div id="CopiedT[% Data.id %]" style="display: none; margin-left: 11%; float: left; margin-top: -2%;"><p>JSON Copied</p></div>

                                        <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white;" id="SOF_JsonT[% Data.id %]">[% Data.json %]</pre></div>
                                        <div class="modal-footer"> -->
                                            <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                                            <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                                       <!--  </div>
                                    </div>
                                </div>
                            </div> -->

                            <div id="popup-modalT[% Data.id %]" class="modal">
                            <div class="modal-content animated bounce">
                            <a class="modal-close" id="PopCloseT[% Data.id %]"></a>
                            <!-- <div class="modal-img">
                            </div> -->
                            <div class="modal-text">
                                <h2><button class="btn btn-primary" style="cursor: pointer;" id="btnT[% Data.id %]" onclick="copyToClipboardT[% Data.id %]('SOF_JsonT[% Data.id %]')">Copy JSON</button></h2><div id="CopiedT[% Data.id %]" style="display: none;"><p style=" color: black; margin-bottom: 0% !important; font-size: 14px !important; margin-top: -29px !important; margin-left: 8% !important; ">JSON Copied</p></div><br>
                            <div class="modal-body" style="height: 500px; overflow: scroll;"><pre style="background-color: #002244; font-color: white; font-family: monospace,ui-monospace !important; font-size: 1.1em;" id="SOF_JsonT[% Data.id %]">[% Data.json %]</pre></div>
                            </div>
                            <!-- <div class="modal-footer"> -->
                            </div>
                            </div>

                            <script type="text/javascript">
                                // $(document).ready(function () {      
                                //     $("#myBtnT[% Data.id %]").click(function(){
                                //          $("#myModalT[% Data.id %]").modal('show');
                                //     });
                                // });

                                // var modalT[% Data.id %] = document.getElementById("popup-modalT[% Data.id %]");
                                // var btnT[% Data.id %] = document.getElementById("open-popup-modalT[% Data.id %]");
                                // var spanT[% Data.id %] = document.getElementById("PopCloseT[% Data.id %]");
                                document.getElementById("open-popup-modalT[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modalT[% Data.id %]").style.display = "block";
                                }
                                document.getElementById("PopCloseT[% Data.id %]").onclick = function() {
                                    document.getElementById("popup-modalT[% Data.id %]").style.display = "none";
                                }
                                // window.onload = function() {
                                //     setTimeout(function() {
                                //         modalT.style.display = 'block';
                                //     }, 3000);
                                // }
                                // window.onclick = function(event) {
                                //     if (event.target == document.getElementById("popup-modalT[% Data.id %]")) {
                                //         document.getElementById("popup-modalT[% Data.id %]").style.display = "none";
                                //     }
                                //     alert(event.target.id+' = '+document.getElementById("popup-modalT[% Data.id %]").id);
                                //     if (event.target == modal) {
                                //         modal.style.display = "none";
                                //     }
                                // }

                                function copyToClipboardT[% Data.id %](elementId) {

                                  // Prevent copying of grapper tag
                                  let GrapperT = document.getElementsByClassName('open_grepper_editor');
                                  
                                  if(GrapperT){
                                    for(var i = 0; i < GrapperT.length; i++)
                                      {
                                        GrapperT[i].remove();
                                      }
                                  }

                                  // Create a "hidden" input
                                  var aux = document.createElement("input");

                                  // Assign it the value of the specified element
                                  aux.setAttribute("value", document.getElementById(elementId).innerHTML);

                                  // Append it to the body
                                  document.getElementById(elementId).appendChild(aux);

                                  // Highlight its content
                                  aux.select();

                                  // Copy the highlighted text
                                  document.execCommand("copy");

                                  // Remove it from the body
                                  document.getElementById(elementId).removeChild(aux);
                                }

                                $("#btnT[% Data.id %]").on({
                                  "click": function() {
                                    $("#CopiedT[% Data.id %]").show();
                                    // alert('hi');
                                    setTimeout(function() {
                                        $("#CopiedT[% Data.id %]").hide(); 
                                    }, 300);
                                  },
                                  "mouseout": function() {      
                                     // $("#Copied[% Data.id %]").hide();  
                                    // alert('hi out');

                                    setTimeout(function() {
                                        $("#CopiedT[% Data.id %]").hide(); 
                                    }, 300);
                                  }
                                });
                            </script>
                        [% RenderBlockEnd('IntigrationDetailstussom') %]
                        [% RenderBlockStart('IntigrationDetailstussomNoData') %]
                            <tr>
                                <td colspan="5">No data found</td>
                            </tr> 
                        [% RenderBlockEnd('IntigrationDetailstussomNoData') %]
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="WidgetSimple SOFMIT tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Asset/SOF") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("UAN") | html %]</th>
                                <th>[% Translate("Asset Name") | html %]</th>
                                <th>[% Translate("Asset Category") | html %]</th>
                                <th>[% Translate("Asset Type") | html %]</th>
                                <th>[% Translate("Asset Sub Type") | html %]</th>
                                <th>[% Translate("Approval Status") | html %]</th>
                                <th>[% Translate("Asset Status") | html %]</th>
                                <th>[% Translate("SOF Number") | html %]</th>
                                <th>[% Translate("Quantity") | html %]</th>
                                <th>[% Translate("MRQ Req No") | html %]</th>
                                <th>[% Translate("MRQ Line Number") | html %]</th>
                                <th>[% Translate("LINE ITEM No") | html %]</th>
                                <th>[% Translate("LINE ITEM SRNo") | html %]</th>
                                <th>[% Translate("PR Number ") | html %]</th>
                                <th>[% Translate("PR Line Number ") | html %]</th>
                                <th>[% Translate("PR Status") | html %]</th>
                                <th>[% Translate("PO Number ") | html %]</th>
                                <th>[% Translate("PO Line Number") | html %]</th>
                                <th>[% Translate("PO Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('SOFMIT') %]
                             <tr>
                              <td>[% Translate(Data.uan) %]</td>
                              <td><a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Translate(Data.name) | html %]</a></td>
                              <td>[% Translate(Data.assetcategory) %]</td>
                              <td>[% Translate(Data.asset_type) %]</td>
                              <td>[% Translate(Data.asset_sub_type) %]</td>
                              [% IF Data.assetstatus == 'In Stock' && Data.MITStatus == 'Pending' %]
                              <td>Pending for approval</td>
                              [% ELSE %] 
                              <td>Approved</td>
                              [% END %]
                              <td>[% Translate(Data.assetstatus) %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.SOFID | uri %];">[% Data.SOFNumber %]</a></td>
                              <td>[% Translate(Data.Quantity) %]</td>
                              <td>[% Translate(Data.mrq_id) %]</td>
                              <td>[% Translate(Data.unique_mattcade) %]</td>
                              <td>[% Translate(Data.LineNumberSF) %]</td>
                              <td>[% Translate(Data.SOFLineSrNo) %]</td>
                              <td>[% Translate(Data.PR_Number) %]</td>
                              <td>[% Translate(Data.PR_LineNumber) %]</td>
                              <td>[% Translate(Data.PR_STATUS) %]</td>
                              <td>[% Translate(Data.PO_Number) %]</td>
                              <td>[% Translate(Data.PO_LineNumber) %]</td>
                              <td>[% Translate(Data.PO_STATUS) %]</td>
                            </tr> 
                            [% RenderBlockEnd('SOFMIT') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

        <div class="WidgetSimple ProjectMIT tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Asset/Project") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("UAN") | html %]</th>
                                <th>[% Translate("Asset Name") | html %]</th>
                                <th>[% Translate("Asset Category") | html %]</th>
                                <th>[% Translate("Asset Type") | html %]</th>
                                <th>[% Translate("Asset Sub Type") | html %]</th>
                                <th>[% Translate("Approval Status") | html %]</th>
                                <th>[% Translate("Asset Status") | html %]</th>
                                <th>[% Translate("Project") | html %]</th>
                                <th>[% Translate("Quantity") | html %]</th>
                                <th>[% Translate("MRQ Req No") | html %]</th>
                                <th>[% Translate("MRQ Line Number") | html %]</th>
                                <th>[% Translate("PR Number ") | html %]</th>
                                <th>[% Translate("PR Line Number ") | html %]</th>
                                <th>[% Translate("PR Status") | html %]</th>
                                <th>[% Translate("PO Number ") | html %]</th>
                                <th>[% Translate("PO Line Number") | html %]</th>
                                <th>[% Translate("PO Status") | html %]</th>


                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('ProjectMIT') %]
                             <tr>
                              <td>[% Translate(Data.uan) %]</td>
                              <td><a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Translate(Data.name) | html %]</a></td>
                              <td>[% Translate(Data.assetcategory) %]</td>
                              <td>[% Translate(Data.asset_type) %]</td>
                              <td>[% Translate(Data.asset_sub_type) %]</td>
                              [% IF Data.assetstatus == 'In Stock' && Data.MITStatus == 'Pending' %]
                              <td>Pending for approval</td>
                              [% ELSIF Data.MITStatus == 'Approved' %] 
                              <td>Approved</td>
                              [% ELSIF Data.MITStatus == 'Rejected' %] 
                              <td>Rejected</td>
                              [% ELSE %]
                              <td>Approved</td>
                              [% END %]
                              <td>[% Data.assetstatus %]</td>
                              <td>[% Data.PROJECT %]</td>
                              <td>[% Translate(Data.Quantity) %]</td>
                              <td>[% Translate(Data.mrq_id) %]</td>
                              <td>[% Translate(Data.unique_mattcade) %]</td>
                              <td>[% Translate(Data.PR_Number) %]</td>
                              <td>[% Translate(Data.PR_LineNumber) %]</td>
                              <td>[% Translate(Data.PR_STATUS) %]</td>
                              <td>[% Translate(Data.PO_Number) %]</td>
                              <td>[% Translate(Data.PO_LineNumber) %]</td>
                              <td>[% Translate(Data.PO_STATUS) %]</td>
                            </tr> 
                            [% RenderBlockEnd('ProjectMIT') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

          <div class="WidgetSimple MattCode tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("MattCode") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("Matt Code") | html %]</th>
                                <th>[% Translate("Plant") | html %]</th>
                                <th>[% Translate("Line Item") | html %]</th>
                                <th>[% Translate("Line SR.NO.") | html %]</th>
                                <th>[% Translate("MATT Description") | html %]</th>
                                <th>[% Translate("UOM") | html %]</th>
                                <th>[% Translate("Quantity") | html %]</th>
                                <th>[% Translate("Purchasing group") | html %]</th>
                                <th>[% Translate("Delivery Location") | html %]</th>
                                <th>[% Translate("Delivery Date") | html %]</th>
                                <th>[% Translate("Justifiable Remarks") | html %]</th>                                
                                <th>[% Translate("PO NO") | html %]</th>
                                <th>[% Translate("PO Line No.") | html %]</th>
                                <th>[% Translate("PO Status") | html %]</th>
                                <th>[% Translate("PO Remarks") | html %]</th>
                                <th>[% Translate("PR NO") | html %]</th>
                                <th>[% Translate("PR Line No.") | html %]</th>
                                <th>[% Translate("PR Status") | html %]</th>
                                <th>[% Translate("PR Remarks") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('MattCode') %]
                             <tr>
                             <td>[% Data.MattCode | html %]</td>
                                <td>[% Data.DynamicField_SOFBillFrom | html %]</td>

                              <!-- <td>[% Data.Line_Item %]</td> -->
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineID | uri %];">[% Data.LineIDNumber %]</a></td>
                              <td>[% Data.LineSrNo %]</td>
                              <td>[% Data.Descriptions %]</td>
                              <td>[% Data.UOM %]</td>
                              <td>[% Data.Quantity %]</td>
                              <td>[% Data.PurchasingGroup %]</td>
                              <td>[% Data.DeliveryLocation %]</td>
                              <td>[% Data.MRQDeliveryDate %]</td>
                              <td>[% Data.Remarks %]</td>
                              <td>[% Data.po_number | html %]</td>
                              <td>[% Data.po_linenumber %]</td>
                              <td>[% Data.po_status %]</td>
                              <td>[% Data.po_remarks %]</td>
                              <td>[% Data.PR_NUMBER | html %]</td>
                              <td>[% Data.PR_LINENUMBER %]</td>
                              <td>[% Data.PR_STATUS %]</td>
                              <td>[% Data.PR_REMARKS %]</td>
                            </tr> 
                            [% RenderBlockEnd('MattCode') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

         <div class="WidgetSimple Project tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("MattCode") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%;  overflow:scroll; height:350px">
                   <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("MattCode") | html %]</th>
                                <!-- SR2022110805000012 -->
                                <th>[% Translate("Service Header") | html %]</th>
                                <!-- SR2022110805000012 -->
                                <th>[% Translate("Description") | html %]</th>
                                <th>[% Translate("Project") | html %]</th>
                                <th>[% Translate("WBS Name") | html %]</th>
                                <th>[% Translate("Plant") | html %]</th>
                                <th>[% Translate("UOM") | html %]</th>
                                <th>[% Translate("Quantity") | html %]</th>
                                <th>[% Translate("Purchase Group") | html %]</th>
                                <th>[% Translate("Delivary Date") | html %]</th>
                                <th>[% Translate("Short Text") | html %]</th>
                                <th>[% Translate("Justifiable Remarks") | html %]</th>
                                <th>[% Translate("Impact of Bussiness") | html %]</th>
                                <th>[% Translate("Part of AOP") | html %]</th>
                                <th>[% Translate("PO NO") | html %]</th>
                                <th>[% Translate("PO Line NO") | html %]</th>
                                <th>[% Translate("PO Remarks") | html %]</th>
                                <th>[% Translate("PO Status") | html %]</th>
                                <th>[% Translate("PR NO") | html %]</th>
                                <th>[% Translate("PR Line NO") | html %]</th>
                                <th>[% Translate("PR Remarks") | html %]</th>
                                <th>[% Translate("PR Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('Project') %]
                             <tr>
                              <td>[% Data.MattCode | html %]</a></td>
                              <!-- SR2022110805000012 -->
                              <td>[% Data.MRQServiceData | html %]</a></td>
                              <!-- SR2022110805000012 -->
                             <td>[% Data.Descriptions %]</td>
                              <td>[% Data.Project %]</td>
                              <td>[% Data.WBSElement %]</td>
                              <td>[% Data.Plant %]</td>
                              <td>[% Data.UOM %]</td>
                              <td>[% Data.Quantity %]</td>
                              <td>[% Data.PurchasingGroup %]</td>
                              <td>[% Data.MRQDeliveryDate %]</td>
                              <td>[% Data.ShortText %]</td>
                              <td>[% Data.Remarks %]</td>
                              <td>[% Data.IMPACT %]</td>
                              <td>[% Data.AOP %]</td>
                             <td>[% Data.po_number %]</td>
                             <td>[% Data.po_linenumber %]</td>
                             <td>[% Data.po_remarks %]</td>
                             <td>[% Data.po_status %]</td>
                             <td>[% Data.PR_NUMBER %]</td>
                             <td>[% Data.PR_LINENUMBER %]</td>
                             <td>[% Data.PR_REMARKS %]</td>
                             <td>[% Data.PR_STATUS %]</td>
                            </tr> 
                            [% RenderBlockEnd('Project') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        
        
        <div class="WidgetSimple SOFDetails tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("SOF Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable">
                        <thead>
                            <tr>
                                 <th>[% Translate("Impact SOF") | html %]</th>
                                <th>[% Translate("Impact SOF Number") | html %]</th>
                                <th>[% Translate("Location") | html %]</th>
                                <th>[% Translate("Impact SOF Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('DRSCFDetails') %]
                               <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                              <td>[% Data.DynamicField_SOFNumber %]</td>
                              <td>[% Data.DynamicField_Location %]</td>
                              <td>[% Data.State %]</td>
                            </tr> 
                            [% RenderBlockEnd('DRSCFDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        
<div class="WidgetSimple LineItemDetails tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Line Item Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable"  id="SOFLine">
                        <thead>
                            <tr>
                            <th><input type="checkbox" id="SOFLineallSCF" style="cursor: pointer;" /></th>
                            <th>[% Translate("Line Item.") | html %]</th>
                            <th>[% Translate("SOF NO") | html %]</th>
                            <th>[% Translate("Line SR.NO.") | html %]</th>
                            <th>[% Translate("SCF Type") | html %]</th>
                            <th>[% Translate("Original Line Item No.") | html %]</th>
                            <th>[% Translate("Product Family") | html %]</th>
                            <th>[% Translate("Product Model") | html %]</th>
                            <th>[% Translate("Product Description") | html %]</th>
                            <th>[% Translate("Delivery Location") | html %]</th>
                            <th>[% Translate("Delivery Location Address") | html %]</th>
                            <th>[% Translate("Sale Type Tag") | html %]</th>
                            <th>[% Translate("Bill To") | html %]</th>
                            <th>[% Translate("Support To") | html %]</th>
                            <th>[% Translate("Bill Start Date") | html %]</th>
                            <th>[% Translate("Bill End Date") | html %]</th>
                            <th>[% Translate("Technical Start Date") | html %]</th>
                            <th>[% Translate("Technical End Date") | html %]</th>
                            <th>[% Translate("Cancellation Date") | html %]</th>
                            <th>[% Translate("Is Online") | html %]</th>
                            <th>[% Translate("Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>     <tr>                      
                            [% RenderBlockStart('SCFLineDetails') %]</tr> 
                                <td style="display: none;">[% Data.TicketID | html %]</td>
                                <td>
                                    [% IF Data.State == "Amendment in progress" %]
                                        <input onClick="reply_click(this.id)" style="cursor: pointer;" type="checkbox" name="certified[]1" class="SOFLintItemTask11" id ="[% Data.DynamicField_LineNumber11 %]" value="[% Data.TicketID | html %]" disabled="disabled" />
                                    [% ELSE %]
                                        <input onClick="reply_click(this.id)" style="cursor: pointer;" type="checkbox" name="certified[]" class="SOFLintItemTask" id ="[% Data.DynamicField_LineNumber %]" value="[% Data.TicketID | html %]" />
                                    [% END %]
                                </td>
                                <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>
                                <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.SOFTicketID | uri %];">[% Data.DynamicField_SOFNumber %]</a></td>
                                <td> [% Data.DynamicField_SOFLineSrNo %]</td>
                                <td> [% Data.DynamicField_SCFType %]</td>
                                <td> [% Data.DynamicField_OldLineNumber %]</td>
                                <td> [% Data.DynamicField_SOFProductFamily %]</td>
                                <td> [% Data.DynamicField_SOFProductModel %]</td>
                                <td> [% Data.DynamicField_ProductDescription %]</td>
                                <td> [% Data.DynamicField_DeliveryLocation %]</td>
                                <td> [% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                                <td> [% Data.DynamicField_SOFSaleTypeTag %]</td>
                                <td> [% Data.BillTo  %]</td>
                                <td> [% Data.SupportTo %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                                <td>[% Data.State %]</td>
                                <td style="display: none;">[% Data.TicketID | html %]</td>

<script type="text/javascript">
     $(function(){
     var LineFinalIDs = "[% Data.SCFTicketID %]";
    var Lineticketidss=[];

    // add multiple select / deselect functionality
    $("#SOFLineallSCF").click(function () {
           $('.SOFLintItemTask').attr('checked', this.checked);
           if("Data.DynamicField_LineNumber"){
                 document.getElementById("[% Translate(Data.DynamicField_LineNumber) | html %]").checked = this.checked;
           }
           

           $("#SOFLine input[type=checkbox]:checked").each(function () {
                var row = $(this).closest("tr")[0];
                var id = row.cells[0].innerHTML;  
                // var FinalID = 10; 
                const regex = /[a-z]/g;                 
                var res = id.match(regex);
                if(!res){
                    
                    Lineticketidss.push(id);
                }
                // Lineticketidss.push(id);
                // this.value = this.checked ? id : 0;

                // var uniqueItems = Array.from(new Set(Lineticketidss))
                // document.getElementById("SOFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;TicketID=" + uniqueItems+";ID="+LineFinalIDs;
                                         
            });
           var uniqueItems = Array.from(new Set(Lineticketidss))
                document.getElementById("SOFBulkDataSCF").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;SCFImactedLine=Yes;TicketID=" + uniqueItems+";ID="+LineFinalIDs;
            $("#SOFLine input[type=checkbox]:not(:checked)").each(function () {
                var row = $(this).closest("tr")[0];
                var id = row.cells[0].innerHTML; 
                // var FinalID = row.cells[22].innerHTML; 
                this.value = 0;
                var ids = Lineticketidss.indexOf(id);
                if(ids !== -1){
                        const regex = /[a-z]/g;                 
                        var res = id.match(regex);
                        if(!res){
                           delete Lineticketidss[ids];
                        }
                    }
                var uniqueItems = Array.from(new Set(Lineticketidss))
                document.getElementById("SOFBulkDataSCF").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;SCFImactedLine=Yes;TicketID=" + uniqueItems+";ID="+ LineFinalIDs;
                                    
            });

    });

    // // if all checkbox are selected, check the selectall checkbox
    // // and viceversa
    $(".SOFLintItemTask").click(function(){
        if($(".SOFLintItemTask").length == $(".SOFLintItemTask:checked").length) {
            document.getElementById("SOFLineallSCF").checked = true;
            $("#SOFLineallSCF").attr("checked", "checked");
        } else {
            $("#SOFLineallSCF").removeAttr("checked");
            document.getElementById("SOFLineallSCF").checked = false;
        }
    });
   });  
</script>
                            [% RenderBlockEnd('SCFLineDetails') %]
                     </tbody>
                </table>
                <div class="Field" style="padding-top: 1%;">
                        <a href="#" class="AsPopup PopupType_TicketAction" id="SOFBulkDataSCF" style="padding: .80em 2em">Bulk Update</a>
                    </div>
            </div>
        </div> 
        <script type="text/javascript">
                var table, i, x, y,no,SOFLintItemTaskFinalID;
                var ticketids=[]; 
                table = document.getElementById("SOFLine"); 
                var switching = true; 
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    if(sub){
                        $('#hide[% Data.tabid %]').show();
                           
                    }else{
                         $('#hide[% Data.tabid %]').hide();
                    }
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
                         x = rows[i].getElementsByTagName("TD")[4]; 
                         y = rows[i + 1].getElementsByTagName("TD")[4];
                         var h = rows[i].getElementsByTagName("TD")[23];
                         if(h){
                             SOFLintItemTaskFinalID = h.innerHTML;
                         }
                         if(x){
                            if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                               { 
                                Switch = true; 
                                break; 
                            } 
                         }
                    } 
                    if (Switch) { 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }
 
            var x,y;
              function reply_click(clicked_id)
                {
                    y = document.getElementById(clicked_id).className;
                    y = ".".concat(y);
                    x = "input";
                    x = x.concat(y);
                }


          
            $("td").on("click", x, function(){
                            var ticketids=[];

                            SOFLintItemTaskFinalID = [% Data.TicketID %];
                   
                               $("#SOFLine input[type=checkbox]:checked").each(function () {
                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML;  
                                    // var FinalID = row.cells[22].innerHTML;
                                    this.value = this.checked ? id : 0;
                                    const regex = /[a-z]/g;                 
                                    var res = id.match(regex);
                                    if(!res){
                                            // this.value = this.checked ? id : 0;
                                        ticketids.push(id);
                                    }
                                    var uniqueItems = Array.from(new Set(ticketids))
                                    document.getElementById("SOFBulkDataSCF").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;SCFImactedLine=Yes;TicketID=" + uniqueItems+";ID="+SOFLintItemTaskFinalID;
                                         
                                });
                                $("#SOFLine input[type=checkbox]:not(:checked)").each(function () {
                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML; 
                                    this.value = 0;
                                    var ids = ticketids.indexOf(id);
                                    if(ids !== -1){
                                         const regex = /[a-z]/g;                 
                                            var res = id.match(regex);
                                            if(!res){
       
                                               delete ticketids[ids];
                                            }
                                    }
                                    var uniqueItems = Array.from(new Set(ticketids))
                                    document.getElementById("SOFBulkDataSCF").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=LineItemBulkUpdate;SCFImactedLine=Yes;TicketID=" + uniqueItems+";ID="+ SOFLintItemTaskFinalID;
                                    
                                });
                                    
                            }).change();



</script>           
        </div>
        <div class="WidgetSimple NewLineItemDetails tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Line Item Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable"  >
                        <thead>
                            <tr>
                            <th>[% Translate("Line Item.") | html %]</th>
                            <th>[% Translate("SOF NO") | html %]</th>
                            <th>[% Translate("Line SR.NO.") | html %]</th>
                            <th>[% Translate("SCF Type") | html %]</th>
                            <th>[% Translate("Original Line Item No.") | html %]</th>
                            <th>[% Translate("Product Family") | html %]</th>
                            <th>[% Translate("Product Model") | html %]</th>
                            <th>[% Translate("Product Description") | html %]</th>
                            <th>[% Translate("Delivery Location") | html %]</th>
                            <th>[% Translate("Delivery Location Address") | html %]</th>
                            <th>[% Translate("Sale Type Tag") | html %]</th>
                            <th>[% Translate("Bill To") | html %]</th>
                            <th>[% Translate("Support To") | html %]</th>
                            <th>[% Translate("Bill Start Date") | html %]</th>
                            <th>[% Translate("Bill End Date") | html %]</th>
                            <th>[% Translate("Technical Start Date") | html %]</th>
                            <th>[% Translate("Technical End Date") | html %]</th>
                            <th>[% Translate("Cancellation Date") | html %]</th>
                            <th>[% Translate("Is Online") | html %]</th>
                            <th>[% Translate("Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('SCFNewLineDetails') %]
                               <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>
                               <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.SOFTicketID | uri %];">[% Data.DynamicField_SOFNumber %]</a></td>
                               <td> [% Data.DynamicField_SOFLineSrNo %]</td>

                               <td> [% Data.DynamicField_SCFType %]</td>
                               <!-- <td> [% Data.DynamicField_LineNumber %]</td> -->
                               <td> [% Data.DynamicField_OldLineNumber %]</td>
                               <td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td>

                               <!--<td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td> -->
                               <!-- <td> [% Data.DynamicField_Location %]</td> -->
                                <td> [% Data.DynamicField_DeliveryLocation %]</td>
                                <td> [% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                                <td> [% Data.DynamicField_SOFSaleTypeTag %]</td>
                                <td> [% Data.BillTo  %]</td>
                                <td> [% Data.SupportTo %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                                <td>[% Data.State %]</td>
                            </tr>
                            [% RenderBlockEnd('SCFNewLineDetails') %]

                    </table>
                </div>
            </div>       
        </div>

                <!-- SCF DR code start -->
        <div class="WidgetSimple SCFDRDetails tab-content">

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("DRs") | html %]</h2>
                </div>
                <div class="DynamicFieldsPagination">
                <span class="Pagination">
                [% RenderBlockStart("OverviewNavBarPageNavBarDR") %]
                                    [% Data.ResultLong %]
                                    [% Data.SiteNavBarLong %]
                [% RenderBlockEnd("OverviewNavBarPageNavBarDR") %]
                </span>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable1" >
                        <thead>
                            <tr>
                                <th>[% Translate("DR") | html %]</th>                    
                                <th>[% Translate("Line Item") | html %]</th>
                                <th>[% Translate("Line SR.No") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <!-- <th>[% Translate("Total Tasks") | html %]</th> -->
                                <th>[% Translate("DR Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            [% RenderBlockStart('SCFDR') %]
                            <tr>
                             
                                <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                                <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineID | uri %];">[% Data.LineNumber %]</a></td>
                                <!-- <td>[% Data.TicketNumber %]</td>
                                <td>[% Data.LineNumber %]</td> -->
                                <td>[% Data.SOFLineSrNo %]</td>
                                <td>[% Data.SOFNumber %]</td>
                                <!-- <td>[% Data.TasksCount %]</td> -->
                                <td>[% Data.State %]</td>
                            
                            </tr> 
                            [% RenderBlockEnd('SCFDR') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>
        <!-- SCF DR code end   -->
        <!-- SCF DR Task code end   -->
        <div class="WidgetSimple SCFDRTaskDetails tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Tasks Details") | html %]</h2>
                </div> 
            <div class="DynamicFieldsPagination">
            <span class="Pagination">
            [% RenderBlockStart("OverviewNavBarPageNavBarTask") %]
                                [% Data.ResultLong %]
                                [% Data.SiteNavBarLong %]
            [% RenderBlockEnd("OverviewNavBarPageNavBarTask") %]
            </span>
            </div>
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="IRTasktablescf" >
                        <thead>
                            <tr>
                                <th col-index = 2><input type="checkbox" id="IRTasktablescfselectall" [% IF Data.DynamicField_SCFType != 'Deactivation' %] disabled="" [% END %] /></th>
                                <th col-index = 3>[% Translate("Tasks") | html %]</th>
                                <th col-index = 4>[% Translate("Task Sequence") | html %]</th>
                                <th col-index = 5>[% Translate("Task Description") | html %] </th>
                                <th col-index = 6>[% Translate("DR") | html %]</th>
                                <th col-index = 7>[% Translate("Line Item") | html %]</th>
                                <th col-index = 8>[% Translate("Line SR No.") | html %]</th>
                                <th col-index = 9>[% Translate("SOF NO") | html %]</th>
                                <th col-index = 10>[% Translate("Assign Team") | html %] <select class="table-filter" onchange="filter_rows_IRTasktablescf()"><option value="all">Select All</option></select></th>
                                <th col-index = 11>[% Translate("Assign To") | html %] <select class="table-filter" onchange="filter_rows_IRTasktablescf()"><option value="all">Select All</option></select></th>
                                <th col-index = 12>[% Translate("Task Status") | html %] <select class="table-filter" onchange="filter_rows_IRTasktablescf()"><option value="all">Select All</option></select></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr >
                             [% RenderBlockStart('SCFDRTaskAllDetails') %]
                             [% IF Data.TaskNumber %]
                              <td style="display: none;">[% Data.TaskKey | html %]</td>
                                <td>
                             
                                <input onClick="reply_click(this.id)" type="checkbox" name="certified[]" class="LintItemTask" id ="[% Data.LineItemID %][% Data.TaskKey | html %]" value="[% Data.certified | html %]" [% IF Data.MySCFType != 'Deactivation' %] disabled="" [% END %] />
                            
                            </td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %]">[% Data.TaskNumber %]</a></td>
                              <td class="Taskseq">[% Data.Sequence %]</td>
                              <td>[% Data.Description %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.DRTicketId | uri %]">[% Data.DRNumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %]">[% Data.LineItemNumber1 %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineItemID | uri %]">[% Data.LineItemSRNumber1 %]</a></td>
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.FinalID | uri %]">[% Data.DynamicField_SOFNumber %]</a></td>
                            <td>[% Data.AsignedTeam %]</td>
                            <td>[% Data.AsignedTo %]</td>
                            <td> [% Data.TaskState %]</td>
                            <td style="display: none;">[% Data.FinalID | html %]</td>
                            <td style="display: none;">[% Data.LineItemID %][% Data.TaskKey | html %]</td>
                            <td style="display: none;" class="linesort">[% Data.LineItemNumber1 %]</a></td>
                            [% END %]
                            </tr>                           
                            [% RenderBlockEnd('SCFDRTaskAllDetails') %]
                        </tbody>
                    </table>
                    <script type="text/javascript">
              /*INC2024010905000017 Replaced new function as like SOF IRTasks on 14/JAN/24*/
                       $(function(){
                        var IRTasksFinalIDs;
                        var IRTasksticketidss=[];
                        let scfTicketID = "[%Data.TicketID%]";
                // add multiple select / deselect functionality
                        $("#IRTasktablescfselectall").click(function () {
                            IRTasksticketidss=[];
                    // var AllChecks = document.getElementsByClassName('LintItemTask');
                            var AllChecks = document.getElementsByClassName('LintItemTask');
                            $("#IRTasktablescf > tbody > tr").each(function () {
                                if($(this).css('display') != 'none' ){
                            // Added code for fixing performance on 27-04-2023
                            //if($(this).find('.LintItemTask')[0].disabled == false){
                            // Added code for fixing performance on 27-04-2023
                                    $(this).find('.LintItemTask')[0].checked = $("#IRTasktablescfselectall").is(':checked');
                            // Added code for fixing performance on 27-04-2023
                            //}
                            // Added code for fixing performance on 27-04-2023
                                }
                            });


                            IRTasksFinalIDs = "[% Data.TicketID %]";
                            $("#IRTasktablescf input[type=checkbox]:checked").each(function () {
                                var row = $(this).closest("tr")[0];
                                const regex = /[a-z]/g;                 
                                var res = row.cells[0].innerHTML.match(regex);
                                if(!res){ 
                                    IRTasksticketidss.push(row.cells[0].innerHTML);
                                }

                            });
                            var uniqueItems = Array.from(new Set(IRTasksticketidss));

                            document.getElementById("SCFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+scfTicketID;
                            document.getElementById("SCFBulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+scfTicketID;

                            if(this.checked == false && uniqueItems.length < 1){
                            // var uniqueItems = Array.from(new Set(IRTasksticketidss))
                                document.getElementById("SCFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+scfTicketID;
                                document.getElementById("SCFBulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+scfTicketID;
                            }


                        });

                // // if all checkbox are selected, check the selectall checkbox
                // // and viceversa
                        $(".LintItemTask").click(function(){
                          IRTasksticketidss=[];
                          IRTasksFinalIDs = "[%Data.FinalID%]";
                          $("#IRTasktablescf input[type=checkbox]:checked").each(function () {

                             var row = $(this).closest("tr")[0];
                             const regex = /[a-z]/g;                 
                             var res = row.cells[0].innerHTML.match(regex);
                             if(!res){ 
                                IRTasksticketidss.push(row.cells[0].innerHTML);
                            }

                        });
                          var uniqueItems = Array.from(new Set(IRTasksticketidss))
                          document.getElementById("SCFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+scfTicketID;
                          document.getElementById("SCFBulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+scfTicketID;
                          $("#IRTasktablescf input[type=checkbox]:not(:checked)").each(function () {

                            var row = $(this).closest("tr")[0];

                            var id = row.cells[0].innerHTML; 
                            this.value = 0;
                            var ids = IRTasksticketidss.indexOf(id);

                            if(ids !== -1){
                                const regex = /[a-z]/g;                 
                                var res = id.match(regex);
                                if(!res){
                       // IRTasksticketidss.pop(row.cells[0].innerHTML);
                                 delete IRTasksticketidss[ids];
                             }
                         }
                         var uniqueItems = Array.from(new Set(IRTasksticketidss));

                         document.getElementById("SCFBulkData").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+scfTicketID;
                         document.getElementById("SCFBulkResolve").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+scfTicketID;

                     });
        // alert('hi');
                          if($(".LintItemTask").length == $(".LintItemTask:checked").length) {
                            document.getElementById("IRTasktablescf").checked = true;
                            $("#IRTasktablescfselectall").attr("checked", "checked");
                        } else {
                            $(".LintItemTask").removeAttr("checked");
                            document.getElementById("IRTasktablescfselectall").checked = false;
                        }
                    });
                    });
/*INC2024010905000017 Replaced new function as like SOF IRTasks on 14/JAN/24*/

</script>  
                    <script type="text/javascript">
                        getUniqueValuesFromColumnIRTasktablescf()
                    </script>
                   <div class="Field" style="padding-top: 1%;">
    
                        <a href="#" class="AsPopup PopupType_TicketAction" id="SCFBulkData" style="padding: .80em 2em">Bulk Update</a>

                        <a href="#" class="AsPopup PopupType_TicketAction" id="SCFBulkResolve" style="padding: .80em 2em">Bulk Resolve</a>

                
                    </div>
                </div>
            </div>       
        </div>
        
        <!-- SCF DR Task code end   -->

        <div class="WidgetSimple Asset tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Asset Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable"  >
                        <thead>
                            <tr>
                                <th>[% Translate("Line Number") | html %]</th>
                                <th>[% Translate("UAN") | html %]</th>
                                <th>[% Translate("Asset Name") | html %]</th>
                                <th>[% Translate("Serial Number") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('AssetDetails') %]
                               <td><a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Data.TicketNumber %]</a></td>
                               <td><a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Data.uan %]</a></td>
                               <td><a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Translate(Data.name) | html %]</a></td>
                               <td>[% Data.Serial %]</td>
                            </tr> 
                            [% RenderBlockEnd('AssetDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

        <!-- Code Start for SR 19/08/2022 by NMJ-->
         <div class="WidgetSimple Assets tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Asset Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable"  >
                        <thead>
                            <tr>
                                <th>[% Translate("Line Number") | html %]</th>
                                <th>[% Translate("UAN") | html %]</th>
                                <th>[% Translate("Asset Name") | html %]</th>
                                <th>[% Translate("Asset Type") | html %]</th>
                                <th>[% Translate("Asset Sub Type") | html %]</th>
                                <th>[% Translate("Asset Category") | html %]</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('AssetDetailsss') %]
                              <td>
                                <a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineTicketID | uri %]"  title="[% Data.Title | uri %]"class="AsBlock MasterActionLink">[% Data.TicketNumbers | html %]</a>
                            </td>
                            <td>
                                <a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Translate(Data.uan) | html %]</a>
                            </td>
                            <td>
                                <a class="AsBlock" href="[% Env("Baselink") %]Action=AdminAddAsset;Classification=[% Data.assetcategory | html %];Subaction=Change;ChangeID=[% Data.asset_id | html %]" target="blank">[% Translate(Data.name) | html %]</a>
                            </td>
                               <td>[% Data.asset_type %]</td>
                               <td>[% Data.asset_sub_type %]</td>
                               <td>[% Data.assetcategory %]</td>
                            </tr> 
                            [% RenderBlockEnd('AssetDetailsss') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>

        <!-- Code End for SR 19/08/2022 by NMJ-->
        
    <div class="WidgetSimple DRTasks tab-content" >
        <div class="WidgetSimple">
             <form  action="[% Env("CGIHandle") %]" method="post" class="Validate PreventMultipleSubmits">
                    <input type="hidden" name="Action" id="Action" value="[% Env("Action") %]"/>
                    <input type="hidden" name="Subaction" id="Subaction" value="AJAXUpdate" />
                    <input type="hidden" id = "data" value="[% Data.TicketID | html %]" name="TicketID"/> 
                               <div class="Header">
                            <h2>[% Translate("Task Details") | html %]</h2>
                        </div> 
            <div class="Content" style="float:left; width:99%;padding-top: 1%; overflow:scroll; height:350px;">
                <table class="DataTable" id="DRTasktable">
                    <thead>
                        <tr>
                            <th col-index = 3><input type="checkbox" id="allselect"/></th>
                            <th col-index = 4>[% Translate("Tasks") | html %]</th>
                            <th col-index = 5>[% Translate("Task Sequence") | html %]</th>
                            <th col-index = 6>[% Translate("Task Description") | html %]</th>
                            <th col-index = 7>[% Translate("Product Model") | html %] <select class="table-filter2" onchange="filter_rowsDRTasktable()"><option value="all">Select All</option></select></th>
                            <th col-index = 8>[% Translate("DR") | html %]</th>
                            <th col-index = 9>[% Translate("Line Item") | html %]</th>
                            <th col-index = 10>[% Translate("SOF NO") | html %]</th>
                            <th col-index = 11>[% Translate("Asigned Team") | html %] <select class="table-filter2" onchange="filter_rowsDRTasktable()"><option value="all">Select All</option></select></th>
                            <th col-index = 12>[% Translate("Asigned To") | html %] <select class="table-filter2" onchange="filter_rowsDRTasktable()"><option value="all">Select All</option></select></th>
                            <th col-index = 13>[% Translate("Task Status") | html %] <select class="table-filter2" onchange="filter_rowsDRTasktable()"><option value="all">Select All</option></select></th>
                        </tr>
                    </thead>
                    <tbody>
                            <tr>
                             [% RenderBlockStart('DRTaskDetails') %]
                             <td style="display: none;">[% Data.TicketID | html %]</td>
                             <td style="display: none;">[% Data.Num | html %]</td>
                             [% IF Data.State == 'Cancelled' ||  Data.State == 'Resolved'%]
                             <td>
                                <input type="checkbox" name="certified[]" class="DRTaskcertified" id ="DRTK[% Data.TicketID | html %]" value="[% Data.certified | html %]" disabled="disabled" />
                             </td>
                             [% ELSE %]
                             <td>
                                <input type="checkbox" name="certified[]" class="DRTaskcertified" id ="DRTK[% Data.TicketID | html %]" value="[% Data.certified | html %]"  />
                             </td>
                             [% END %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                              <td>[% Data.DynamicField_TaskSequence %]</td>
                              <td>[% Data.Title %]</td>
                              <td>[% Data.part_name %]</td>
                              <td>[% Data.DR %]</td>
                              <td>[% Data.LineNo %]</td>
                              <td>[% Data.SOFNo %]</td>
                              <td>[% Data.Queue %]</td>
                              <td>[% Data.AsignedTo %]</td>
                              <td>[% Data.State %]</td>
                              <td style="display: none;">[% Data.DRIDs %]</a></td> 
                            </tr> 
   <script type="text/javascript">
    $(function(){
var FinalIDs;
var ticketidss=[];
    // add multiple select / deselect functionality
        $("#allselect").click(function () {
           $('.DRTaskcertified').attr('checked', this.checked);
            $("#DRTasktable > tbody > tr").each(function () {
                if($(this).css('display') != 'none' ){
                    $(this).find('.DRTaskcertified')[0].checked = $("#allselect").is(':checked');
                }
            });
           if("Data.TicketID"){
                 document.getElementById("DRTK[% Translate(Data.TicketID) | html %]").checked = this.checked;
           }
           FinalIDs = "[%Data.DRIDs%]";
            $("#DRTasktable input[type=checkbox]:checked").each(function () {
                var row = $(this).closest("tr")[0];
                    var id = row.cells[0].innerHTML;                               
                    const regex = /[a-z]/g;                 
                    var res = id.match(regex);
                    if(!res){
                        this.value = this.checked ? id : 0;
                        ticketidss.push(id);
                    }
                    var uniqueItems = Array.from(new Set(ticketidss))
                    document.getElementById("BulkDataDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+FinalIDs;
                    document.getElementById("BulkResolveDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+FinalIDs;
                                      
             });
            $("#DRTasktable input[type=checkbox]:not(:checked)").each(function () {
                var row = $(this).closest("tr")[0];
                var id = row.cells[0].innerHTML;             
                var ids = ticketidss.indexOf(id);
                    if(ids !== -1){
                        const regex = /[a-z]/g;                 
                        var res = id.match(regex);
                        if(!res){
                            this.value = 0;
                           delete ticketidss[ids];
                        }
                    }
                var uniqueItems = Array.from(new Set(ticketidss))
                document.getElementById("BulkDataDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+ FinalIDs;
                document.getElementById("BulkResolveDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+FinalIDs;
                                    
            });
    });

    // // if all checkbox are selected, check the selectall checkbox
    // // and viceversa
    $(".DRTaskcertified").click(function(){
        var v1 = $(".DRTaskcertified").length;
        var v2 = $(".DRTaskcertified:checked").length;
        if($(".DRTaskcertified").length == $(".DRTaskcertified:checked").length) {
            document.getElementById("allselect").checked = true;
            $("#allselect").attr("checked", "checked");
        } else {
            $("#allselect").removeAttr("checked");
            document.getElementById("allselect").checked = false;
        }
    });
   });      

 </script>
[% RenderBlockEnd('DRTaskDetails') %]

                            
                     </tbody>

                </table>
                <script type="text/javascript">
                     getUniqueValuesFromColumnDRTasktable() 
                </script>
                <div class="Field" style="padding-top: 1%;">

                        <a href="#" class="AsPopup PopupType_TicketAction" id="BulkDataDR" style="padding: .80em 2em">Bulk Update</a>

                        <a href="#" class="AsPopup PopupType_TicketAction" id="BulkResolveDR" style="padding: .80em 2em">Bulk Resolve</a> 
                </div>     
            </div>
        </div>  
    </div>


<script type="text/javascript">
                var table, i, x, y; 
                 var ticketids=[];
                 var FinalID; 
                table = document.getElementById("DRTasktable"); 
                var switching = true;
                
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    var sub = rows[1].getElementsByTagName("TD")[0];
                    
                    if(sub){
                        $('#hide').show();
                           
                    }else{
                         $('#hide').hide();
                    }
                    
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
                        x = rows[i].getElementsByTagName("TD")[4]; 
                        y = rows[i + 1].getElementsByTagName("TD")[4];
                        FinalID = rows[i].getElementsByTagName("TD")[13];
                        FinalID = FinalID.innerHTML;


                        if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                            { 
                            Switch = true; 
                            break; 
                        } 
                    } 
                    if (Switch) { 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }

                            $('.DRTaskcertified').on('click', function(){
                            //     var ticketids=[];
                            // var FinalID; 
                            
                               $("#DRTasktable input[type=checkbox]:checked").each(function () {
                                    var row = $(this).closest("tr")[0];
                                     var id = row.cells[0].innerHTML;                              
                                      const regex = /[a-z]/g;                 
                                        var res = id.match(regex);
                                        if(!res){
                                            // this.value = this.checked ? id : 0; 
                                            ticketids.push(id);
                                        }
                                     var uniqueItems = Array.from(new Set(ticketids))
                                     document.getElementById("BulkDataDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+FinalID;
                                      document.getElementById("BulkResolveDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+FinalID;
                                      
                                });
                                $("#DRTasktable input[type=checkbox]:not(:checked)").each(function () {

                                    var row = $(this).closest("tr")[0];
                                    var id = row.cells[0].innerHTML; 

                                                
                                    var ids = ticketids.indexOf(id);
                                     if(ids !== -1){
                                         const regex = /[a-z]/g;                 
                                            var res = id.match(regex);
                                            if(!res){
                                                // this.value = 0; 
                                               delete ticketids[ids];
                                            }
                                      }
                                    var uniqueItems = Array.from(new Set(ticketids))
                                      document.getElementById("BulkDataDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkUpdate;TicketID=" + uniqueItems+";ID="+ FinalID;
                                      document.getElementById("BulkResolveDR").href="/SupportDesk?Action=AgentTicketTaskBulk;Bulk=BulkResolve;TicketID=" + uniqueItems+";ID="+FinalID;
                                    
                                });
                                
                                   
                            }).change();        
    </script>

        <div class="WidgetSimple DRLineItem tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("LineItem Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                
                            <th>[% Translate("Line Item.") | html %]</th>
                            <th>[% Translate("SOF NO") | html %]</th>
                            <th>[% Translate("Line SR.NO.") | html %]</th>

                            <th>[% Translate("SCF Type") | html %]</th>
                            <!-- <th>[% Translate("Line Item No.") | html %]</th> -->
                            <th>[% Translate("Original Line Item No.") | html %]</th>
                            <th>[% Translate("Product Family") | html %]</th>
                            <th>[% Translate("Product Model") | html %]</th>
                            <th>[% Translate("Product Description") | html %]</th>
                            <th>[% Translate("Delivery Location") | html %]</th>
                            <th>[% Translate("Delivery Location Address") | html %]</th>
                            <th>[% Translate("Sale Type Tag") | html %]</th>
                            <th>[% Translate("Bill To") | html %]</th>
                            <th>[% Translate("Support To") | html %]</th>
                            <th>[% Translate("Bill Start Date") | html %]</th>
                            <th>[% Translate("Bill End Date") | html %]</th>
                            <th>[% Translate("Technical Start Date") | html %]</th>
                            <th>[% Translate("Technical End Date") | html %]</th>
                            <th>[% Translate("Cancellation Date") | html %]</th>
                            <th>[% Translate("Is Online") | html %]</th>
                            <th>[% Translate("Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('DRLineItemDetails') %]
                              <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>
                               <td> [% Data.DynamicField_SOFNumber  %]</td>
                               <td> [% Data.DynamicField_SOFLineSrNo %]</td>

                               <td> [% Data.DynamicField_SCFType %]</td>
                               <!-- <td> [% Data.DynamicField_LineNumber %]</td> -->
                               <td> [% Data.DynamicField_OldLineNumber %]</td>
                               <td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td>

                               <!--<td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td> -->
                               <!-- <td> [% Data.DynamicField_Location %]</td> -->
                                <td> [% Data.DynamicField_DeliveryLocation %]</td>
                                <td> [% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                                <td> [% Data.DynamicField_SOFSaleTypeTag %]</td>
                                <td> [% Data.BillTo  %]</td>
                                <td> [% Data.SupportTo %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                                <td>[% Data.State %]</td>
                            </tr> 
                            [% RenderBlockEnd('DRLineItemDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        
        <div class="WidgetSimple DR tab-content" >
            <div class="WidgetSimple">       
                <div class="Header">
                    <h2>[% Translate("DR Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("DR") | html %]</th>
                                <th>[% Translate("Line Item") | html %]</th>
                                <th>[% Translate("Line SR.No") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Total Tasks") | html %]</th>
                                <th>[% Translate("DR Status") | html %]</th>   
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('DRDetails') %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineID | uri %];">[% Data.LineNumber %]</a></td>
                              <td>[% Data.SOFLineSrNo %]</td>
                              <td>[% Data.SOFNumber %]</td>
                              <td>[% Data.TasksCount %]</td>
                              <td>[% Data.State %]</td>
                            </tr> 
                            [% RenderBlockEnd('DRDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>


        <div class="WidgetSimple SCF tab-content" >
            <div class="WidgetSimple">       
                <div class="Header">
                    <h2>[% Translate("SCF Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("SCF") | html %]</th>
                                <th>[% Translate("SCF Number") | html %]</th>
                                <th>[% Translate("SCF Quote") | html %]</th>   
                                <th>[% Translate("SCF Type") | html %]</th>
                                <th>[% Translate("SCF Status") | html %]</th>
                                <th>[% Translate("SCF Create Time") | html %]</th>   
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             [% RenderBlockStart('SCFDetails') %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                              <td>[% Data.DynamicField_SCFNumber %]</td>
                              <td>[% Data.DynamicField_SCFQuote %]</td>
                              <td>[% Data.DynamicField_SCFType %]</td>
                              <td>[% Data.State %]</td>
                              <td>[% Data.Created %]</td>
                            </tr>
                            [% RenderBlockEnd('SCFDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        
        
        <div class="WidgetSimple Questions tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Questions") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("Product") | html %]</th>
                                <th>[% Translate("Question") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                            [% RenderBlockStart('Questions') %]
                                  <td>[% Data.part_name %]</td>
                                  <td>[% Data.question %]</td>
                            </tr>            
                            [% RenderBlockEnd('Questions') %]
                        </tbody>
                    </table>
                     <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %]" class="AsPopup PopupType_TicketAction" style="color: #F92">Reply</a></td></tr>
                     </table>
                    </div>
                </div>
            </div>       
        </div>
        
        <!-- SCF code start by Megha -->
         <div class="WidgetSimple DRs tab-content">

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("DRs") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("DR") | html %]</th>                    
                                <th>[% Translate("Line Item") | html %]</th>
                                <th>[% Translate("Line SR.No") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Total Tasks") | html %]</th>
                                <th>[% Translate("DR Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('DR') %]
                             <tr>
                             
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.TicketNumber %]</a></td>
                            <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LineID | uri %];">[% Data.LineNumber %]</a></td>
                            <!-- <td>[% Data.TicketNumber %]</td>
                            <td>[% Data.LineNumber %]</td> -->
                            <td>[% Data.SOFLineSrNo %]</td>
                            <td>[% Data.SOFNumber %]</td>
                            <td>[% Data.TasksCount %]</td>
                            <td>[% Data.State %]</td>
                            
                            </tr> 
                            [% RenderBlockEnd('DR') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>
        <!-- SCF code end by Megha   -->

        <div class="WidgetSimple HOTO tab-content">

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Handover to Ops") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("HOTO Request") | html %]</th>
                                <th>[% Translate("HOTO Description") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Assigned Team") | html %]</th>
                                <th>[% Translate("Created") | html %]</th>
                                <th>[% Translate("HOTO Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('HOTOTask') %]
                             <tr>
                             
                             [% IF Data.HOTONumber %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.HOTOID | uri %];">[% Data.HOTONumber %]</a></td>
                            <td>[% Data.HOTOTitle %]</td>
                            <td>[% Data.DynamicField_SOFNumber %]</td>
                            <td>[% Data.HOTOTeam %]</td>
                            <td>[% Data.HOTOCreated | Localize("TimeShort") %]</td>
                            <td>[% Data.HOTOStatus %]</td>
                            [% END %]
                            </tr> 
                            [% RenderBlockEnd('HOTOTask') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>

        <div class="WidgetSimple HOTOTasksLI tab-content">

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("HOTO Tasks") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("HOTO Task") | html %]</th>
                                <th>[% Translate("Line Item") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('HOTOTaskLI') %]
                             <tr>
                             
                             [% IF Data.HOTONumber %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.HOTOID | uri %];">[% Data.HOTONumber %]</a></td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.LIID | uri %];">[% Data.LINumber %]</a></td>
                            [% END %]
                            </tr> 
                            [% RenderBlockEnd('HOTOTaskLI') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>

        <div class="WidgetSimple LineItem tab-content">

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Line Item") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                               <th>[% Translate("Line Item.") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>
                                <th>[% Translate("Line SR.NO.") | html %]</th>

                                <th>[% Translate("SCF Type") | html %]</th>
                                <!-- <th>[% Translate("Line Item No.") | html %]</th> -->
                                <th>[% Translate("Original Line Item No.") | html %]</th>
                                <th>[% Translate("Product Family") | html %]</th>
                                <th>[% Translate("Product Model") | html %]</th>
                                <th>[% Translate("Product Description") | html %]</th>


                                <!--<th>[% Translate("Product Family") | html %]</th>
                                <th>[% Translate("Product Model") | html %]</th>
                                <th>[% Translate("Product Description") | html %]</th>-->
                                <th>[% Translate("Delivery Location") | html %]</th>
                                <th>[% Translate("Delivery Location Address") | html %]</th>
                                <th>[% Translate("Sale Type Tag") | html %]</th>
                                <th>[% Translate("Bill To") | html %]</th>
                                <th>[% Translate("Support To") | html %]</th>
                                <th>[% Translate("Bill Start Date") | html %]</th>
                                <th>[% Translate("Bill End Date") | html %]</th>
                                <th>[% Translate("Technical Start Date") | html %]</th>
                                <th>[% Translate("Technical End Date") | html %]</th>
                                <th>[% Translate("Cancellation Date") | html %]</th>
                                <th>[% Translate("Is Online") | html %]</th>
                                <th>[% Translate("Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('TaskHOTO') %]
                             <tr>
                             
                            [% IF Data.DynamicField_LineNumber %]



                               <td ><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];">[% Data.DynamicField_LineNumber %]</a></td>
                               <td> [% Data.DynamicField_SOFNumber  %]</td>
                               <td> [% Data.DynamicField_SOFLineSrNo %]</td>

                               <td> [% Data.SCFType %]</td>
                               <!-- <td> [% Data.DynamicField_LineNumber %]</td> -->
                               <td> [% Data.DynamicField_OldLineNumber %]</td>
                               <td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td>

                               <!--<td> [% Data.DynamicField_SOFProductFamily %]</td>
                               <td> [% Data.DynamicField_SOFProductModel %]</td>
                               <td> [% Data.DynamicField_ProductDescription %]</td> -->
                               <!-- <td> [% Data.DynamicField_Location %]</td> -->
                                <td> [% Data.DynamicField_DeliveryLocation %]</td>
                                <td> [% Data.DynamicField_SOFDeliveryLocationAddress %]</td>
                                <td> [% Data.DynamicField_SOFSaleTypeTag %]</td>
                                <td> [% Data.BillTo  %]</td>
                                <td> [% Data.SupportTo %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFBillEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalStartDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFTechnicalEndDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFCancellationDate) | Localize('TimeShort') %]</td>
                                <td> [% Translate(Data.DynamicField_SOFIsOnline) | Localize('TimeShort') %]</td>
                                <td>[% Data.State %]</td>
                            [% END %]
                            </tr> 
                            [% RenderBlockEnd('TaskHOTO') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>

    <div class="WidgetSimple HOTOTask tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("HOTO Task") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" id="Tasktable" >
                        <thead>
                            <tr>
                                <th>[% Translate("Task") | html %]</th>
                                <!-- <th>[% Translate("Task Sequence") | html %]</th> -->
                                <th>[% Translate("Task Description") | html %]</th>
                                <th>[% Translate("HOTO") | html %]</th>
                                <!-- <th>[% Translate("Line Item") | html %]</th> -->
                                <!-- <th>[% Translate("SOF Number") | html %]</th> -->
                                <th>[% Translate("Assigned Team") | html %]</th>
                                <th>[% Translate("Assigned To") | html %]</th>
                                <th>[% Translate("Created") | html %]</th>
                                <th>[% Translate("Status") | html %]</th>
                            </tr>
                        </thead>
                        <tbody>
                             [% RenderBlockStart('HOTOTask1') %]
                            <tr>
                             
                             [% IF Data.HOTONumber %]
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TaskKey | uri %]">[% Data.TaskNumber %]</a></td>
                              <td>[% Data.TaskTitle %]</td>

                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.HOTOTicketId | uri %]">[% Data.HOTONumber %]</a></td>
                             <!-- <td>[% Data.LT %]</td> -->
                            <!-- <td>[% Data.DynamicField_SOFNumber %]</td> -->
                            <td>[% Data.TaskTeam %]</td>
                            <td>[% Data.TaskOwner %]</td>
                            <td>[% Data.HOTOTaskCreated  | Localize("TimeShort") %]</td>
                            <td>[% Data.TaskStatus %]</td>
                            [% END %]
                            </tr> 
                            
                            [% RenderBlockEnd('HOTOTask1') %]
                        </tbody>
                    </table>
                     <!-- <div>
                     <table class="DataTable" id="Tasktable">
                         <tr><td><a href="[% Env("Baselink") %]Action=AgentTicketCompose;TicketID=[% Data.TicketID | uri %];" class="AsPopup PopupType_TicketAction" style="color: #F92">Replay</a></td></tr>
                     </table>
                    </div> -->
                </div>
            </div>       
        </div>
        
<script type="text/javascript">
                var table, i, x, y; 
                table = document.getElementById("Tasktable"); 
                var switching = true; 
  
                // Run loop until no switching is needed 
                while (switching) { 
                    switching = false; 
                    var rows = table.rows; 
                    
                    // Loop to go through all rows 
                   
                    for (i = 1; i < (rows.length - 1); i++) { 
                        var Switch = false; 
  
                        // Fetch 2 elements that need to be compared 
                        x = rows[i].getElementsByTagName("TD")[1]; 
                        y = rows[i + 1].getElementsByTagName("TD")[1];
                        
                        
                        // Check if 2 rows need to be switched 
                        if (parseInt(x.innerHTML) > parseInt(y.innerHTML)) 
                            { 
  
                            // If yes, mark Switch as needed and break loop 
                            Switch = true; 
                            break; 
                        } 
                    } 
                    if (Switch) { 
                        // Function to switch rows and mark switch as completed 
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); 
                        switching = true; 
                    } 
                }

</script>
        

        <div class="WidgetSimple LineParts tab-content" >

            <div class="WidgetSimple">
                        
                <div class="Header">
                    <h2>[% Translate("Product Details") | html %]</h2>
                </div> 
                <div class="Content" style="float:left; width:99%; overflow:scroll; height:350px;">
                    <table class="DataTable" >
                        <thead>
                            <tr>
                                <th>[% Translate("Product Code") | html %]</th>
                                <th>[% Translate("Product Name") | html %]</th>
                                <th>[% Translate("Quantity") | html %]</th>
                                <th>[% Translate("UOM") | html %]</th>
                                <!-- <th>[% Translate("Part Description") | html %]</th> -->
                                <th>[% Translate("IR") | html %]</th>
                                <th>[% Translate("Line NO") | html %]</th>
                                <th>[% Translate("SOF NO") | html %]</th>



                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                             <tr>
                             [% RenderBlockStart('PartDetails') %]</tr>
                              <td>[% Data.DynamicField_PartID %]</td>
                              <td>[% Data.PartName1 %]</td>
                              <td>[% Data.PartQuantity %]</td>
                              <td>[% Data.PartUOM %]</td>
                              <td><a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.IRTicketID | uri %];">[% Data.IRNumber %]</a></td>
                            <td>[% Data.DynamicField_LineNumber %]</td>
                            <td>[% Data.DynamicField_SOFNumber %]</td>

                            
                            
                           

                           
                           <!-- <td> [% Data.DynamicField_SOFNumber  %]</td> -->
                   
                            [% RenderBlockEnd('PartDetails') %]
                        </tbody>
                    </table>
                </div>
            </div>       
        </div>
        <div class="Clear"></div>


    </div>

</div>


<div class="WidgetSimple LineItem tab-content" >
  <h1>1</h1>
  
</div>

[% RenderBlockEnd("Header") %]
<!-- added by eStomi -->




[% RenderBlockStart("Tree") %]
[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">//<![CDATA[
 

$("#nav-RemoteControl > a").click(function(e){
    e.preventDefault();
    window.open('http://192.168.1.50/files/RemoteControl.hta', '_blank');
   
});

$(document).on('click','.linked_ticket',function(){

    var div_name = $(this).data('id');
    var t_id = $(this).data('ticket-id');
    var link = 'link';
    var Assetid=$(this).data('id1');
 var stingr = "<h4>Do you want to relate this asset to ticket?</h4>";
    if($(this).children('span').hasClass('fa-check-circle')){
        link = 'delink';
         stingr = "<h4>Do you want to un-relate this asset from  ticket?</h4>";
    }
    var This = $(this);
    Core.UI.Dialog.ShowDialog({
        Title: Core.Language.Translate("Relate the ticket"),
        HTML: stingr,
        Modal: true,
        CloseOnClickOutside: false,
        CloseOnEscape: false,
        PositionTop: '20%',
        PositionLeft: 'Center',
        Buttons: [
            {
                Label: Core.Language.Translate("Yes"),
                Function: function () {

                    Core.UI.Dialog.CloseDialog($('.Dialog:visible'));
                    jQuery.ajax({
                        url: Core.Config.Get('Baselink'),
                        type: "POST",
                        data: {
                            Action: 'AdminAssetMapping',
                            Subaction: 'LinkAsset',
                            NAME: div_name, 
                            TicketID: t_id, 
                            Asset_id: Assetid,
                            Flag: link
                        },      
                        success: function(result) {
                            var msg;
                            if(result.trim() === 'success')
                            {
                                if(This.children('span').hasClass('fa-check-circle')){
                                    This.children('span').removeClass('fa-check-circle');
                                    This.children('span').addClass('fa-circle-o');
                                    msg = "Asset has been delinked successfully";
                                }else{
                                    This.children('span').removeClass('fa-circle-o');
                                    This.children('span').addClass('fa-check-circle');
                                    msg = "Asset has been linked successfully";
                                }

                            }else{
                                msg = result;
                            }
                            console.log(msg);
                            // Core.UI.Dialog.ShowDialog({
             //                    Title: Core.Language.Translate("Template Updated"),
             //                    HTML: "<h4>"+result+"</h4> ",
             //                    Modal: true,
             //                    CloseOnClickOutside: false,
             //                    CloseOnEscape: false,
             //                    PositionTop: '20%',
             //                    PositionLeft: 'Center',
             //                    Buttons: [
             //                        {
                                        

             //                            Label: Core.Language.Translate("Ok"),
             //                            Function: function () {
             //                             //location.reload();
             //                                Core.UI.Dialog.CloseDialog($('.Dialog:visible'));
             //                            }
             //                        }
             //                    ]
             //                });

                        }
                    });


                    
                }
            },{
                Label: Core.Language.Translate("No"),
                Function: function () {
                    //location.reload();
                    Core.UI.Dialog.CloseDialog($('.Dialog:visible'));
                }
            }
        ]
    });
});


//]]></script>
[% END %]
<div class="WidgetSimple">
    <div class="Header">
       
        <h2>
        [% IF Data.ZoomTimeline %]
            [% Translate("Ticket Timeline View") | html %]
        [% ELSE %]
            [% Translate("Worklog Overview - %s Worklog(s)", Data.ArticleCount) | html %]
        [% END %]
        </h2>
        <div class="AdditionalInformation ControlRow">

[% RenderBlockStart("ArticlePages") %]
            <div class="ArticlePages Icons">
        [% FOREACH page IN [1 .. Data.Pages]; %]
                <a href="[% Env("Baselink") %]Action=AgentTicketZoom;TicketID=[% Data.TicketID | uri %];ArticlePage=[% page %]" title="[% Translate('Page %s', page) | html %]" data-page="[% page %]" [% IF page == Data.CurrentPage %]class="Active"[% END %]>[% page %]</a>
        [% END; %]
            </div>
[% RenderBlockEnd("ArticlePages") %]
[% RenderBlockStart("ArticleFilterDialogLink") %]
            <div class="ArticleFilter Icons">
                <span class="InvisibleText">[% Translate("Article Filter") | html %]:</span>
# Only show one: Set or Reset.
#[% RenderBlockStart("ArticleFilterSetLink") %]
                <a href="#" id="SetArticleFilter" title="[% Translate("Add Filter") | html %]"><i class="fa fa-filter"></i><span>[% Translate("Set") | html %]</span></a>
#[% RenderBlockEnd("ArticleFilterSetLink") %]
[% RenderBlockStart("ArticleFilterResetLink") %]
                <a href="#" id="ResetArticleFilter" title="[% Translate("Reset Filter") | html %]"><i class="fa fa-trash-o"></i><span>[% Translate("Reset") | html %]</span></a>
[% RenderBlockEnd("ArticleFilterResetLink") %]
            </div>
[% RenderBlockEnd("ArticleFilterDialogLink") %]
            <div class="Clear"></div>
        </div>
    </div>
    <div class="Content">

[% RenderBlockStart("ArticleList") %]
        <!-- <div class="TicketList"> -->
            <div>
            <div id="ArticleTableBody" class="ActionRow">
                <div class="Scroller">
                    <table id="ArticleTable" class="DataTable [% Data.TableClasses | html %]">
                        <thead>
                            <tr>
                                <th class="No Sortable"><a href="#">[% Translate("No.") | html %]</a></th>
                                <th class="UnreadArticles">
                                    <a class="UnreadArticles" href="#" title="[% Translate("Unread articles") | html %]">
                                        <span class="UnreadArticles">
                                            <i class="fa fa-star"></i>
                                            <i class="fa fa-star"></i>
                                        </span>
                                    </a>
                                </th>
                                <th class="Direction Sortable"><a href="#" title="[% Translate("Direction") | html %]"><i class="fa fa-exchange"></i></a></th>
                                [% IF Data.TypeID != 9 && Data.TypeID != 12 && Data.TypeID != 11 && Data.TypeID != 13 && Data.TypeID != 10 && Data.TypeID != 16 %]
                                        <th class="Sender Sortable"><a href="#">[% Translate("Sender") | html %]</a></th>
                                [% ELSE %]
                                        <th class="Sender Sortable"><a href="#">[% Translate("Account Manager") | html %]</a></th>
                                [% END %]
                                <th class="Channel Sortable"><a href="#">[% Translate("Via") | html %]</a></th>
                                <th class="Subject Sortable"><a href="#">[% Translate("Subject") | html %]</a></th>
                                <th class="Created Sortable"><a href="#">[% Translate("Created") | html %]</a></th>
                                <th class="Attachments Last Center">
                                    <a href="#" title="[% Translate("Attachments") | html %]">
                                        <i class="fa fa-paperclip"></i>
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
[% RenderBlockStart("TreeItem") %]
                            <tr class="[% Data.SenderType | html %] [% IF Data.SenderType == 'customer' %]Incoming[% ELSE %]Outgoing[% END %] [% IF Data.IsVisibleForCustomer %]VisibleForCustomer[% ELSE %]NotVisibleForCustomer[% END %] [% Data.ClassRow | html %]" id="Row[% Data.ArticleNumber | uri %]">
                                <td class="No">
                                    [% Data.ArticleNumber | html %]
                                    <input type="hidden" class="ArticleInfo" name="Link[% Data.ArticleNumber | uri %]" value="[% Env("Baselink") %]Action=AgentTicketZoom;Subaction=ArticleUpdate;Count=[% Data.ArticleNumber | uri %];TicketID=[% Data.TicketID | html %];ArticleID=[% Data.ArticleID | html %];"/>
                                    <input type="hidden" class="ArticleID" value="[% Data.ArticleID | html %]" />
                                    <input type="hidden" class="SortData" value="[% Data.ArticleNumber | html %]" />
                                </td>
                                <td class="[% Data.Class | html %] UnreadArticles Fixed NonTextContent">
[% RenderBlockStart("TreeItemImportantArticle") %]
                                    <span class="ImportantArticles" title="[% Translate("Important") | html %]">
                                        <i class="fa fa-info-circle"></i>
                                        <em>[% Translate("Important") | html %]</em>
                                    </span>
[% RenderBlockEnd("TreeItemImportantArticle") %]
[% RenderBlockStart("TreeItemNewArticle") %]
                                    <span class="[% Data.Class | html %]" title="[% Translate("Unread Article!") | html %]">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </span>
[% RenderBlockEnd("TreeItemNewArticle") %]
[% RenderBlockStart("TreeItemNoNewArticle") %]
                                    <span class="NoContent"></span>
[% RenderBlockEnd("TreeItemNoNewArticle") %]
                                </td>
                                <td class="Direction">
[% RenderBlockStart("TreeItemDirectionIncoming") %]
                                    <span class="Direction Incoming" title="[% Translate("Incoming message") | html %]">
                                        <i class="fa fa-long-arrow-left"></i>
                                    </span>
                                    <input type="hidden" class="SortData" value="0" />
[% RenderBlockEnd("TreeItemDirectionIncoming") %]
[% RenderBlockStart("TreeItemDirectionOutgoing") %]
                                    <span class="Direction Outgoing" title="[% Translate("Outgoing message") | html %]">
                                        <i class="fa fa-long-arrow-right"></i>
                                    </span>
                                    <input type="hidden" class="SortData" value="1" />
[% RenderBlockEnd("TreeItemDirectionOutgoing") %]
[% RenderBlockStart("TreeItemDirectionInternal") %]
                                    <span class="Direction Internal" title="[% Translate("Internal message") | html %]"></span>
                                    <input type="hidden" class="SortData" value="2" />
[% RenderBlockEnd("TreeItemDirectionInternal") %]
                                </td>
                                <td class="Sender">
                                    <div title="[% Data.ArticleFields.Sender.Value | html %]"><a href="#">[% Data.ArticleFields.Sender.Realname | truncate(100) | html %]</a></div>
                                    <input type="hidden" class="SortData" value="[% Data.ArticleFields.Sender.Value | html %]" />
                                </td>
                                <td class="Channel">
                                    <div>[% Translate(Data.ChannelDisplayName) | html %]
                                    [% IF Data.ChannelInvalid %]
                                        <span title="[% Translate("Missing channel") | html %]">
                                            <i class="fa fa-exclamation-triangle Warning" aria-hidden="true"></i>
                                        </span>
                                    [% END %]
                                    [% IF Data.TransmissionStatus %]
                                        [% IF Data.TransmissionStatus.Status == 'Failed' %]
                                        <span title="[% Translate("Sending of this message has failed.") | html %]">
                                            <i class="fa fa-times Error" aria-hidden="true"></i>
                                        </span>
                                        [% ELSIF Data.TransmissionStatus.Status == 'Processing' %]
                                        <span title="[% Translate("This message has been queued for sending.") | html %]">
                                            <i class="fa fa-spin fa-circle-o-notch Warning" aria-hidden="true"></i>
                                        </span>
                                        [% END %]
                                    [% END %]
                                    </div>
                                    <input type="hidden" class="SortData" value="[% Translate(Data.ChannelDisplayName) | html %]" />
                                </td>
                                <td class="Subject">
                                    <div title="[% Data.ArticleFields.Subject.Value | html %]"><a href="#">[% Data.ArticleFields.Subject.Value | truncate(100) | html %]</a></div>
                                    <input type="hidden" class="SortData" value="[% Data.ArticleFields.Subject.Value | html %]" />
                                </td>
                                <td class="Created">
                                    <div title="[% Data.CreateTime | Localize('TimeShort') %]"><a href="#">[% Data.CreateTime | Localize("TimeShort") %]</a></div>
# Include custom sorting information: date in ISO format.
# Other date formats cannot be sorted reliably.
                                    <input type="hidden" class="SortData" value="[% Data.CreateTime | html %]" />
                                </td>
                                <td class="Attachments Center Attachment Fixed NonTextContent">
[% RenderBlockStart("TreeItemAttachment") %]
[% PROCESS ArticleAttachments.tt %]
[% RenderBlockEnd("TreeItemAttachment") %]
[% RenderBlockStart("TreeItemNoAttachment") %]
                                    <span class="NoContent"></span>
[% RenderBlockEnd("TreeItemNoAttachment") %]
                                </td>
                            </tr>
[% RenderBlockEnd("TreeItem") %]
                        </tbody>
                    </table>
                </div>
                <div class="Handle ui-resizable-handle ui-resizable-s">
                    <a href="#">[% Translate("Resize") | html %]</a>
                </div>
            </div>
        </div>
        <!-- </div> -->
[% RenderBlockEnd("ArticleList") %]

[% RenderBlockStart("TimelineView") %]

        <div class="TimelineViewTicketActions Hidden">
[% RenderBlockStart("TimelineViewTicketActions") %]
            <div class="TicketActions ArticleID_[% Data.ArticleID | html %]">
[% PROCESS ArticleActionMenu.tt %]
            </div>
[% RenderBlockEnd("TimelineViewTicketActions") %]
        </div>

        <div class="TimelineViewArticleAttachments Hidden">
[% RenderBlockStart("TimelineViewArticleAttachments") %]
            <div class="ArticleAttachments ArticleID_[% Data.ArticleID | html %]">
[% PROCESS ArticleAttachments.tt %]
            </div>
[% RenderBlockEnd("TimelineViewArticleAttachments") %]
        </div>

        <ul class="Hidden">
            <li id="TemplateListItem">
                <h3>
                    <div class="UnreadArticles Remarkable" title="[% Translate("Mark this article as read") | html %]">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <i class="fa fa-info-circle" title="[% Translate("Important") | html %]"></i>
                    <em></em>
                    <strong class="Type"></strong>
                    <span><span></span></span>
                    <a href="#" class="ShowFullArticleText" title="[% Translate("Show Full Text") | html %]">
                        <i class="fa fa-search-plus"></i>
                    </a>
                </h3>
            </li>
        </ul>

        <div id="TemplateArticleData" class="Hidden">
            <ul>
                <li class="subject">
                    <strong>[% Translate("Subject") | html %]: </strong>
                </li>
                <li class="from">
                    <strong>[% Translate("From") | html %]: </strong>
                </li>
                <li class="to">
                    <strong>[% Translate("To") | html %]: </strong>
                </li>
                <li class="cc">
                    <strong>[% Translate("Cc") | html %]: </strong>
                </li>
            </ul>
            <div class="Hidden FullArticlePlainText" data-title="[% Translate("Full Article Text") | html %]">
                <div class="TimelinePlainText"></div>
            </div>
            <p class="PlainText"></p>
            <div class="Hidden ArticleIFrame" data-title="[% Translate("Full Article Text") | html %]"></div>
        </div>

        <div class="TimelineView UseArticleColors">
            <ul class="ListLeft">
                <li class="NoEvents">[% Translate("No more events found. Please try changing the filter settings.") | html %]</li>
            </ul>
            <ul class="ListRight"></ul>
            <div class="Clear"></div>
            <span><i class="fa fa-spinner fa-spin"></i></span>
        </div>

[% RenderBlockEnd("TimelineView") %]

    </div>
</div>
[% RenderBlockEnd("Tree") %]

[% Data.ArticleWidgetsHTML %]

[% RenderBlockStart("waitvendor") %]
<script type="text/javascript">
document.getElementById("nav-Assign-to-Vendor").style.display = "none";
</script>
[% RenderBlockEnd("waitvendor") %]
<!-- Sid added Code to restrict create change button start -->
[% RenderBlockStart("CreateChange") %]
<script type="text/javascript">
document.getElementById("nav-Create-Change").style.display = "none";
</script>
[% RenderBlockEnd("CreateChange") %]
<!-- Sid added Code to restrict create change button end   -->

[% WRAPPER JSOnDocumentComplete %]

<script type="text/javascript">
$(".Avatar").hide();
</script>
[% END %]

<!-- Modal -->
<!-- <div class="modal fade"  data-backdrop="static" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body popup">
        <div class="row">
        <div class="loader"></div>
        </div>
      </div>
        <p class="d-flex justify-content-center">please wait process is loading...</p>
    </div>
  </div>
  </div> -->
  <script type="text/javascript">
    var Globalvar;

    [% IF Data.ShowSOFLoading == 'Yes' %]
        document.getElementById("exampleModal").style.display = "block";

        setInterval(function() {
            $.ajax({
                url: "[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=SOFLoaderAjax;TicketID=[% Data.TicketID %]",
                method: "POST",
                dataType: 'html',
                success: function(response) {
                    if(response == 'No' && !Globalvar){
                        Globalvar = 1;
                        location.replace("[% Env("CGIHandle") %]?Action=AgentTicketZoom;TicketID=[% Data.TicketID %];TabID=IRTasks");
                    }
                }
            });
        }, 15000);
    [% END %]


    var GlobalvarLine;

    [% IF Data.LineShowSOFLoading == 'Yes' %]
        document.getElementById("exampleModal").style.display = "block";

        setInterval(function() {
            $.ajax({
                url: "[% Env("CGIHandle") %]?Action=AgentTicketZoom;Subaction=SOFLineLoaderAjax;TicketID=[% Data.TicketID %]",
                method: "POST",
                dataType: 'html',
                success: function(response) {
                    if(response == 'No' && !GlobalvarLine){
                        GlobalvarLine = 1;
                        location.replace("[% Env("CGIHandle") %]?Action=AgentTicketZoom;TicketID=[% Data.TicketID %]");
                    }
                }
            });
        }, 15000);
    [% END %]
      // $('#exampleModal').modal('show');
  </script>

  <script type="text/javascript">
     /*    var blink = 
            document.getElementById('blink');
           
  if(blink){
        setInterval(function () {
            blink.style.opacity = 
            (blink.style.opacity == 0 ? 1 : 0);
        }, 1000);
        } */
    </script>
